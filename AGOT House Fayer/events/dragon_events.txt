#Dragons (!)
namespace = dragon

###Dragon Egg Events###  			dragon.1-
###Dragon Rearing Events###			dragon.8-
###Dragon Lair/Province Events### 	dragon.22-
###Encountered wild escaped dragon###  dragon.26-
###Field of Fire###					dragon.31-
###Siege of fire###					dragon.38-
###Dragon Duels###				dragon.43-
###INTEL###						dragon.60-
###Dragon Conquest CB###			dragon.67-
###Feed to Dragon on execution?###	dragon.71-
###Show me the dragons###			dragon.73-
###AI dragon rider takes to the field###	dragon.74-
###Age of dragons begins###			dragon.76-
###Shadowlands Dragons###			dragon.78
###Storming of Dragon Pit###			dragon.79
###Ruler Designer Dragons###			dragon.82
###Dragon nicknames###			dragon.90

#Canon dragons have random personality traits removed
character_event = {
	id = dragon.0

	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		remove_trait = dragon #This ensures the dragon is 'immortal/incapable'
		add_trait = dragon
		
		remove_trait = lustful
		remove_trait = chaste
		remove_trait = gluttonous
		remove_trait = temperate
		remove_trait = greedy
		remove_trait = charitable
		remove_trait = slothful
		remove_trait = diligent
		remove_trait = envious
		remove_trait = kind
		remove_trait = wroth
		remove_trait = patient
		remove_trait = proud
		remove_trait = humble
		remove_trait = deceitful
		remove_trait = honest
		remove_trait = craven
		remove_trait = brave
		remove_trait = shy
		remove_trait = gregarious
		remove_trait = ambitious
		remove_trait = content
		remove_trait = arbitrary
		remove_trait = just
		remove_trait = cynical
		remove_trait = zealous
		remove_trait = paranoid
		remove_trait = trusting
		remove_trait = cruel
		remove_trait = authoritative
		remove_trait = rude
		remove_trait = familyperson
		remove_trait = selfish
		remove_trait = stubborn
		remove_trait = ruthless
		remove_trait = honorable
		remove_trait = haughty
		remove_trait = affectionate
		remove_trait = timid
		remove_trait = rowdy
		remove_trait = willful
		remove_trait = brooding
		remove_trait = indolent
		remove_trait = playful
		remove_trait = conscientious
		remove_trait = fussy
		remove_trait = curious
		remove_trait = idolizer
	}
	
	option = {
		name = OK
	}
}
###Dragon Egg Events###
#Offered egg to buy
character_event = {
	id = dragon.1
	desc = "wanna_buy_egg"

	picture = "GFX_targaryen_eggs" 
	
	prisoner = no
	only_playable = yes
	capable_only = yes
	min_age = 16
	
	trigger = {
		demesne_size = 1
		NOT = { has_global_flag = dragon_egg_3 }
		in_command = no
		is_ill = no
		NOT = { trait = nightswatch } 
		NOT = { primary_title = { title = d_kingsguard } }
		OR = {
			wealth = 800
			AND = { #Ai may take a loan if rich enough
				ai = yes
				war = no
				monthly_income = 20
				wealth = 300
				NOT = { has_character_flag = loan_taken }
				NOT = { has_character_modifier = loan_timer }
				NOT = { has_character_flag = offended_moneylenders }
			}
		}	
	}
	
	mean_time_to_happen = {
		months = 75000
		
		modifier = {
			factor = 0.5
			NOT = { has_global_flag = dragon_egg_1 }
		}
		modifier = {
			factor = 1.1
			has_global_flag = dragon_egg_1
		}
		modifier = {
			factor = 1.65
			has_global_flag = dragon_egg_2
		}	
		modifier = {
			factor = 0.8
			has_ambition = obj_obtain_dragon_egg
		}
		modifier = {
			factor = 0.5
			trait = fire_obsessed 
		}
		modifier = {
			factor = 0.9
			trait = just
		}
		modifier = {
			factor = 0.9
			trait = honorable
		}
		modifier = {
			factor = 0.9
			trait = honest
		}
		modifier = {
			factor = 1.25
			trait = arbitrary
		}
		modifier = {
			factor = 1.25
			trait = ruthless
		}
		modifier = {
			factor = 1.25
			trait = deceitful
		}
		modifier = {
			factor = 0.25
			location = { 
				province_id = 795 # Asshai 
			}
		}
	}
	
	option = {
		name = "buy_the_egg" # buy egg
		ai_chance = {
			factor = 100
		}	
		if = {
			limit = { #Ai may take a loan if rich enough
				ai = yes
				war = no
				monthly_income = 20
				wealth = 300
				NOT = { has_character_flag = loan_taken }
				NOT = { has_character_modifier = loan_timer }
				NOT = { has_character_flag = offended_moneylenders }
			}
			wealth = 800
			set_variable = { which = "loan_amount" value = 800 }		
			set_character_flag = loan_800	
			add_character_modifier = {
				name = "loan_timer"
				duration = 1825
			}
			set_character_flag = loan_taken
		}
		add_trait = dragon_egg
		wealth = -800
		hidden_tooltip = {
			if = {
				limit = { ai = no }
				chronicle = {
					entry = CHRONICLE_BOUGHT_DRAGON_EGG
					picture = "GFX_targaryen_eggs" 
				}
			}
			any_playable_ruler = {
				limit = { 
					ai = no 
					NOT = { character = ROOT }
					OR = {
						dynasty = ROOT
						is_close_relative = ROOT
						same_realm = ROOT
					}
				}
				character_event = { id = dragon.2 }
			}
		}
		if = {
			limit = { has_global_flag = dragon_egg_2 }
			clr_global_flag = dragon_egg_2
			set_global_flag = dragon_egg_3
		}
		if = {
			limit = { has_global_flag = dragon_egg_1 }
			clr_global_flag = dragon_egg_1
			set_global_flag = dragon_egg_2
		}
		if = {
			limit = {
				NOT = { has_global_flag = dragon_egg_1 }
				NOT = { has_global_flag = dragon_egg_2 }
				NOT = { has_global_flag = dragon_egg_3 }
			}
			set_global_flag = dragon_egg_1
		}		
	}
	
	option = {
		name = "no_thanks" # Nope
		ai_chance = {
			factor = 0.1
		}
	}	
}
#Inform World of Egg Purchase
character_event = {
	id = dragon.2
	desc = "EVTDESCdragon.2"
	
	is_triggered_only = yes
	picture = "GFX_targaryen_eggs" 
	
	option = {
		name = "EVTOPTdragon.2"	
		chronicle = {
			entry = CHRONICLE_BOUGHT_DRAGON_EGG_FROM
			portrait = [From.GetID]
		}
	}
}
#Are you sure you wanna hatch? (triggered from dragon_decisions)
character_event = {
	id = dragon.3
	desc = "EVTDESCdragon.3"
	is_triggered_only = yes
	picture = "GFX_targaryen_eggs"
	
	option = {
		name = "EVTOPTAdragon.3" #try hatch
		ai_chance = {
			factor = 1
			modifier = {
				factor = 3.5
				any_dynasty_member = { is_alive = yes trait = dragon_rider }
			}
			modifier = {
				factor = 3.5
				liege = { is_close_relative = ROOT trait = dragon_rider }
			}
			modifier = {
				factor = 5
				OR = {
					capital_holding = { has_building = ca_dragon_pit }
					family_palace = { has_building = fp_dragon_pit }
					AND = {
						is_ruler = no
						liege = { 
							OR = {
								capital_holding = { has_building = ca_dragon_pit }
								family_palace = { has_building = fp_dragon_pit }
							}
						}
					}
				}
			}
			modifier = {
				factor = 10
				has_global_flag = age_of_dragons
			}
			modifier = {
				factor = 3
				trait = genius
			}
			modifier = {
				factor = 3
				trait = brave
			}
			modifier = {
				factor = 1.5
				is_smart_trigger = yes
			}
			modifier = {
				factor = 3
				trait = lunatic
			}
			modifier = {
				factor = 3
				trait = ambitious
			}
			#intel
				
			modifier = {
				factor = 3.5
				has_character_flag = dragon_intel_citadel
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_harrenhal 
			}
			modifier = {
				factor = 2
				has_character_flag = dragon_intel_dragonstone 
			}
			modifier = {
				factor = 2.5
				has_character_flag = dragon_intel_dragonpit 
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_fof 
			}			
			modifier = {
				factor = 2.5
				has_character_flag = dragon_intel_summerhall
			}
			modifier = {
				factor = 2
				has_character_flag = dragon_intel_eggs 
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_old_ghis
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_volantis
			}
			modifier = {
				factor = 2.5
				has_character_flag = dragon_intel_smoking_sea
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_asshai
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_dynamic
			}
			modifier = {
				factor = 2
				has_character_flag = dragon_intel_rebirth
			}
			#valyrian modifiers
			modifier = {
				factor = 3.5
				dynasty = 496
			}
			modifier = {
				factor = 10
				dynasty = 10012
			}
			modifier = {
				factor = 5
				religion = valyrian 
			}
			modifier = {
				factor = 2.5
				culture = high_valyrian 
			}
			modifier = {
				factor = 2
				culture_group = valyrian
			}
			modifier = {
				factor = 1.5
				culture = asshai
			}
			#rhollor path
			modifier = {
				factor = 1.5
				religion = rhllor 
			}
			modifier = {
				factor = 3
				trait = favored_by_rhllor
			}
			modifier = {
				factor = 10
				trait = chosen_by_rhllor
			}
			#Demon Child
			modifier = {
				factor = 20
				has_character_flag = demon_child_non_pagan
			}			
		}
		hidden_tooltip = { c_the_citadel = { holder_scope = { character_event = { id = dragon.4 } } } }
		
	}
	option = {
		name = "EVTOPTBdragon.3" #nope
		ai_chance = {
			factor = 100
			modifier = {
				factor = 3
				trait = imbecile
			}
			modifier = {
				factor = 3
				trait = craven
			}
			modifier = {
				factor = 1.5
				is_dumb_trigger = yes
			}
			modifier = {
				factor = 3
				trait = content
			}
		}
	}
}
# Citadel Determine if dragon hatched
character_event = {
	id = dragon.4
	is_triggered_only = yes
	desc = "EVTDESCdragon.4"
	
	# Nobody but the actual referee should ever get this
	trigger = { has_landed_title = c_the_citadel }
	
	#hatched
	option = {
		name = "HATCHED"
		ai_chance = {
			factor = 1
			#Dragons already hatched
			modifier = {
				factor = 3.5
				FROM = { any_dynasty_member = { is_alive = yes trait = dragon_rider } }
			}
			modifier = {
				factor = 3.5
				FROM = { liege = { is_close_relative = FROM trait = dragon_rider } }
			}
			modifier = {
				factor = 10
				has_global_flag = age_of_dragons
			}
			modifier = {
				factor = 5
				FROM = { 
					OR = {
						capital_holding = { has_building = ca_dragon_pit }
						family_palace = { has_building = fp_dragon_pit }
						AND = {
							is_ruler = no
							liege = { 
								OR = {
									capital_holding = { has_building = ca_dragon_pit }
									family_palace = { has_building = fp_dragon_pit }
								}
							}
						}
					}
				}
			}
			
			modifier = {
				factor = 2
				FROM = {  trait = genius }
			}
			modifier = {
				factor = 1.25
				FROM = {  trait = brave }
			}
			modifier = {
				factor = 1.25
				FROM = {  trait = scholar }
			}
			modifier = {
				factor = 1.25
				FROM = {  is_smart_trigger = yes }
			}
			modifier = {
				factor = 1.25
				FROM = {  trait = mystic }
			}
			#intel
				
			modifier = {
				factor = 3.5
				FROM = {  has_character_flag = dragon_intel_citadel  }
			}
			modifier = {
				factor = 1.5
				FROM = {  has_character_flag = dragon_intel_harrenhal  }
			}
			modifier = {
				factor = 2
				FROM = {  has_character_flag = dragon_intel_dragonstone  }
			}
			modifier = {
				factor = 2.5
				FROM = {  has_character_flag = dragon_intel_dragonpit  }
			}
			modifier = {
				factor = 1.5
				FROM = {  has_character_flag = dragon_intel_fof  }
			}
			modifier = {
				factor = 2.5
				FROM = {  has_character_flag = dragon_intel_summerhall  }
			}
			modifier = {
				factor = 2
				FROM = {  has_character_flag = dragon_intel_eggs  }
			}
			modifier = {
				factor = 1.5
				FROM = { has_character_flag = dragon_intel_old_ghis }
			}
			modifier = {
				factor = 1.5
				FROM = { has_character_flag = dragon_intel_volantis }
			}
			modifier = {
				factor = 2.5
				FROM = { has_character_flag = dragon_intel_smoking_sea }
			}
			modifier = {
				factor = 1.5
				FROM = { has_character_flag = dragon_intel_asshai }
			}
			modifier = {
				factor = 1.5
				FROM = { has_character_flag = dragon_intel_dynamic }
			}
			#valyrian modifiers
			modifier = {
				factor = 3.5
				FROM = {
					dynasty = 496
				}
			}
			modifier = {
				factor = 10
				FROM = {
					dynasty = 10012
				}
			}
			modifier = {
				factor = 5
				FROM = {  religion = valyrian  }
			}
			modifier = {
				factor = 2.5
				FROM = {  culture = high_valyrian  }
			}
			modifier = {
				factor = 2
				FROM = {  culture_group = valyrian  }
			}
			modifier = {
				factor = 1.5
				FROM = {  culture = asshai  }
			}
			#rhollor path
			modifier = {
				factor = 1.5
				FROM = {  religion = rhllor  }
			}
			modifier = {
				factor = 3
				FROM = {  trait = favored_by_rhllor  }
			}
			modifier = {
				factor = 10
				FROM = {  trait = chosen_by_rhllor  }
			}	
			#Demon Child
			modifier = {
				factor = 20
				has_character_flag = demon_child_non_pagan
			}
		}
		FROM = {
			character_event = { id = dragon.5 days = 1 } 
		}
		
	}
	#not hatched
	option = {
		name = "NOT HATCHED"
		ai_chance = {
			factor = 500

			modifier = {
				factor = 1.25
				FROM = {  trait = craven }
			}
			modifier = {
				factor = 1.25
				FROM = {  is_dumb_trigger = yes }
			}
			modifier = {
				factor = 1.25
				FROM = {  trait = slothful  }
			}
			modifier = {
				factor = 1.25
				FROM = {  trait = wroth   }
			}
			
		}
		
		FROM = {
			if = {
				limit = {
					NOT = { 
						any_dynasty_member = { 
							trait = dragon_rider
						}	
					}	
				}
				set_character_flag = remove_egg
				random = {
					chance = 50
					set_character_flag = kill_son
				}	
				random = {
					chance = 50
					set_character_flag = kill_daughter
				}	
				random = {
					chance = 50
					set_character_flag = kill_wife
				}	
				random = {
					chance = 50
					set_character_flag = kill_self				
				}
				random = {
					chance = 50
					set_character_flag = kill_bodyguard
				}	
				random = {
					chance = 75
					set_character_flag = kill_province				
				}
			}	
			character_event = { id = dragon.6 days = 1} 
		}
	}
}
#hatched dragon
character_event = {
	id = dragon.5
	desc = "EVTDESCdragon.5"
	picture = "GFX_targaryen_hatching"
	
	is_triggered_only = yes
	hide_from = yes

	prisoner = no
	capable_only = yes
	
	option = {
		name = "EVTOPTdragon.5"	
		trigger = { NOT = { has_character_flag = danys_eggs } }
		hidden_tooltip = {
			if = {
				limit = { 
					NOT = { any_province = { has_province_flag = dragon_intel_rebirth } }
					NOT = { dragon = { is_alive = yes NOT = { has_character_flag = shadow_lands_dragon } } }
				}
				location = {
					set_province_flag = dragon_intel_rebirth
				}
			}
		}
		create_character = {
			dynasty = culture
			age = 0
			culture = dragon
			religion = dragon_rel
		}
		new_character = {
			add_friend = ROOT
			add_trait = dragon
			character_event = { id = dragon.599 }
			random = {
				chance = 5
				add_trait = fair
			}
			random = {
				chance = 5
				if = {
					limit = { NOT = { trait = fair } }
					add_trait = ugly
				}	
			}
			if = {
				limit = {
					ROOT = { 
						OR = {
							capital_holding = { has_building = ca_dragon_pit }
							family_palace = { has_building = fp_dragon_pit }
							AND = {
								is_ruler = no
								liege = { 
									OR = {
										capital_holding = { has_building = ca_dragon_pit }
										family_palace = { has_building = fp_dragon_pit }
									}
								}
							}
						} 	
					} 
				}
				random = {
					chance = 8
					add_trait = sickly
				}
				if = {
					limit = { NOT = { trait = sickly } }
					random = {
						chance = 2
						add_trait = strong
					}
				}
			}	
			if = {
				limit = {
					ROOT = { 
						NOR = {
							capital_holding = { has_building = ca_dragon_pit }
							family_palace = { has_building = fp_dragon_pit }
							AND = {
								is_ruler = no
								liege = { 
									OR = {
										capital_holding = { has_building = ca_dragon_pit }
										family_palace = { has_building = fp_dragon_pit }
									}
								}
							}
						}	
					} 
				}
				random = {
					chance = 2
					add_trait = sickly
				}
				if = {
					limit = { NOT = { trait = sickly } }
					random = {
						chance = 5
						add_trait = strong
					}
				}
			}
			random_list = {
				1 = { add_trait = dragon_1 }
				1 = { add_trait = dragon_2 }
				1 = { add_trait = dragon_3 }
				1 = { add_trait = dragon_4 }
				1 = { add_trait = dragon_5 }
				1 = { add_trait = dragon_6 }
				1 = { add_trait = dragon_7 }
				1 = { add_trait = dragon_8 }
				1 = { add_trait = dragon_9 }
				1 = { add_trait = dragon_10 }
				1 = { add_trait = dragon_11 }
				1 = { add_trait = dragon_12 }
				1 = { add_trait = dragon_13 }
				1 = { add_trait = dragon_14 }
				1 = { add_trait = dragon_15 }
				1 = { add_trait = dragon_16 }
				1 = { add_trait = dragon_17 }
				1 = { add_trait = dragon_18 }
				1 = { add_trait = dragon_19 }
				1 = { add_trait = dragon_20 }
				1 = { add_trait = dragon_21 }
				1 = { add_trait = dragon_22 }
				1 = { add_trait = dragon_23 }
				1 = { add_trait = dragon_24 }
				1 = { add_trait = dragon_25 }
				1 = { add_trait = dragon_26 }
			}
		}
		if = {
			limit = {
				any_dynasty_member = { is_alive = yes trait = dragon_rider }
			}
			prestige = 250
		}
		if = {
			limit = {
				NOT = { any_dynasty_member = { is_alive = yes trait = dragon_rider } }
			}
			prestige = 1000
			random = {
				chance = 50
				hidden_tooltip = { remove_trait = content }
				add_trait = ambitious
				hidden_tooltip = {
					character_event = {
						id = 38278 #Notify Ambitious
					}
				}
			}	
		}
		hidden_tooltip = {
			remove_trait = dragon_egg
		}	
		set_character_flag = dragon_intel_eggs	
	}	
	option = {
		name = "EVTOPTdragon.5DANY"	#Dany's special hatching
		trigger = { has_character_flag = danys_eggs }
		clr_character_flag = danys_eggs
		create_character = {
			name = Drogon
			age = 0
			culture = dragon
			religion = dragon_rel
			trait = strong
			trait = dragon_1
		}
		new_character = {
			add_friend = ROOT
			set_mother = ROOT
			add_trait = dragon
			dynasty = 497001
			character_event = { id = dragon.599 }	
		}
		create_character = {
			name = Rhaegal
			age = 0
			culture = dragon
			religion = dragon_rel
			trait = dragon_2
		}
		new_character = {
			set_mother = ROOT
			add_trait = dragon
			dynasty = 497002
			character_event = { id = dragon.599 }	
		}
		create_character = {
			name = Viserion
			age = 0
			culture = dragon
			religion = dragon_rel
			trait = dragon_3
		}
		new_character = {
			set_mother = ROOT
			add_trait = dragon
			dynasty = 497003
			character_event = { id = dragon.599 }	
		}
		if = {
			limit = {
				any_dynasty_member = { is_alive = yes trait = dragon_rider }
			}
			prestige = 250
		}
		if = {
			limit = {
				NOT = { any_dynasty_member = { is_alive = yes trait = dragon_rider } }
			}
			prestige = 1000
			random = {
				chance = 50
				hidden_tooltip = { remove_trait = content }
				add_trait = ambitious
				hidden_tooltip = {
					character_event = {
						id = 38278 #Notify Ambitious
					}
				}
			}	
		}
		hidden_tooltip = {
			remove_trait = dragon_egg
		}	
		set_character_flag = dragon_intel_eggs	
	}		
}
character_event = { #set dragon's mother
	id = dragon.599

	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		dragon = {
			limit = { FROM = { has_character_flag = dragon_egg_mother_@PREV } }
			if = {
				limit = { is_female = yes }
				ROOT = { 
					set_mother = PREV 
					dynasty = PREV
				}
			}
			if = {
				limit = { is_female = no }
				ROOT = { 
					set_father = PREV 
					dynasty = PREV
				}
			}				
			FROM = { clr_character_flag = dragon_egg_mother_@PREV }
		}
		if = {
			limit = { dynasty = 0 }		
			dynasty = mother_bastard
		}
		#make sure the dragon has a parent to stop random culling
		if = {
			limit = { 
				NOT = { father_even_if_dead = { always = yes } }
				NOT = { mother_even_if_dead = { always = yes } }
			}		
			create_character = {
				name = "Unknown Dragon"
				dynasty = none
				age = 30
				culture = dragon
				religion = dragon_rel
				female = yes
			}
			new_character = {
				add_trait = dragon
				ROOT = { set_mother = PREV }	
				death = yes
			}
		}
		any_playable_ruler = {
			limit = {
				ai = no
				NOT = { character = FROM }
			}
			character_event = { id = dragon.7 }
			character_event = { id = dragon.799 }			
		}
		FROM = {
			if = {
				limit = { ai = no }
				chronicle = {
					entry = CHRONICLE_HATCHED_DRAGON
					portrait = [Root.GetID]
				}
			}
		}
		set_focus = focus_ch_dragon
	}
	
	option = {
		name = OK
	}
}	
#dragon failed to hatch
character_event = {
	id = dragon.6
	title = "EVTNAMEdragon.6"
	desc = "EVTDESCdragon.6"
	picture = "GFX_targaryen_hatching"
	
	is_triggered_only = yes
	
	hide_from = yes
	
	immediate = {
		if = {
			limit = { has_character_flag = remove_egg }
			remove_trait = dragon_egg
			clr_character_flag = remove_egg
			hidden_tooltip = {
				dragon = {
					limit = { ROOT = { has_character_flag = dragon_egg_mother_@PREV } }			
					ROOT = { clr_character_flag = dragon_egg_mother_@PREV }
				}
			}
		}	
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_HATCHED_DRAGON_FAIL
				portrait = [Root.GetID]
			}
		}
		any_playable_ruler = { #Inform world
			limit = {
				ai = no
				OR = {
					same_realm = ROOT
					dynasty = ROOT
					is_close_relative = ROOT
				}
			}
			character_event = { id = dragon.798 days = 1 }
		}
	}
	
	option = {
		name = "EVTOPTAdragon.6"
		if = {
			limit = {
				trait = dragon_egg
			}
			random = {
				chance = 25
				remove_trait = dragon_egg
				hidden_tooltip = {
					dragon = {
						limit = { ROOT = { has_character_flag = dragon_egg_mother_@PREV } }			
						ROOT = { clr_character_flag = dragon_egg_mother_@PREV }
					}
				}
			}
		}
		if = {
			limit = {
				has_character_flag = kill_son
			}
			random_child = {
				limit = { 	
					is_female = no
					age = 14
					at_location = ROOT
					ai = yes
				}
				red_god_resurrect_effect = yes #check for rhllor resurrection
				death = { death_reason = death_accident }
			}		
		}
		if = {
			limit = {
				has_character_flag = kill_daughter
			}
			random_child = {
				limit = { 	
					is_female = yes
					age = 14
					at_location = ROOT
					ai = yes
				}
				red_god_resurrect_effect = yes #check for rhllor resurrection
				death = { death_reason = death_accident }
			}
		}
		if = {
			limit = {
				has_character_flag = kill_wife
				spouse = { 
					at_location = ROOT
					ai = yes 
				}
			}
			spouse = {
				red_god_resurrect_effect = yes #check for rhllor resurrection
				death = { death_reason = death_accident }
			}
		}
		if = {
			limit = {
				has_character_flag = kill_bodyguard				
			}
			if = {
				limit = { has_landed_title = e_iron_throne }
				kingsguard = {
					limit = { is_alive = yes }
					red_god_resurrect_effect = yes #check for rhllor resurrection
					death = { death_reason = death_accident }
				}
			}
			if = {
				limit = { is_ruler = yes NOT = { has_landed_title = e_iron_throne } }
				random_courtier = {
					limit = { 
						liege = { character = ROOT } 
						has_minor_title = title_bodyguard
					}
					red_god_resurrect_effect = yes #check for rhllor resurrection
					death = { death_reason = death_accident }
				}
			}
		}
		if = {
			limit = {
				has_character_flag = kill_province
			}
			capital_scope = { province_event = { id = dragon.25 } }
		}
		if = {
			limit = {
				has_character_flag = kill_self
			}
			random_list = {
				20 = {
					hidden_tooltip = {
						red_god_resurrect_effect = yes #check for rhllor resurrection
					}
					death = { death_reason = death_accident }			
				}
				50 = {
					add_trait = depressed
					hidden_tooltip = {
						character_event ={
							id = 38288 #Notify
						}
					}
				}
				30 = {
					add_trait = maimed
					hidden_tooltip = {
						character_event ={
							id = 38281 #Notify
						}
					}
				}
			}	
		}		
		clr_character_flag = kill_son
		clr_character_flag = kill_daughter
		clr_character_flag = kill_wife
		clr_character_flag = kill_self
		clr_character_flag = kill_province
		clr_character_flag = kill_bodyguard
		clr_character_flag = tried_hatch	
	}
}
#dragon hatched  world notfication
character_event = {
	id = dragon.7
	desc = "EVTDESCdragon.7"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_global_flag = age_of_dragons }
	}
	
	immediate = {
		if = {
			limit = {
				NOT = { character = FROMFROM }
			}
			chronicle = {
				entry = CHRONICLE_HATCHED_DRAGON_FROM_A
				portrait = [FromFrom.GetID]
			}
		}
	}
	
	option = {
		name = "EVTOPTAdragon.7"	
	}	
}
character_event = {
	id = dragon.799
	desc = "EVTDESCdragon.799"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = age_of_dragons
		NOT = { has_character_flag = no_dragon_hatching_inform }
		had_global_flag = { flag = scenario_initialised days = 2 }
	}
	
	immediate = {
		if = {
			limit = {
				NOT = { character = FROMFROM }
				OR = {		
					dynasty = FROMFROM
					is_liege_or_above = FROMFROM
					is_close_relative = FROMFROM
					is_vassal_or_below = FROMFROM
				}
			}
			chronicle = {
				entry = CHRONICLE_HATCHED_DRAGON_FROM
				portrait = [FromFrom.GetID]
			}
		}
	}
	
	option = {
		name = "EVTOPTAdragon.799"	
	}	
	
	option = {
		name = "EVTOPTBdragon.1198"	
		set_character_flag = no_dragon_hatching_inform
	}	
}
#Inform world FROM failed in hatching dragons
character_event = {
	id = dragon.798
	picture = "GFX_targaryen_eggs" 
	
	is_triggered_only = yes	
	
	trigger = {
		OR = {
			FROM = { is_alive = no }
			FROM = { NOT = { trait = dragon_egg } }
			dynasty = FROM
			is_close_relative = FROM
		}
	}
	
	desc = {
		text = EVTDESCdragon.798
		trigger = { FROM = { is_alive = no } }		
	}
	desc = {
		text = EVTDESCdragon.798B
		trigger = { 
			FROM = { 
				is_alive = yes 
				NOT = { trait = dragon_egg }
			} 
		}		
	}
	desc = {
		text = EVTDESCdragon.798C
		trigger = { 
			FROM = { 
				is_alive = yes 
				trait = dragon_egg
			} 
		}		
	}
	
	option = {
		name = "EVTOPTAdragon.798"  #idiot
		if = {
			limit = {
				OR = {
					is_close_relative = FROM
					vassal_of = FROM
				}
			}
			chronicle = {
				entry = CHRONICLE_HATCHED_DRAGON_FAIL_FROM
				portrait = [From.GetID]
			}
		}	
	}
}
##Dragon Rearing Events###
#Yearly Dragon Growth/Maintenance
character_event = {
	id = dragon.8
	desc = "EVTDESCdragon.8"
	picture = "GFX_targaryen_balerion" 
	
	is_triggered_only = yes
	culture = dragon
	
	trigger = {
		trait = dragon
	}
	
	immediate = {
		remove_trait = dragon #This ensures the dragon is 'immortal'
		add_trait = dragon
		
		religion = dragon_rel
		
		#Remove wrong traits
		remove_trait = stressed
		remove_trait = depressed
		remove_trait = possessed
		remove_trait = lustful
		remove_trait = chaste
		remove_trait = temperate
		remove_trait = greedy
		remove_trait = charitable
		remove_trait = diligent
		remove_trait = envious
		remove_trait = kind
		remove_trait = deceitful
		remove_trait = honest
		remove_trait = craven
		remove_trait = brave
		remove_trait = gregarious
		remove_trait = ambitious
		remove_trait = arbitrary
		remove_trait = just
		remove_trait = cynical
		remove_trait = zealous
		remove_trait = paranoid
		remove_trait = cruel
		remove_trait = authoritative
		remove_trait = rude
		remove_trait = ruthless
		remove_trait = selfish
		remove_trait = stubborn
		remove_trait = has_bloody_flux
		remove_trait = has_grey_plague
		remove_trait = has_bubonic_plague
		remove_trait = has_aztec_disease
		remove_trait = erudite
		remove_trait = affectionate
		remove_trait = timid
		remove_trait = rowdy
		remove_trait = willful
		remove_trait = brooding
		remove_trait = indolent
		remove_trait = playful
		remove_trait = conscientious
		remove_trait = fussy
		remove_trait = curious
		remove_trait = idolizer
		
		if = {  #Random personality change
			limit = { NOT = { personality_traits = 2 } }
			random_list = {
				161 = { }
				2 = { 
					if = {
						limit = { NOT = { trait = patient } }
						add_trait = wroth
					}
				}
				2 = { 
					if = {
						limit = { NOT = { trait = wroth } }
						add_trait = patient
					}
				}
				2 = { add_trait = slothful }
				#1 = { add_trait = gluttonous }
				2 = { add_trait = content }
				1 = { add_trait = lunatic }
				2 = { 
					if = {
						limit = { NOT = { trait = proud } }
						add_trait = humble
					}
				}
				2 = { 
					if = {
						limit = { NOT = { trait = humble } }
						add_trait = proud
					}
				}
				2 = { add_trait = trusting }
				1 = { add_trait = shy }
			}
		}
		if = { 
			limit = { 
				age = 14
				NOT = { age = 16 }
			}
			add_trait = misguided_warrior
		}		
		if = {  #wound heal
			limit = { trait = wounded_dragon }
			random = {
				chance = 50
				remove_trait = wounded_dragon			
				any_friend = { character_event = { id = dragon.899 } }
			}
		}
		if = {  #maim heal
			limit = { trait = maimed_dragon }
			random = {
				chance = 15
				remove_trait = maimed_dragon
				add_trait = wounded_dragon
				any_friend = { character_event = { id = dragon.898 } }
			}
		}
		if = { #remove baronies
			limit = { 
				demesne_size = 1	
				NOT = { liege = { character = ROOT } }
			}
			liege = {
				ROOT = { any_demesne_title = { gain_title = PREVPREV } }
			}
		}
		random_friend = {
			if = {  #make sure it is in same court as rider
				limit = { 			
					is_alive = yes
					NOT = { any_courtier = { character = ROOT } }
					NOT = { same_liege = ROOT }
					NOT = { is_liege_of = ROOT }
				}
				if = {
					limit = { is_ruler = yes }
					ROOT = { move_character = PREV }
				}
				if = {
					limit = { is_ruler = no }
					liege = { ROOT = { move_character = PREV } }
				}
			}	
		}
		if = { #if wild and in ANY_ALL move to the dragonmont
			limit = {
				NOT = { any_friend = { is_alive = yes } }
				NOT = { liege = { demesne_size = 1 } }
				NOT = { liege = { is_friend = ROOT } }
				NOT = { has_character_flag = dany_dragon }	 
			}
			b_sweetport_sound = {
				holder_scope = {
					ROOT = { move_character = PREV }
				}
			}
			
		}	
		if = { #If locked in dragonpit check lcoation actually has one
			limit = { 
				has_character_modifier = locked_in_dragonpit
				liege = { 
					NOR = {
						capital_holding = { has_building = ca_dragon_pit }
						family_palace = { has_building = fp_dragon_pit }
					}
				}	
			}
			remove_character_modifier = locked_in_dragonpit
		}
		#make sure the dragon has a parent to stop random culling
		if = {
			limit = { 
				NOT = { father_even_if_dead = { always = yes } }
				NOT = { mother_even_if_dead = { always = yes } }
				NOT = { num_of_children = 1 }
			}		
			create_character = {
				name = "Unknown Dragon"
				dynasty = none
				age = 30
				culture = dragon
				religion = dragon_rel
				female = yes
			}
			new_character = {
				add_trait = dragon
				ROOT = { set_mother = PREV }	
				death = yes
			}
		}
		if = {  #hatch egg
			limit = { 
				trait = dragon_egg 
				NOT = { has_character_flag = shadow_lands_dragon }
			}
			if = {
				limit = { 
					any_friend = { 
						always = yes 
						NOT = { trait = dragon_egg }
					} 
				}
				random_friend = { character_event = { id = dragon.10 days = 1 } }
			}
			if = {
				limit = { 
					OR = {
						NOT = { any_friend = { always = yes } }
						any_friend = { trait = dragon_egg }						
					}	
				}
				random = {
					chance = 15
					remove_trait = dragon_egg
					create_character = {
						dynasty = culture
						age = 0
						culture = dragon
						religion = dragon_rel					
					}
					new_character = {
						add_trait = dragon
						dynasty = ROOT
						if = {
							limit = { ROOT = { is_female = yes } }
							set_mother = ROOT 
							if = {
								limit = { dynasty = 0 }
								dynasty = mother_bastard
							}
						}
						if = {
							limit = { ROOT = { is_female = no } }
							set_father = ROOT 
							if = {
								limit = { dynasty = 0 }
								dynasty = father_bastard
							}
						}
						random = {
							chance = 5
							add_trait = fair
						}
						random = {
							chance = 5
							if = {
								limit = { NOT = { trait = fair } }
								add_trait = ugly
							}	
						}
						random = {
							chance = 2
							add_trait = sickly
						}
						if = {
							limit = { NOT = { trait = sickly } }
							random = {
								chance = 5
								add_trait = strong
							}
						}
						random_list = {
							1 = { add_trait = dragon_1 }
							1 = { add_trait = dragon_2 }
							1 = { add_trait = dragon_3 }
							1 = { add_trait = dragon_4 }
							1 = { add_trait = dragon_5 }
							1 = { add_trait = dragon_6 }
							1 = { add_trait = dragon_7 }
							1 = { add_trait = dragon_8 }
							1 = { add_trait = dragon_9 }
							1 = { add_trait = dragon_10 }
							1 = { add_trait = dragon_11 }
							1 = { add_trait = dragon_12 }
							1 = { add_trait = dragon_13 }
							1 = { add_trait = dragon_14 }
							1 = { add_trait = dragon_15 }
							1 = { add_trait = dragon_16 }
							1 = { add_trait = dragon_17 }
							1 = { add_trait = dragon_18 }
							1 = { add_trait = dragon_19 }
							1 = { add_trait = dragon_20 }
							1 = { add_trait = dragon_21 }
							1 = { add_trait = dragon_22 }
							1 = { add_trait = dragon_23 }
							1 = { add_trait = dragon_24 }
							1 = { add_trait = dragon_25 }
							1 = { add_trait = dragon_26 }
						}
					}
					location = { province_event = { id = dragon.897 } }
				}
			}					
		}
		#Remove claims
		random_claim = { remove_claim = ROOT }
	}
	
	option = {
		name = "GROW" #Aiming for 1 martial every 2 years
		ai_chance = {
			factor = 50	
			modifier = {
				factor = 1.66
				trait = strong
			}
			modifier = {
				factor = 3
				NOT = { age = 6 }
			}
			modifier = { #Having a guardian increases martial rapidly
				factor = 0.5
				age = 6
				NOT = { age = 16 }
			}
			modifier = {
				factor = 1.5
				location = { province_id = 221 } #Dragonmont
			}
			modifier = {
				factor = 0.6
				any_friend = { is_alive = yes }
				liege = { 
					OR = {
						capital_holding = { has_building = ca_dragon_pit }
						family_palace = { has_building = fp_dragon_pit }
					}
				}
			}
			modifier = {
				factor = 0.6
				NOT = { any_friend = { is_alive = yes } }
				has_character_modifier = locked_in_dragonpit
			}
			
		}
		change_martial = 1
	}
	
	option = {
		name = "NO GROWTH" 
		ai_chance = {
			factor = 50
		}
	}
}
#Inform dragon wound healed
character_event = {
	id = dragon.899
	desc = "EVTDESCdragon.899"
	picture = "GFX_targaryen_balerion" 
	
	is_triggered_only = yes

	option = {
		name = OK
		FROM = { remove_trait = wounded_dragon }
	}
}
#Inform dragon maiming healed
character_event = {
	id = dragon.898
	desc = "EVTDESCdragon.898"
	picture = "GFX_targaryen_balerion" 
	
	is_triggered_only = yes

	option = {
		name = OK
		FROM = { remove_trait = maimed_dragon }
	}
}
#Inform wild dragon born
province_event = {
	id = dragon.897
	desc = "EVTDESCdragon.897"
	picture = "GFX_targaryen_balerion" 
	
	is_triggered_only = yes

	option = {
		name = OK
	}
}
#wild chained untamed dragon gets mad
character_event = {
	id = dragon.950
	
	culture = dragon
	min_age = 2
	
	trigger = {	
		trait = dragon 
		NOT = { has_character_modifier = locked_in_dragonpit }
		any_friend = { 
			NOT = { trait = dragon_rider }
			NOT = { trait = dragon }
			OR = {
				had_character_flag = { flag = chained_dragon_mad days = 250 } 
				NOT = { has_character_flag = chained_dragon_mad}
			}
		}	
	}
	
	mean_time_to_happen = {
		years = 1
		modifier = { 
			factor = 2.5
			any_friend = { any_dynasty_member = { at_location = ROOT trait = dragon_rider } }
		}
		modifier = { 
			factor = 2
			any_friend = { liege = { is_close_relative = PREV trait = dragon_rider } }
		}
		modifier = { 
			factor = 4
			any_friend = { 
				NOT = { age = 14 }
				any_dynasty_member = { at_location = ROOT trait = dragon_rider }
			}	
		}
	}
	
	option = {
		name = OK
		random_friend = { 
			limit = {
				NOT = { trait = dragon_rider }
				NOT = { trait = dragon }
				OR = {
					had_character_flag = { flag = chained_dragon_mad days = 250 } 
					NOT = { has_character_flag = chained_dragon_mad}
				}
			}	
			character_event = { id = dragon.9 }
		}
	}
}
character_event = {
	id = dragon.9
	desc = "EVTDESCdragon.9"
	picture = "GFX_siegeoffire" 
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.9" # Ugh
		ai_chance = {
			factor = 4
		}
		set_character_flag = chained_dragon_mad
		capital_scope = { province_event = { id = dragon.25 } }
		prestige = -50
	}
	
	option = {
		name = "EVTOPTBdragon.9" # Try and lock in pit
		trigger = {
			OR = {
				capital_holding = { has_building = ca_dragon_pit }
				family_palace = { has_building = fp_dragon_pit }
				AND = {
					is_ruler = no
					liege = { 
						OR = {
							capital_holding = { has_building = ca_dragon_pit }
							family_palace = { has_building = fp_dragon_pit }
						}
					}
				}
			}
			age = 12
			NOT = { trait = incapable }
			NOT = { trait = maimed }
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0.1
				trait = craven
			}
			modifier = {
				factor = 2
				trait = brave
			}
			modifier = {
				factor = 3
				trait = trained_warrior
			}
			modifier = {
				factor = 5
				trait = skilled_warrior
			}
			modifier = {
				factor = 8
				trait = master_warrior
			}
			modifier = {
				factor = 1.5
				FROM = { NOT = { martial = 20 } }
			}
			modifier = {
				factor = 0.9
				FROM = { martial = 40 } 
			}
			modifier = {
				factor = 0.8
				FROM = { martial = 60 } 
			}
			modifier = {
				factor = 0.75
				FROM = { martial = 80 } 
			}
			modifier = {
				factor = 0.66
				FROM = { martial = 100 } 
			}
		}
		set_character_flag = capture_dragon
		FROM = { character_event = { id = dragon.2799 tooltip = TOOLTIPdragon.2799 days = 1 } }
	}
}
#Dragon bears you a dragon egg
character_event = {
	id = dragon.1099
	
	hide_window = yes
	min_age = 4
	culture = dragon
	
	trigger = {
		trait = dragon
		NOT = { trait = dragon_egg }
		OR = {
			any_friend = { NOT = { trait = dragon_egg } }
			NOT = { any_friend = { always = yes } }
		}
	}
	
	mean_time_to_happen = {
		years = 75
		
		modifier = { #Make sure at least one egg comes
			factor = 0.2
			age = 80
			NOT = { any_child = { trait = dragon is_alive = yes } }
			NOT = { any_courtier = { has_character_flag = dragon_egg_mother_@ROOT } }
		}
		modifier = { #Owner's dynasty is short on eggs
			factor = 0.4
			any_friend = {
				NOT = { trait = dragon_egg }
				NOT = { any_dynasty_member = { is_close_relative = PREV trait = dragon_egg } }
			}
		}
		modifier = {
			factor = 0.9
			any_friend = { trait = genius }
		}
		modifier = {
			factor = 0.9
			any_friend = { trait = quick }
		}
		modifier = {
			factor = 0.9
			any_friend = { learning = 15 }
		}
		modifier = {
			factor = 0.9
			any_friend = { learning = 18 }
		}
		modifier = {
			factor = 0.9
			any_friend = { learning = 21 }
		}
		modifier = {
			factor = 2
			any_friend = { trait = imbecile }
		}
		modifier = {
			factor = 1.5
			any_friend = { is_dumb_trigger = yes }
		}
		modifier = {
			factor = 1.1
			any_friend = { NOT = { learning = 8 } }
		}
		modifier = {
			factor = 1.1
			any_friend = { NOT = { learning = 5 } }
		}
		modifier = {
			factor = 1.1
			any_friend = { NOT = { learning = 2 } }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_citadel }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_harrenhal } 
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_dragonstone }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_dragonpit }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_fof }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_summerhall }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_eggs }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_old_ghis }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_volantis }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_smoking_sea }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_asshai }
		}
		modifier = {
			factor = 0.9
			any_friend = { has_character_flag = dragon_intel_dynamic }
		}
	}
	
	immediate = {
		add_trait = dragon_egg	
		random_friend = { character_event = { id = dragon.10 days = 1 } }
	}
	
	option = {
		name = OK
	}
}	
character_event = {
	id = dragon.10
	desc = "EVTDESCdragon.10"
	picture = "GFX_targaryen_eggs" 
	
	is_triggered_only = yes
	
	trigger = { 
		is_alive = yes 
		NOT = { trait = dragon_egg } 
	}
	
	option = {
		name = "EVTOPTAdragon.10" 
		FROM = { remove_trait = dragon_egg }
		add_trait = dragon_egg	
		set_character_flag = dragon_egg_mother_@FROM
	}
}	
##Dragon dies
character_event = {
	id = dragon.1199
	
	hide_window = yes
	culture = dragon
	
	trigger = {
		trait = dragon
		OR = { #Not before age 100 unless ill/injured
			age = 100
			trait = sickly
			trait = wounded_dragon
			trait = maimed_dragon
		}		
	}
	
	mean_time_to_happen = {
		years = 250
		modifier = {
			factor = 0.0007
			trait = sickly
		}
		modifier = {
			factor = 0.8
			trait = wounded_dragon
		}
		modifier = {
			factor = 0.05
			trait = maimed_dragon
		}		
		modifier = {
			factor = 0.65
			liege = {
				OR = {
					capital_holding = { has_building = ca_dragon_pit }
					family_palace = { has_building = fp_dragon_pit }
				}
			}	
		}
		modifier = {
			factor = 1.5
			location = { 
				province_id = 221 #Dragonmont	
			} 
		}
	}
	
	immediate = {	
		if = {
			limit = { 
				NOT = { 
					OR = {
						trait = sickly 
						trait = wounded_dragon 
						trait = maimed_dragon
					}	
				} 
			}
			death = yes
		}
		if = {
			limit = { 
				OR = {
					trait = sickly 
					trait = wounded_dragon 
					trait = maimed_dragon
				}	
			}
			death = {					
				death_reason = death_trait
			}
		}	
		any_friend = { character_event = { id = dragon.11 } }
		any_playable_ruler = {
			limit = { 
				ai = no
				NOT = { is_friend = ROOT }
			}	
			character_event = { id = dragon.1198 }
		}		
	}
	
	option = {
		name = OK	
	}
}
character_event = {
	id = dragon.11
	desc = "EVTDESCdragon.11"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.11" 
		remove_trait = dragon_rider
		random = {
			chance = 33
			add_trait = dragon_egg
			set_character_flag = dragon_egg_mother_@FROM
		}	
	}
}
character_event = {
	id = dragon.1198
	desc = "EVTDESCdragon.1198"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes
	
	trigger = { NOT = { has_character_flag = no_dragon_old_age_death } }
	
	option = {
		name = "EVTOPTAdragon.1198" 	
	}
	option = {
		name = "EVTOPTBdragon.1198" 	
		set_character_flag = no_dragon_old_age_death
	}
}
#young dragon OR inherited dragon grown up, try to tame
character_event = {
	id = dragon.12
	desc = "EVTDESCdragon.12"
	picture = "GFX_tamingdragon" 
	
	is_triggered_only = yes
	
	trigger = { 
		NOT = { trait = dragon }
		any_friend = { 
			trait = dragon 
			age = 2
		}
		NOT = { has_character_flag = dany_no_tame_dragon }
	}
	
	option = {
		name = "EVTOPTAdragon.12" # tame it
		ai_chance = {
			factor = 1		
			modifier = {
				factor = 5
				any_friend = { trait = dragon age = 2 has_character_flag = tamed_dragon }
			}
			modifier = {
				factor = 10
				any_dynasty_member = { at_location = ROOT is_alive = yes trait = dragon_rider }
			}
			modifier = {
				factor = 5
				OR = {
					capital_holding = { has_building = ca_dragon_pit }
					family_palace = { has_building = fp_dragon_pit }
					AND = {
						is_ruler = no
						liege = { 
							OR = {
								capital_holding = { has_building = ca_dragon_pit }
								family_palace = { has_building = fp_dragon_pit }
							}
						}
					}
				}
			}
			modifier = {
				factor = 3
				trait = brave
			}
			modifier = {
				factor = 2
				trait = ambitious
			}
			modifier = {
				factor = 3
				trait = genius
			}
			modifier = {
				factor = 1.5
				is_smart_trigger = yes
			}
			modifier = {
				factor = 2
				trait = lunatic
			}
			modifier = {
				factor = 5
				dynasty = 496
			}
			modifier = {
				factor = 10
				dynasty = 10012
			}
			modifier = {
				factor = 5
				culture = high_valyrian
			}
			modifier = {
				factor = 5
				culture_group = valyrian
			}
			modifier = {
				factor = 2.5
				culture = asshai
			}
			modifier = {
				factor = 5
				religion = valyrian
			}
			modifier = {
				factor = 10
				has_character_flag = daenerys_targaryen
			}
			modifier = {
				factor = 3
				has_character_flag = dragon_intel_citadel 
			}
			modifier = {
				factor = 1.5
				religion = rhllor 
			}
			modifier = {
				factor = 3
				trait = favored_by_rhllor
			}
			modifier = {
				factor = 10
				trait = chosen_by_rhllor 
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_harrenhal
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_dragonstone
			}
			modifier = {
				factor = 2.5
				has_character_flag = dragon_intel_dragonpit 
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_old_ghis
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_volantis
			}
			modifier = {
				factor = 2.5
				has_character_flag = dragon_intel_smoking_sea
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_asshai
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_dynamic
			}
			#Demon Child
			modifier = {
				factor = 20
				has_character_flag = demon_child_non_pagan
			}
		}
		random_friend = {
			limit = {
				trait = dragon
				age = 2
			}
			character_event = { id = dragon.1399 tooltip = TOOLTIPdragon.1399 }
		}		
	}
	option = {
		name = "EVTOPTBdragon.12" #kill the beast
		ai_chance = {
			factor = 0.3
			modifier = {
				factor = 2
				trait = lunatic
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 2
				trait = wroth
			}
			modifier = {
				factor = 2
				trait = dragon_slayer 
			}
		}
		set_character_flag = duel_dragon
		random_friend = {
			limit = {
				trait = dragon
				age = 2
			}
			character_event = { id = dragon.2799 tooltip = TOOLTIPdragon.2799 }
		}	
	}
	option = {
		name = "EVTOPTCdragon.12" #set it free
		ai_chance = {
			factor = 1
			modifier = {
				factor = 2
				trait = shy
			}
			modifier = {
				factor = 2
				trait = kind
			}
			modifier = {
				factor = 2
				is_weak_trigger = yes
			}
			modifier = {
				factor = 3
				trait = craven
			}
			modifier = {
				factor = 2
				trait = content
			}
		}
		random_friend = {
			limit = {
				trait = dragon
				age = 2
			}
			character_event = { id = dragon.1599 tooltip = TOOLTIPdragon.1599 }
		}
		set_character_flag = ran_from_dragon	
	}
	option = {
		name = "EVTOPTDdragon.12" #later
		ai_chance = {
			factor = 0.5
		}
		#clr_character_flag = choose_wild_dragon_action
	}
	
}
# Citadel Determine if dragon tamed
character_event = { #scope to dragon
	id = dragon.1399
	
	is_triggered_only = yes
	hide_window = yes
	
	trigger = { trait = dragon }
	
	immediate = {
		hidden_tooltip = { c_the_citadel = { holder_scope = { character_event = { id = dragon.13 } } } }
	}
	
	option = {
		name = OK
	}
}	
character_event = {
	id = dragon.13
	is_triggered_only = yes
	desc = "EVTDESCdragon.13"
	
	# Nobody but the actual referee should ever get this
	trigger = { has_landed_title = c_the_citadel }
	
	#tamed
	option = {
		name = "TAMED"
		ai_chance = {
			factor = 1
			##Tamer Factors##
			modifier = {
				factor = 5
				FROM = { FROM = { any_dynasty_member = { at_location = PREV is_alive = yes trait = dragon_rider } } }
			}
			modifier = {
				factor = 5
				FROM = { 
					OR = {
						capital_holding = { has_building = ca_dragon_pit }
						family_palace = { has_building = fp_dragon_pit }
						AND = {
							is_ruler = no
							liege = { 
								OR = {
									capital_holding = { has_building = ca_dragon_pit }
									family_palace = { has_building = fp_dragon_pit }
								}
							}
						}
					}
				} 
			}
			modifier = {
				factor = 2
				FROM = { FROM = {  trait = authoritative } }
			}
			modifier = {
				factor = 2
				FROM = { FROM = {  is_strong_trigger = yes } }
			}
			modifier = {
				factor = 2
				FROM = { FROM = {  trait = brave } }
			}
			modifier = {
				factor = 3
				FROM = { FROM = {  trait = genius } }
			}
			modifier = {
				factor = 1.5
				FROM = { FROM = {  is_smart_trigger = yes } }
			}	
			#The Dragon recognises me because im a pureborn targ			
			modifier = { 
				factor = 5
				FROM = {
					FROM = {  
						has_character_modifier = abomination_of_incest
						culture_group = valyrian
					}
				}	
			}
			modifier = { 
				factor = 2.5
				FROM = {
					FROM = {  
						has_character_modifier = grandchild_of_incest
						culture_group = valyrian
					}
				}	
			}
			modifier = {
				factor = 2.5
				FROM = { FROM = { dynasty = 496 } }
			}
			modifier = {
				factor = 10
				FROM = { FROM = { dynasty = 10012 } }
			}
			modifier = {
				factor = 5
				FROM = { FROM = {  has_character_flag = daenerys_targaryen  } }
			}
			modifier = {
				factor = 6
				FROM = { FROM = {  culture = high_valyrian  } }
			}
			modifier = {
				factor = 5
				FROM = { FROM = {  religion = valyrian  } }
			}
			modifier = {
				factor = 2.5
				FROM = { FROM = {  culture = asshai  } }
			}
			modifier = {
				factor = 3
				FROM = { FROM = {  has_character_flag = dragon_intel_citadel  } }
			}
			modifier = {
				factor = 5
				FROM = { FROM = {  culture_group = valyrian  } }
			}
			modifier = {
				factor = 1.5
				FROM = { FROM = {  religion = rhllor  } }
			}
			modifier = {
				factor = 3
				FROM = { FROM = {  trait = favored_by_rhllor  } }
			}
			modifier = {
				factor = 10
				FROM = { FROM = {  trait = chosen_by_rhllor  } }
			}
			modifier = {
				factor = 1.5
				FROM = { FROM = {  has_character_flag = dragon_intel_harrenhal  } }
			}
			modifier = {
				factor = 1.5
				FROM = { FROM = {  has_character_flag = dragon_intel_dragonstone  } }
			}
			modifier = {
				factor = 2.5
				FROM = { FROM = {  has_character_flag = dragon_intel_dragonpit  } }
			}	
			modifier = {
				factor = 1.5
				FROM = { FROM = { has_character_flag = dragon_intel_old_ghis } }
			}
			modifier = {
				factor = 1.5
				FROM = { FROM = { has_character_flag = dragon_intel_volantis } }
			}
			modifier = {
				factor = 2.5
				FROM = { FROM = { has_character_flag = dragon_intel_smoking_sea } }
			}	
			modifier = {
				factor = 1.5
				FROM = { FROM = { has_character_flag = dragon_intel_asshai } }
			}
			modifier = {
				factor = 1.5
				FROM = { FROM = { has_character_flag = dragon_intel_dynamic } }
			}
			modifier = {
				factor = 2
				FROM = { FROM = { has_character_flag = dragon_intel_rebirth } }
			}
			#Demon Child
			modifier = {
				factor = 20
				FROM = { FROM = { has_character_flag = demon_child_non_pagan } }
			}	
			##Dragon Factors##		
			modifier = {
				factor = 5
				FROM = { has_character_flag = tamed_dragon }
			}
			modifier = {
				factor = 1.5
				FROM = { NOT = { martial = 20 } }
			}
			modifier = {
				factor = 0.9
				FROM = { martial = 40 } 
			}
			modifier = {
				factor = 0.8
				FROM = { martial = 60 } 
			}
			modifier = {
				factor = 0.75
				FROM = { martial = 80 } 
			}
			modifier = {
				factor = 1.5
				FROM = { trait = patient }
			}	
			modifier = {
				factor = 0.66
				FROM = { trait = wroth }
			}
			modifier = {
				factor = 2
				FROM = { trait = content }
			}
			modifier = {
				factor = 0.5
				FROM = { trait = lunatic }
			}	
			modifier = {
				factor = 1.5
				FROM = { trait = humble }
			}
			modifier = {
				factor = 1.5
				FROM = { trait = wounded_dragon }
			}			
			modifier = {
				factor = 2
				FROM = { trait = maimed_dragon }
			}
			modifier = {
				factor = 2
				FROM = { trait = sickly }
			}
			modifier = {
				factor = 1.5
				FROM = { trait = trusting }
			}
			modifier = {
				factor = 0.66
				FROM = { trait = proud }
			}			
		}
		FROM = {
			FROM = {
				set_character_flag = tamed_dragon
				character_event = { id = dragon.14 }	
				clr_character_flag = inherited_dragon			
			}	
		}	
	}
	#not tamed
	option = {	
		name = "NOT TAMED"
		ai_chance = {
			factor = 125
			modifier = {
				factor = 2
				FROM = { FROM = {  is_weak_trigger = yes } }
			}
			modifier = {
				factor = 2
				FROM = { FROM = {  trait = craven } }
			}
			modifier = {
				factor = 3
				FROM = { FROM = {  trait = imbecile } }
			}
			modifier = {
				factor = 1.5
				FROM = { FROM = {  is_dumb_trigger = yes } }
			}
			#not my dragon, harder to tame
			modifier = {
				factor = 1.5
				NOT = { FROM = { FROM = { is_friend = FROM } } }
			}
		}
		FROM = {
			FROM = {
				set_character_flag = not_tamed_dragon
				character_event = { id = dragon.15 } 
			}
			clr_character_flag = found_wild_dragon
		}	
	}
}
#wild dragon tamed
character_event = {
	id = dragon.14
	desc = "EVTDESCdragon.14"
	is_triggered_only = yes
	picture = "GFX_tamingdragon"
	
	show_from_from = yes
	
	trigger = {
		has_character_flag = tamed_dragon
	}
	
	option = {
		name = "EVTOPTAdragon.14"	
		add_trait = dragon_rider
		top_liege = {		
			if = {
				limit = { #If same culture as top liege give weak claim on that title		
					culture_group = ROOT
					NOT = { character = ROOT }
					primary_title = { NOT = { ROOT = { has_claim = PREV } } }
				}
				primary_title = { add_weak_claim = ROOT }
			}		
		}
		if = {
			limit = {
				NOT = { 
					any_liege = { 
						OR = {
							tier = EMPEROR
							trait = dragon_rider 
						}	
					} 
				}
				demesne_size = 1
				NOT = { tier = BARON }
				independent = no
				is_patrician = no
			}
			set_defacto_liege = ROOT
			#set_character_flag = new_dragon_lord
		}	
		#Make sure they a parent to avoid culling
		if = {
			limit = { 
				is_ruler = no
				NOT = { father_even_if_dead = { always = yes } } 
				NOT = { mother_even_if_dead = { always = yes } }
			}
			if = {
				limit = { NOT = { age = 20 } }
				create_character = {
					random_traits = yes
					dynasty = NONE
					female = no
					age = 36
					culture = ROOT
					religion = ROOT
				}
				new_character = {
					ROOT = { set_father = PREV }
					death = yes
				}
			}
			if = {
				limit = { 
					age = 20
					NOT = { age = 35 } 
				}
				create_character = {
					random_traits = yes
					dynasty = NONE
					female = no
					age = 51
					culture = ROOT
					religion = ROOT
				}
				new_character = {
					ROOT = { set_father = PREV }
					death = yes
				}
			}
			if = {
				limit = { age = 35 }
				create_character = {
					random_traits = yes
					dynasty = NONE
					female = no
					age = 66
					culture = ROOT
					religion = ROOT
				}
				new_character = {
					ROOT = { set_father = PREV }
					death = yes
				}
			}
		}
		hidden_tooltip = { FROM = { FROM = { character_event = { id = dragon.1499 } } } }
	}	
}
character_event = { #set dragon scope
	id = dragon.1499
	
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		FROM = {
			if = {
				limit = { ai = no }
				chronicle = {
					entry = CHRONICLE_TAMED_DRAGON
					portrait = [Root.GetID]
				}
			}
		}
		set_character_flag = tamed_dragon
		clr_character_flag = shadow_lands_dragon
		remove_character_modifier = locked_in_dragonpit
		FROM = {
			if = {
				limit = {	
					NOT = { has_character_flag = found_wild_dragon }
				}
				any_playable_ruler = {
					limit = { ai = no }
					character_event = { id = dragon.17 }
				}
			}
			if = {
				limit = {	
					has_character_flag = found_wild_dragon
				}
				ROOT = { add_friend = PREV }
				if = {
					limit = { is_ruler = yes }
					ROOT = { move_character = PREV }
				}
				if = {
					limit = { is_ruler = no }
					liege = { ROOT = { move_character = PREV } }
				}
				location = { province_event = { id = dragon.24 } }
				any_playable_ruler = {
					limit = { ai = no }
					set_character_flag = from_found_wild_dragon
					character_event = { id = dragon.17 }
				}
				clr_character_flag = found_wild_dragon
			}			
			clr_character_flag = tamed_dragon
		}	
		clr_character_flag = found_wild_dragon
	}

	option = {
		name = OK
	}
}	
#wild dragon not tamed
character_event = {
	id = dragon.15
	desc = "EVTDESCdragon.15"
	is_triggered_only = yes
	picture = "GFX_siegeoffire"
	
	show_from_from = yes
	
	trigger = {
		has_character_flag = not_tamed_dragon
	}

	option = {
		name = "EVTOPTAdragon.15"
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_TAMED_DRAGON_FAIL
				portrait = [FromFrom.GetID]
			}
		}
		clr_character_flag = not_tamed_dragon
		random_friend = {
			limit = { character = FROMFROM }
			tooltip = { remove_friend = ROOT }
		}
		prestige = -100
		hidden_tooltip = { FROM = { FROM = { character_event = { id = dragon.1599 } } } }
		random_list = {
			20 = {
				hidden_tooltip = { add_trait = fed_to_dragon }
				red_god_resurrect_effect = yes #check for rhllor resurrection
				death = { 
					death_reason = death_duel
					killer = FROMFROM
				}
			}
			50 = {
				add_trait = wounded
				hidden_tooltip = {
					character_event ={
						id = 38280 #Notify
					}
				}
			}
			30 = {
				add_trait = maimed
				hidden_tooltip = {
					character_event ={
						id = 38281 #Notify
					}
				}
			}
		}
		
	}	
}
character_event = { #set dragon scope
	id = dragon.1599
	
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		location = { province_event = { id = dragon.22 } } #Dragon establishes lair					
		if = {
			limit = {
				NOT = { is_friend = FROM }
				NOT = { has_character_flag = shadow_lands_dragon }
			}
			any_playable_ruler = {
				limit = { 
					ai = no
					NOT = { character = FROM }
					OR = {
						at_location = ROOT
						is_close_relative = FROM
					}	
				}
				character_event = { id = dragon.19 }
			}		
		}
		if = {
			limit = {
				is_friend = FROM
			}
			any_playable_ruler = {
				limit = { 
					ai = no
					NOT = { character = FROM }
				}
				character_event = { id = dragon.18 }
			}
			remove_friend = FROM
		}	
	}

	option = {
		name = OK
	}
}	
#dragon slain own notfication
# character_event = {
	# id = dragon.16
	# desc = "EVTDESCdragon.16"
	# picture = "GFX_valyria_dragon"
	
	# is_triggered_only = yes
	# show_from_from = yes
	
	# option = {
		# name = "EVTOPTAdragon.16"
		# FROM = {
			# FROM = {
				# hidden_tooltip = {
					# prestige = 0
				# }
			# }
		# }	
	# }
# }
#World dragon tamed notfication
character_event = {
	id = dragon.17
	desc = "EVTDESCdragon.17"
	picture = "GFX_tamingdragon"
	
	is_triggered_only = yes
	
	show_from_from = yes
	
	trigger = {
		NOT = { character = FROMFROM }
		OR = {
			NOT = { has_global_flag = age_of_dragons }
			has_character_flag = from_found_wild_dragon
		}
	}
	
	immediate = { 
		clr_character_flag = from_found_wild_dragon 
		if = {
			limit = {
				OR = {		
					dynasty = FROMFROM
					is_liege_or_above = FROMFROM
					is_close_relative = FROMFROM
					is_vassal_or_below = FROMFROM
				}
			}
			chronicle = {
				entry = CHRONICLE_TAMED_DRAGON_FROM
				portrait = [From.GetID]
			}
		}
	}
	
	option = {
		name = "EVTOPTAdragon.17"	
		trigger = {
			NOT = {
				OR = {
					has_global_flag = age_of_dragons
					trait = dragon_rider
				}
			}	
		}
		FROM = { tooltip = { } }
	}
	
	option = {
		name = "EVTOPTBdragon.17"	
		trigger = {
			OR = {
				has_global_flag = age_of_dragons
				trait = dragon_rider
			}
		}
		FROM = { tooltip = { } }
	}	
}
#dragon escaped first notfication
character_event = {
	id = dragon.18
	desc = "EVTDESCdragon.18"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes
	show_from_from = yes

	option = {
		name = "EVTOPTAdragon.18"	
		FROM = { tooltip = { } }
		chronicle = {
			entry = CHRONICLE_TAMED_DRAGON_FAIL_FROM
			portrait = [FromFrom.GetID]
		}
	}
}
#dragon escaped continuos notfication
character_event = {
	id = dragon.19
	desc = "EVTDESCdragon.19"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes
	show_from_from = yes

	option = {
		name = "EVTOPTAdragon.19"	
		FROM = { tooltip = { } }
		chronicle = {
			entry = CHRONICLE_TAMED_DRAGON_FAIL_FROM
			portrait = [FromFrom.GetID]
		}
	}
}
# #Inform Dragon inherited
# character_event = {
	# id = dragon.20
	# desc = "EVTDESCdragon.20"
	# picture = "GFX_siegeoffire"
	
	# is_triggered_only = yes
	
	# option = {
		# name = OK
		# random_friend = {
			# limit = { trait = dragon }
			# tooltip = { }
		# }		
	# }
# }
#Inform Dragon egg inherited
character_event = {
	id = dragon.21
	desc = "EVTDESCdragon.21"
	picture = "GFX_targaryen_eggs" 
	
	is_triggered_only = yes
	
	option = {
		name = OK
		add_trait = dragon_egg	
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_INHERITED_DRAGON_EGG
				picture = GFX_targaryen_eggs
			}
		}	
	}
}
#inform Dany given you dragon
character_event = {
	id = dragon.400
	desc = "EVTDESCdragon.400"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.400"
		random_friend = {
			limit = { trait = dragon is_alive = yes }
			tooltip = { add_friend = ROOT }
			ROOT = {
				chronicle = {
					entry = CHRONICLE_GIVEN_DRAGON
					portrait = [Prev.GetID]
				}
			}
		}
		prestige = 100
	}
}
###Dragon Lair/Province Events###
#dragon lair established
province_event = {
	id = dragon.22
	desc = "EVTDESCdragon.22"
	picture = "GFX_siegeoffire"

	is_triggered_only = yes
	
	trigger = {
		NOT = {  has_province_modifier = dragon_lair }
	}
	option = {
		name = "EVTOPTAdragon.22"		
		FROM = { FROM = { tooltip = { } } }
	}
	
}
#dragon lair established after owner's death
character_event = {
	id = dragon.2399

	is_triggered_only = yes
	hide_window = yes
	
	immediate = { 
		remove_trait = dragon #This ensures the dragon is 'immortal'
		add_trait = dragon
		
		if = { #If location is off map move on map
			limit = {
				liege = { NOT = { demesne_size = 1 } }				
			}
			random_playable_ruler = {
				limit = {
					is_alive = yes
					demesne_size = 1
					dynasty = FROM
					is_close_relative = FROM
				}
				ROOT = { 
					move_character = PREV 
					set_character_flag = moved
				}
			}	
			if = {
				limit = { NOT = { has_character_flag = moved } }
				random_playable_ruler = {
					limit = {
						is_alive = yes
						demesne_size = 1
						dynasty = FROM
					}
					ROOT = { 
						move_character = PREV 
						set_character_flag = moved
					}
				}
			}
			if = {
				limit = { NOT = { has_character_flag = moved } }
				random_playable_ruler = {
					limit = {
						is_alive = yes
						demesne_size = 1
						culture_group = FROM
					}
					ROOT = { 
						move_character = PREV 
						set_character_flag = moved
					}
				}
			}
			if = {
				limit = { NOT = { has_character_flag = moved } }
				b_sweetport_sound = {
					holder_scope = {
						ROOT = { 
							move_character = PREV 
							set_character_flag = moved
						}
					}
				}
			}
			clr_character_flag = moved
		}
		if = { #Chance of staying locked in dragonpit
			limit = {
				NOT = { has_character_flag = moved }	
				liege = { 
					OR = {
						capital_holding = { has_building = ca_dragon_pit }
						family_palace = { has_building = fp_dragon_pit }
					}
				}
			}
			random = {
				chance = 50
				add_character_modifier = {
					name = locked_in_dragonpit
					duration = -1
				}	
			}		
		}		
		if = { #33% Chance of flying to dragonmont if location does not have dragon pit
			limit = {
				OR = {
					FROM = { dynasty = 496 }
					location = { region = world_westeros } 
					mother = { location = { region = world_westeros } }
					father = { location = { region = world_westeros } }
				}	
				liege = { 
					NOR = {
						capital_holding = { has_building = ca_dragon_pit }
						family_palace = { has_building = fp_dragon_pit }
					}
				}			
			}
			remove_character_modifier = locked_in_dragonpit
			random = {
				chance = 33
				b_sweetport_sound = {
					holder_scope = {
						ROOT = { 
							move_character = PREV 
							set_character_flag = moved
						}
					}
				}
			}
			set_character_flag = moved
		}
		if = { #10% Chance of flying to dragonmont if location has dragonpit and owner of dragonstone is same dynasty as previous owner
			limit = {
				NOT = { has_character_flag = moved }
				c_dragonstone = {
					holder_scope = {
						dynasty = FROM
					}
				}	
				liege = { 
					OR = {
						capital_holding = { has_building = ca_dragon_pit }
						family_palace = { has_building = fp_dragon_pit }
					}
				}
				NOT = { has_character_modifier = locked_in_dragonpit }
			}
			random = {
				chance = 10
				b_sweetport_sound = {
					holder_scope = {
						ROOT = { 
							move_character = PREV 
							set_character_flag = moved
						}
					}
				}
			}		
		}
		if = { #50% Chance of flying to court of same dynasty as previous owner
			limit = {
				NOT = { has_character_flag = moved }
				liege = { NOT = { dynasty = FROM } }
				NOT = { has_character_modifier = locked_in_dragonpit }
			}
			random = {
				chance = 50
				random_playable_ruler = {
					limit = {
						is_alive = yes
						demesne_size = 1
						dynasty = FROM
					}
					ROOT = { 
						move_character = PREV 
						set_character_flag = moved
					}
				}
			}		
		}
		clr_character_flag = moved
		if = { #Finally move dragon to sub barony in province
			limit = { liege = { NOT = { tier = BARON } } }
			liege = {
				random_realm_lord = {
					limit = {
						tier = BARON
						at_location = ROOT
					}
					ROOT = { move_character = PREV }					
				}
			}
		}	
		location = { province_event = { id = dragon.23 } } 
	}
	
	option = {
		name = "OK"		
	}
}
province_event = {
	id = dragon.23
	desc = "EVTDESCdragon.23"
	picture = "GFX_siegeoffire"

	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.22"	
		FROM = { FROM = { tooltip = { } } }
	}
}
#dragon lair removed
province_event = {
	id = dragon.24
	desc = "EVTDESCdragon.24"
	picture = "GFX_siegeoffire"
	#hide_from = yes
	is_triggered_only = yes
	
	trigger = {
		 has_province_modifier = dragon_lair
	}
	option = {
		name = "EVTOPTAdragon.24"
		remove_province_modifier = dragon_lair
	}
	
}
#add burned land
province_event = {
	id = dragon.25
	desc = "EVTDESCdragon.25"
	picture = "GFX_siegeoffire"

	is_triggered_only = yes
	
	immediate = {
		any_province_lord = {
			limit = {
				NOT = { character = FROM }
			}
			opinion = {
				modifier = opinion_upset  
				who = FROM
				years = 6
			}
			any_courtier = {
				opinion = {
					modifier = opinion_upset   
					who = FROM
					years = 6
				}
			}
		}
	}

	option = {
		name = "EVTOPTAdragon.25"
		FROM = {
			random_friend = {
				limit = {
					trait = dragon
					age = 2
				}
				tooltip = { }
			}
		}
		if = {
			limit = {
				NOT = { has_province_modifier = burned1 }
				has_province_modifier = burned2
				NOT = {  has_province_modifier = burned3 }
			}		
			hidden_tooltip = {  remove_province_modifier = burned2 }
			add_province_modifier = {
				name = burned3
				duration = 1500
			}		
		}
		if = {
			limit = {
				NOT = {  has_province_modifier = burned2 }
				has_province_modifier = burned1
				NOT = {  has_province_modifier = burned3 }
			}
			
			hidden_tooltip = { remove_province_modifier = burned1 }
			add_province_modifier = {
				name = burned2
				duration = 1500
			}				
		}
		if = {
			limit = {
				NOT = {  has_province_modifier = burned1 }
				NOT = {  has_province_modifier = burned2 }
				NOT = {  has_province_modifier = burned3 }
			}		
			add_province_modifier = {
				name = burned1
				duration = 1500
			}		
		}
		hidden_tooltip = { remove_province_modifier = burning }
		add_province_modifier = {
			name = burning
			duration = 90
		}
	}
}
###Encountered wild escaped dragon###
character_event = { #Choose dragon
	id = dragon.2699
	desc = "EVTDESCdragon.2699"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes
	
	immediate = {
		set_character_flag = found_wild_dragon
		location = { set_province_flag = face_dragon }
		dragon = {		
			limit = {
				at_location = ROOT
				is_alive = yes
				OR = {
					NOT = { educator = { always = yes } } 
					location = { any_province_lord = { is_liege_of = PREVPREV } }
				}
				NOT = { any_friend = { always = yes is_alive = yes } }
				NOT = { has_character_flag = dragon_1 }
				NOT = { has_character_flag = dragon_2 }
				NOT = { has_character_flag = dragon_3 }
				NOT = { has_character_flag = dragon_4 }
				NOT = { has_character_flag = dany_dragon }
				OR = {
					NOT = { has_character_flag = found_wild_dragon }
					had_character_flag = { flag = found_wild_dragon days = 30 }
				}
			}
			set_character_flag = dragon_1	
		}
		dragon = {		
			limit = {
				at_location = ROOT
				is_alive = yes
				OR = {
					NOT = { educator = { always = yes } } 
					location = { any_province_lord = { is_liege_of = PREVPREV } }
				}
				NOT = { any_friend = { always = yes is_alive = yes } }
				NOT = { has_character_flag = dragon_1 }
				NOT = { has_character_flag = dragon_2 }
				NOT = { has_character_flag = dragon_3 }
				NOT = { has_character_flag = dragon_4 }
				NOT = { has_character_flag = dany_dragon }
				OR = {
					NOT = { has_character_flag = found_wild_dragon }
					had_character_flag = { flag = found_wild_dragon days = 30 }
				}
			}
			set_character_flag = dragon_2
		}
		dragon = {		
			limit = {
				at_location = ROOT
				is_alive = yes
				OR = {
					NOT = { educator = { always = yes } } 
					location = { any_province_lord = { is_liege_of = PREVPREV } }
				}
				NOT = { any_friend = { always = yes is_alive = yes } }
				NOT = { has_character_flag = dragon_1 }
				NOT = { has_character_flag = dragon_2 }
				NOT = { has_character_flag = dragon_3 }
				NOT = { has_character_flag = dragon_4 }
				NOT = { has_character_flag = dany_dragon }
				OR = {
					NOT = { has_character_flag = found_wild_dragon }
					had_character_flag = { flag = found_wild_dragon days = 30 }
				}
			}
			set_character_flag = dragon_3	
		}
		dragon = {		
			limit = {
				at_location = ROOT
				is_alive = yes
				OR = {
					NOT = { educator = { always = yes } } 
					location = { any_province_lord = { is_liege_of = PREVPREV } }
				}
				NOT = { any_friend = { always = yes is_alive = yes } }
				NOT = { has_character_flag = dragon_1 }
				NOT = { has_character_flag = dragon_2 }
				NOT = { has_character_flag = dragon_3 }
				NOT = { has_character_flag = dragon_4 }
				NOT = { has_character_flag = dany_dragon }
				OR = {
					NOT = { has_character_flag = found_wild_dragon }
					had_character_flag = { flag = found_wild_dragon days = 30 }
				}
			}
			set_character_flag = dragon_4
		}
	}
	
	option = {
		name = "EVTOPTAdragon.2699"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				dragon = {
					at_location = ROOT
					is_alive = yes
					has_character_flag = dragon_1
					OR = {
						trait = shy
						has_character_flag = shadow_lands_dragon
					}
					NOT = { has_character_modifier = locked_in_dragonpit }
				}
			}
		}
		dragon = {
			limit = {	
				at_location = ROOT
				is_alive = yes
				has_character_flag = dragon_1
			}
			character_event = { id = dragon.2698 tooltip = TOOLTIPdragon.2698 days = 2 random = 1 }
			clr_character_flag = dragon_1
			set_character_flag = found_wild_dragon
		}	
		hidden_tooltip = {
			dragon = {
				limit = {	
					at_location = ROOT
					is_alive = yes
					has_character_flag = dragon_2
				}
				clr_character_flag = dragon_2
			}
			dragon = {
				limit = {	
					at_location = ROOT
					is_alive = yes
					has_character_flag = dragon_3
				}
				clr_character_flag = dragon_3
			}
			dragon = {
				limit = {	
					at_location = ROOT
					is_alive = yes
					has_character_flag = dragon_4
				}
				clr_character_flag = dragon_4
			}
		}
	}
	option = {
		name = "EVTOPTAdragon.2699"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				dragon = {
					at_location = ROOT
					is_alive = yes
					has_character_flag = dragon_2
					OR = {
						trait = shy
						has_character_flag = shadow_lands_dragon
					}
					NOT = { has_character_modifier = locked_in_dragonpit }
				}
			}
		}
		trigger = {
			dragon = {		
				at_location = ROOT
				is_alive = yes
				has_character_flag = dragon_2
			}
		}
		dragon = {
			limit = {	
				at_location = ROOT
				is_alive = yes
				has_character_flag = dragon_2
			}
			character_event = { id = dragon.2698 tooltip = TOOLTIPdragon.2698 days = 2 random = 1 }
			clr_character_flag = dragon_2
			set_character_flag = found_wild_dragon
		}	
		hidden_tooltip = {
			dragon = {
				limit = {	
					at_location = ROOT
					is_alive = yes
					has_character_flag = dragon_1
				}
				clr_character_flag = dragon_1
			}
			dragon = {
				limit = {	
					at_location = ROOT
					is_alive = yes
					has_character_flag = dragon_3
				}
				clr_character_flag = dragon_3
			}
			dragon = {
				limit = {	
					at_location = ROOT
					is_alive = yes
					has_character_flag = dragon_4
				}
				clr_character_flag = dragon_4
			}
		}
	}
	option = {
		name = "EVTOPTAdragon.2699"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				dragon = {
					at_location = ROOT
					is_alive = yes
					has_character_flag = dragon_3
					OR = {
						trait = shy
						has_character_flag = shadow_lands_dragon
					}
					NOT = { has_character_modifier = locked_in_dragonpit }
				}
			}
		}
		trigger = {
			dragon = {		
				at_location = ROOT
				is_alive = yes
				has_character_flag = dragon_3
			}
		}
		dragon = {
			limit = {	
				at_location = ROOT
				is_alive = yes
				has_character_flag = dragon_3
			}
			character_event = { id = dragon.2698 tooltip = TOOLTIPdragon.2698 days = 2 random = 1 }
			clr_character_flag = dragon_3
			set_character_flag = found_wild_dragon
		}	
		hidden_tooltip = {
			dragon = {
				limit = {	
					at_location = ROOT
					is_alive = yes
					has_character_flag = dragon_1
				}
				clr_character_flag = dragon_1
			}
			dragon = {
				limit = {	
					at_location = ROOT
					is_alive = yes
					has_character_flag = dragon_2
				}
				clr_character_flag = dragon_2
			}
			dragon = {
				limit = {	
					at_location = ROOT
					is_alive = yes
					has_character_flag = dragon_4
				}
				clr_character_flag = dragon_4
			}
		}
	}
	option = {
		name = "EVTOPTAdragon.2699"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				dragon = {
					at_location = ROOT
					is_alive = yes
					has_character_flag = dragon_4
					OR = {
						trait = shy
						has_character_flag = shadow_lands_dragon
					}
					NOT = { has_character_modifier = locked_in_dragonpit }
				}
			}
		}
		trigger = {
			dragon = {		
				at_location = ROOT
				is_alive = yes
				has_character_flag = dragon_4
			}
		}
		dragon = {
			limit = {	
				at_location = ROOT
				is_alive = yes
				has_character_flag = dragon_4
			}
			character_event = { id = dragon.2698 tooltip = TOOLTIPdragon.2698 days = 2 random = 1 }
			clr_character_flag = dragon_4
			set_character_flag = found_wild_dragon
		}	
		hidden_tooltip = {
			dragon = {
				limit = {	
					at_location = ROOT
					is_alive = yes
					has_character_flag = dragon_1
				}
				clr_character_flag = dragon_1
			}
			dragon = {
				limit = {	
					at_location = ROOT
					is_alive = yes
					has_character_flag = dragon_3
				}
				clr_character_flag = dragon_3
			}
			dragon = {
				limit = {	
					at_location = ROOT
					is_alive = yes
					has_character_flag = dragon_2
				}
				clr_character_flag = dragon_2
			}
		}
	}
}	
character_event = { #scope to dragon
	id = dragon.2698

	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		if = { #Double check dragon doesnt have rider already
			limit = { any_friend = { is_alive = yes } }
			clr_character_flag = found_wild_dragon
			FROM = { clr_character_flag = found_wild_dragon }
			FROMFROM = { clr_character_flag = found_wild_dragon }
		}	
		if = {
			limit = { #Shy dragons cannot be found this way
				OR = {
					trait = shy
					has_character_flag = shadow_lands_dragon
				}
				NOT = { has_character_modifier = locked_in_dragonpit }
			}
			clr_character_flag = found_wild_dragon
			FROM = { character_event = { id = dragon.2695 days = 10 } } 
			FROMFROM = { character_event = { id = dragon.2695 days = 10 } } 
			set_character_flag = invalid_encounter
		}
		if = {
			limit = { #If locked in the dragonpit must be related to province owner
				has_character_modifier = locked_in_dragonpit
				NOT = {
					location = {
						owner = {
							OR = {
								character = FROM	
								dynasty = FROM
								is_close_relative = FROM
								character = FROMFROM
								dynasty = FROMFROM
								is_close_relative = FROMFROM
							}
						}
					}
				}
			}
			clr_character_flag = found_wild_dragon
			FROM = { character_event = { id = dragon.2694 days = 2 } }
			FROMFROM = { character_event = { id = dragon.2694 days = 2 } } 			
			set_character_flag = invalid_encounter
		}
		if = {
			limit = {
				NOT = { has_character_flag = invalid_encounter }
			}
			FROMFROM = { character_event = { id = dragon.26 days = 4 random = 2 } } 
		}	
		clr_character_flag = invalid_encounter	
	}
	
	option = {
		name = OK
	}	
}
#Not allowed in the dragonpit
character_event = {
	id = dragon.2694
	desc = "EVTDESCdragon.2694"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes
	
	trigger = { 
		has_character_flag = found_wild_dragon 
		NOT = { trait = dragon }
	}
	
	option = {
		name = "EVTOPTAdragon.2694"
	}
}	
#Dragon cant be found
character_event = {
	id = dragon.2695
	desc = "EVTDESCdragon.2695"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes
	
	trigger = { 
		has_character_flag = found_wild_dragon 
		NOT = { trait = dragon }
	}
	
	option = {
		name = "EVTOPTAdragon.2695"
		clr_character_flag = found_wild_dragon
	}
}	
character_event = {
	id = dragon.26
	desc = "EVTDESCdragon.26"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes
	
	trigger = { 
		has_character_flag = found_wild_dragon 
		NOT = { trait = dragon }
		NOT = { FROM = { any_friend = { is_alive = yes } } }
	}
	
	option = {
		name = "EVTOPTAdragon.26" # tame it
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				any_dynasty_member = { at_location = PREV is_alive = yes trait = dragon_rider }
			}
			modifier = {
				factor = 5
				OR = {
					capital_holding = { has_building = ca_dragon_pit }
					family_palace = { has_building = fp_dragon_pit }
					AND = {
						is_ruler = no
						liege = { 
							OR = {
								capital_holding = { has_building = ca_dragon_pit }
								family_palace = { has_building = fp_dragon_pit }
							}
						}
					}
				}
			}
			modifier = {
				factor = 3
				trait = brave
			}
			modifier = {
				factor = 2
				trait = ambitious
			}
			modifier = {
				factor = 3
				trait = genius
			}
			modifier = {
				factor = 1.5
				is_smart_trigger = yes
			}
			modifier = {
				factor = 2
				trait = lunatic
			}
			modifier = {
				factor = 5
				dynasty = 496
			}
			modifier = {
				factor = 10
				dynasty = 10012
			}
			modifier = {
				factor = 5
				culture = high_valyrian
			}
			modifier = {
				factor = 5
				culture_group = valyrian
			}
			modifier = {
				factor = 2.5
				culture = asshai
			}
			modifier = {
				factor = 5
				religion = valyrian
			}
			modifier = {
				factor = 10
				has_character_flag = daenerys_targaryen
			}
			modifier = {
				factor = 3
				has_character_flag = dragon_intel_citadel 
			}
			modifier = {
				factor = 1.5
				religion = rhllor 
			}
			modifier = {
				factor = 3
				trait = favored_by_rhllor
			}
			modifier = {
				factor = 10
				trait = chosen_by_rhllor 
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_harrenhal
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_dragonstone
			}
			modifier = {
				factor = 2.5
				has_character_flag = dragon_intel_dragonpit 
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_old_ghis
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_volantis
			}
			modifier = {
				factor = 2.5
				has_character_flag = dragon_intel_smoking_sea
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_asshai
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_dynamic
			}
			##Dragon Factors##		
			modifier = {
				factor = 5
				FROM = { has_character_flag = tamed_dragon }
			}
		}
		FROM = {
			character_event = { id = dragon.1399 tooltip = TOOLTIPdragon.1399 }
		}	
	}
	option = {
		name = "EVTOPTBdragon.26" #kill the wild beast	
		ai_chance = {
			factor = 1
			modifier = {
				factor = 2
				trait = trained_warrior 
			}
			modifier = {
				factor = 4
				trait = skilled_warrior 
			}
			modifier = {
				factor = 8
				trait = master_warrior 
			}
			modifier = {
				factor = 5
				trait = dragon_slayer 
			}
			modifier = {
				factor = 2
				trait = proud 
			}
			modifier = {
				factor = 3
				trait = brave 
			}
			modifier = {
				factor = 3
				trait = lunatic 
			}
			modifier = {
				factor = 3
				trait = wroth 
			}
			modifier = {
				factor = 0.5
				 trait = craven 
			}
			modifier = {
				factor = 0.5
				is_weak_trigger = yes
			}
		}
		if = {
			limit = { religion = nath_pagan }
			piety = -20
			custom_tooltip = { text = nath_pagan_ahimsa_tooltip }
		}
		FROM = {	
			character_event = { id = dragon.2799 tooltip = TOOLTIPdragon.2799 }
		}		
	}
	option = {
		name = "EVTOPTCdragon.26" #run		
		ai_chance = {
			factor = 20
			modifier = {
				factor = 2
				trait = craven
			}
			modifier = {
				factor = 2
				is_weak_trigger = yes
			}
			modifier = {
				factor = 2
				trait = content
			}
			##Dragon Factors##		
			modifier = {
				factor = 0.66
				FROM = { NOT = { martial = 20 } }
			}
			modifier = {
				factor = 1.1
				FROM = { martial = 40 } 
			}
			modifier = {
				factor = 1.25
				FROM = { martial = 60 } 
			}
			modifier = {
				factor = 1.33
				FROM = { martial = 80 } 
			}
			modifier = {
				factor = 0.66
				FROM = { trait = patient }
			}	
			modifier = {
				factor = 1.5
				FROM = { trait = wroth }
			}
			modifier = {
				factor = 0.5
				FROM = { trait = content }
			}
			modifier = {
				factor = 2
				FROM = { trait = lunatic }
			}	
			modifier = {
				factor = 0.66
				FROM = { trait = humble }
			}
			modifier = {
				factor = 0.66
				FROM = { trait = wounded_dragon }
			}			
			modifier = {
				factor = 0.5
				FROM = { trait = maimed_dragon }
			}
			modifier = {
				factor = 0.5
				FROM = { trait = sickly }
			}
			modifier = {
				factor = 0.66
				FROM = { trait = trusting }
			}
			modifier = {
				factor = 1.5
				FROM = { trait = proud }
			}	
		}
		if = {
			limit = { 
				NOT = { trait = craven } 
				NOT = { trait = brave }
				NOT = { trait = maester }
				NOT = { trait = archmaester }
				NOT = { trait = septon }
				NOT = { age = 50 }
			}
			random = {
				chance = 15
				add_trait = craven
				hidden_tooltip = {
					character_event ={
						id = 38257 #Notify
					}
				}
			}
		}
		if = {
			limit = { 
				trait = brave 
				NOT = { trait = maester }
				NOT = { trait = archmaester }
				NOT = { trait = septon }
				NOT = { age = 50 }
			}
			remove_trait = brave
		}
		set_character_flag = ran_from_dragon
		clr_character_flag = found_wild_dragon
		FROM = { clr_character_flag = found_wild_dragon }
		prestige = -25		
	}	
}
#Random wild dragon encounter
character_event = { 
	id = dragon.2696

	hide_window = yes
	
	min_age = 2
	
	trigger = {
		trait = dragon
		NOT = { any_friend = { always = yes is_alive = yes } }
		NOT = { has_character_flag = dany_dragon }
		OR = {
			NOT = { has_character_flag = found_wild_dragon }
			had_character_flag = { flag = found_wild_dragon days = 30 }
		}
		NOT = { has_character_modifier = locked_in_dragonpit }
	}
	
	mean_time_to_happen = {
		years = 10
		modifier = {
			factor = 0.5
			trait = wroth
		}
		modifier = {
			factor = 0.5
			trait = gluttonous
		}
		modifier = {
			factor = 0.5
			trait = lunatic
		}
		modifier = {
			factor = 2
			trait = patient
		}
		modifier = {
			factor = 2
			trait = slothful
		}
		modifier = {
			factor = 2
			trait = shy
		}		
	}
	
	immediate = { 
		location = {
			random_province_character = {
				limit = {
					age = 14
					NOT = { trait = dragon }
					NOT = { in_battle = yes }
					prisoner = no
					NOT = { trait = incapable }
					OR = {
						is_ruler = yes
						trait = brave
						has_job_title = job_marshal
						martial = 10				
						culture_group = valyrian
					}
					is_ill = no
					NOT = { trait = infirm }
					NOT = { trait = crippled }
					NOT = { trait = in_hiding }
				}
				character_event = { id = dragon.2697 }
			}
		}
	}
	
	option = {
		name = OK
	}	
}	
character_event = {
	id = dragon.2697
	desc = "EVTDESCdragon.2697"
	
	is_triggered_only = yes
	
	immediate = { 
		set_character_flag = found_wild_dragon 
		FROM = { set_character_flag = found_wild_dragon }
	}
	
	option = {
		name = "EVTOPTAdragon.26" # tame it
		trigger = {
			NOT = {
				any_friend = {
					is_alive = yes
					trait = dragon
				}
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				any_dynasty_member = { at_location = PREV is_alive = yes trait = dragon_rider }
			}
			modifier = {
				factor = 5
				OR = {
					capital_holding = { has_building = ca_dragon_pit }
					family_palace = { has_building = fp_dragon_pit }
					AND = {
						is_ruler = no
						liege = { 
							OR = {
								capital_holding = { has_building = ca_dragon_pit }
								family_palace = { has_building = fp_dragon_pit }
							}
						}
					}
				}
			}
			modifier = {
				factor = 3
				trait = brave
			}
			modifier = {
				factor = 2
				trait = ambitious
			}
			modifier = {
				factor = 3
				trait = genius
			}
			modifier = {
				factor = 1.5
				is_smart_trigger = yes
			}
			modifier = {
				factor = 2
				trait = lunatic
			}
			modifier = {
				factor = 5
				dynasty = 496
			}
			modifier = {
				factor = 10
				dynasty = 10012
			}
			modifier = {
				factor = 5
				culture = high_valyrian
			}
			modifier = {
				factor = 5
				culture_group = valyrian
			}
			modifier = {
				factor = 5
				religion = valyrian
			}
			modifier = {
				factor = 10
				has_character_flag = daenerys_targaryen
			}
			modifier = {
				factor = 3
				has_character_flag = dragon_intel_citadel 
			}
			modifier = {
				factor = 1.5
				religion = rhllor 
			}
			modifier = {
				factor = 3
				trait = favored_by_rhllor
			}
			modifier = {
				factor = 10
				trait = chosen_by_rhllor 
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_harrenhal
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_dragonstone
			}
			modifier = {
				factor = 2.5
				has_character_flag = dragon_intel_dragonpit 
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_old_ghis
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_volantis
			}
			modifier = {
				factor = 2.5
				has_character_flag = dragon_intel_smoking_sea
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_asshai
			}
			modifier = {
				factor = 1.5
				has_character_flag = dragon_intel_dynamic
			}
			modifier = {
				factor = 2
				has_character_flag = dragon_intel_rebirth
			}
			##Dragon Factors##		
			modifier = {
				factor = 5
				FROM = { has_character_flag = tamed_dragon }
			}
		}
		FROM = {
			character_event = { id = dragon.1399 tooltip = TOOLTIPdragon.1399 }
		}	
	}
	option = {
		name = "EVTOPTBdragon.26" #kill the wild beast	
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0.25
				trait = dragon_rider
			}
			modifier = {
				factor = 2
				trait = trained_warrior 
			}
			modifier = {
				factor = 4
				trait = skilled_warrior 
			}
			modifier = {
				factor = 8
				trait = master_warrior 
			}
			modifier = {
				factor = 5
				trait = dragon_slayer 
			}
			modifier = {
				factor = 2
				trait = proud 
			}
			modifier = {
				factor = 3
				trait = brave 
			}
			modifier = {
				factor = 3
				trait = lunatic 
			}
			modifier = {
				factor = 3
				trait = wroth 
			}
			modifier = {
				factor = 0.5
				 trait = craven 
			}
			modifier = {
				factor = 0.5
				is_weak_trigger = yes
			}
		}
		FROM = {	
			character_event = { id = dragon.2799 tooltip = TOOLTIPdragon.2799 }
		}		
	}
	option = {
		name = "EVTOPTCdragon.26" #run		
		ai_chance = {
			factor = 20
			modifier = {
				factor = 2
				trait = craven
			}
			modifier = {
				factor = 2
				is_weak_trigger = yes
			}
			modifier = {
				factor = 2
				trait = content
			}
			##Dragon Factors##		
			modifier = {
				factor = 0.66
				FROM = { NOT = { martial = 20 } }
			}
			modifier = {
				factor = 1.1
				FROM = { martial = 40 } 
			}
			modifier = {
				factor = 1.25
				FROM = { martial = 60 } 
			}
			modifier = {
				factor = 1.33
				FROM = { martial = 80 } 
			}
			modifier = {
				factor = 0.66
				FROM = { trait = patient }
			}	
			modifier = {
				factor = 1.5
				FROM = { trait = wroth }
			}
			modifier = {
				factor = 0.5
				FROM = { trait = content }
			}
			modifier = {
				factor = 2
				FROM = { trait = lunatic }
			}	
			modifier = {
				factor = 0.66
				FROM = { trait = humble }
			}
			modifier = {
				factor = 0.66
				FROM = { trait = wounded_dragon }
			}			
			modifier = {
				factor = 0.5
				FROM = { trait = maimed_dragon }
			}
			modifier = {
				factor = 0.5
				FROM = { trait = sickly }
			}
			modifier = {
				factor = 0.66
				FROM = { trait = trusting }
			}
			modifier = {
				factor = 1.5
				FROM = { trait = proud }
			}	
		}
		if = {
			limit = { 
				NOT = { trait = dragon_rider }
				NOT = { trait = craven } 
				NOT = { trait = brave }
				NOT = { trait = maester }
				NOT = { trait = archmaester }
				NOT = { trait = septon }
				NOT = { age = 50 }
			}
			random = {
				chance = 15
				add_trait = craven
				hidden_tooltip = {
					character_event ={
						id = 38257 #Notify
					}
				}
			}
		}
		if = {
			limit = { 
				trait = brave 
				NOT = { trait = maester }
				NOT = { trait = archmaester }
				NOT = { trait = septon }
				NOT = { trait = dragon_rider }
				NOT = { age = 50 }
			}
			remove_trait = brave
		}
		set_character_flag = ran_from_dragon
		clr_character_flag = found_wild_dragon
		prestige = -25	
		FROM = { clr_character_flag = found_wild_dragon }		
	}	
}
# Citadel Determine fightign battle a dragon
character_event = { #scope to dragon
	id = dragon.2799
	
	is_triggered_only = yes
	hide_window = yes
	
	trigger = { trait = dragon }
	
	immediate = {
		hidden_tooltip = { c_the_citadel = { holder_scope = { character_event = { id = dragon.27 } } } }
	}
	
	option = {
		name = OK
	}
}	
character_event = {
	id = dragon.27
	is_triggered_only = yes
	desc = "EVTDESCdragon.27"
	
	# Nobody but the actual referee should ever get this
	trigger = { has_landed_title = c_the_citadel }
	
	immediate = {
		if = {
			limit = {
				FROM = { FROM = { has_character_flag = battle_dragon } }	
				FROM = { 
					OR = {
						is_alive = no
						NOT = { any_friend = { always = yes } }
					}	
				}
			}
			FROM = { FROM = { set_character_flag = skip_battle_dragon } }
		}
	}
	
	#won
	option = {
		name = "WON"
		trigger = { 
			NOT = {
				FROM = { FROM = {has_character_flag = skip_battle_dragon} }
			}
		}	
		ai_chance = {
			factor = 1
			
			# Age
			modifier = {
				factor = 0
				FROM = { FROM = { NOT = { age = 10 } } }
			}
			modifier = {
				factor = 0.25
				FROM = { FROM = { NOT = { age = 12 } } }
			}
			modifier = {
				factor = 0.5
				FROM = { FROM = { NOT = { age = 16 } } }
			}
			# Dragon slayer
			modifier = {
				factor = 5
				FROM = { FROM = { trait = dragon_slayer } }
			}
			# Skill-at-Arms Effects
			modifier = {
				factor = 3
				FROM = { FROM = { trait = trained_warrior } }
			}
			modifier = {
				factor = 5
				FROM = { FROM = { trait = skilled_warrior } }
			}
			modifier = {
				factor = 8
				FROM = { FROM = { trait = master_warrior } }
			}
			# Valyrian Steel Effects
			modifier = {
				factor = 2
				FROM = {
					FROM = {
						OR = {
							has_character_modifier = owns_valyrian_steel_sword
							trait = dawn
						}
					}
				}	
			}
			# Personality Effects
			modifier = {
				factor = 2
				FROM = { FROM = { trait = brave } }
			}
			modifier = {
				factor = 2
				FROM = { FROM = { trait = wroth } }
			}
			modifier = {
				factor = 0.5
				FROM = { FROM = { trait = craven } }
			}
			# Physical Strength Effects
			modifier = {
				factor = 2
				FROM = { FROM = { is_strong_trigger = yes } }
			}
			modifier = {
				factor = 0.5
				FROM = { FROM = { is_weak_trigger = yes } }
			}
			
			# Cunning/Intelligence Effects
			modifier = {
				factor = 2
				FROM = { FROM = { trait = genius } }
			}
			modifier = {
				factor = 1.5
				FROM = { FROM = { is_smart_trigger = yes } }
			}
			modifier = {
				factor = 0.5
				FROM = { FROM = { trait = imbecile } }
			}
			modifier = {
				factor = 0.75
				FROM = { FROM = { is_dumb_trigger = yes } }
			}
			# Wound Effects
			modifier = {
				factor = 0.5
				FROM = { FROM = { trait = wounded } }
			}
			modifier = {
				factor = 0.25
				FROM = { FROM = { trait = maimed } }
			}
			modifier = {
				factor = 0.01
				FROM = { FROM = { trait = incapable } }
			}
			# Health Effects
			modifier = {
				factor = 0.75
				FROM = { FROM = { trait = ill } }
			}
			modifier = {
				factor = 0.5
				FROM = { FROM = { trait = pneumonic } }
			}
			modifier = {
				factor = 0.25
				FROM = { FROM = { trait = leper } }
			}
			modifier = {
				factor = 0.175
				FROM = { FROM = { trait = infirm } }
			}
			# Body Shape Effects
			modifier = {
				factor = 0.25
				FROM = { FROM = { trait = hunchback } }
			}
			modifier = {
				factor = 0.25
				FROM = { FROM = { trait = dwarf } }
			}
			modifier = {
				factor = 0.25
				FROM = { FROM = { trait = clubfooted } }
			}
			#my own dragon, easier to get close
			modifier = {
				factor = 4
				FROM = { FROM = { any_friend = { character = PREVPREV } } }
			}		
			##Dragon Factors##		
			modifier = {
				factor = 1.5
				FROM = { NOT = { martial = 20 } }
			}
			modifier = {
				factor = 0.9
				FROM = { martial = 40 } 
			}
			modifier = {
				factor = 0.8
				FROM = { martial = 60 } 
			}
			modifier = {
				factor = 0.75
				FROM = { martial = 80 } 
			}
			modifier = {
				factor = 0.66
				FROM = { martial = 100 } 
			}
			modifier = {
				factor = 0.66
				FROM = { trait = patient }
			}	
			modifier = {
				factor = 1.5
				FROM = { trait = wroth }
			}
			modifier = {
				factor = 0.66
				FROM = { trait = lunatic }
			}	
			modifier = {
				factor = 2
				FROM = { trait = wounded_dragon }
			}			
			modifier = {
				factor = 3
				FROM = { trait = maimed_dragon }
			}
			modifier = {
				factor = 3
				FROM = { trait = sickly }
			}	
			##Own Dragon Factors##		
			modifier = {
				factor = 250
				FROM = { FROM = { trait = dragon_rider } }
			}
			modifier = {
				factor = 0.66
				FROM = { 
					FROM = { 
						trait = dragon_rider
						any_friend = {
							trait = dragon
							is_alive = yes
							NOT = { character = PREVPREV }
							NOT = { martial = 20 }
						}	
					} 
				}
			}
			modifier = {
				factor = 1.11
				FROM = { 
					FROM = { 
						trait = dragon_rider
						any_friend = {
							trait = dragon
							is_alive = yes
							NOT = { character = PREVPREV }
							martial = 40
						}	
					} 
				}
			}
			modifier = {
				factor = 1.25
				FROM = { 
					FROM = { 
						trait = dragon_rider
						any_friend = {
							trait = dragon
							is_alive = yes
							NOT = { character = PREVPREV }
							martial = 60
						}	
					} 
				}
			}
			modifier = {
				factor = 1.33
				FROM = { 
					FROM = { 
						trait = dragon_rider
						any_friend = {
							trait = dragon
							is_alive = yes
							NOT = { character = PREVPREV }
							martial = 80
						}	
					} 
				}
			}
			modifier = {
				factor = 1.5
				FROM = { 
					FROM = { 
						trait = dragon_rider
						any_friend = {
							trait = dragon
							is_alive = yes
							NOT = { character = PREVPREV }
							martial = 100
						}	
					} 
				}
			}
			modifier = {
				factor = 1.5
				FROM = { 
					FROM = { 
						trait = dragon_rider
						any_friend = {
							trait = dragon
							is_alive = yes
							NOT = { character = PREVPREV }
							trait = patient
						}	
					} 
				}
			}	
			modifier = {
				factor = 0.66
				FROM = { 
					FROM = { 
						trait = dragon_rider
						any_friend = {
							trait = dragon
							is_alive = yes
							NOT = { character = PREVPREV }
							trait = wroth
						}	
					} 
				}
			}
			modifier = {
				factor = 1.5
				FROM = { 
					FROM = { 
						trait = dragon_rider
						any_friend = {
							trait = dragon
							is_alive = yes
							NOT = { character = PREVPREV }
							trait = lunatic
						}	
					} 
				}
			}		
		}	
		if = {
			limit = {
				FROM = { FROM = { has_character_flag = battle_dragon } }
			}
			FROM = {
				FROM = {
					character_event = { id = dragon.3410 }
				}
			}	
		}
		if = {
			limit = {
				FROM = {
					FROM = {
						any_friend = { character = PREVPREV }
						has_character_flag = tame_dragon 
					}
				}	
			}
			FROM = {
				FROM = { 
					character_event = { id = dragon.28 } 
					clr_character_flag = tame_dragon 
				}
			}		
		}
		if = {
			limit = {
				 FROM = { FROM = { has_character_flag = found_wild_dragon } }
			}	
			FROM = {
				FROM = { 
					character_event = { id = dragon.28 } 
					location = { province_event = { id = dragon.24 } } #remove dragon lair
					clr_character_flag = found_wild_dragon 
				}
			}	
		}	
		if = {
			limit = {
				 FROM = { FROM = { has_character_flag = capture_dragon } }
			}	
			FROM = {
				FROM = { 
					character_event = { id = dragon.88 } 
					clr_character_flag = capture_dragon
				}
			}	
		}	
	
	}
	#lost
	option = {
		name = "LOST"
		trigger = { 
			NOT = {
				FROM = { FROM = {has_character_flag = skip_battle_dragon} }
			}
		}	
		ai_chance = {
			factor = 1000
		}
		if = {
			limit = {
				FROM = { FROM = { has_character_flag = battle_dragon } }
			}
			FROM = {
				FROM = {
					character_event = { id = dragon.3710 }
				}
			}	
		}
		if = {
			limit = {
				FROM = {
					FROM = { 
						OR = {
							has_character_flag = tame_dragon 
							has_character_flag = found_wild_dragon
						}
					}
				}	
			}
			FROM = {
				clr_character_flag = found_wild_dragon
				FROM = {
					clr_character_flag = battle_dragon
					set_character_flag = ran_from_dragon
					character_event = { id = dragon.30 } 
				}	
			}	
		}	
		if = {
			limit = {
				 FROM = { FROM = { has_character_flag = capture_dragon } }
			}	
			FROM = {
				FROM = { 
					character_event = { id = dragon.89 } 
					clr_character_flag = capture_dragon
				}
			}	
		}	
		#FROM= {
		#	FROM = {
		#		character_event = { id = 3370037 } #lost battle debug notification
		#	}
		#}	
	}
	#no contest, dragon already killed
	option = {
		name = "NO DRAGON"
		trigger = { 
			FROM = { FROM = { has_character_flag = skip_battle_dragon } }
		}
		FROM = {
			FROM = {
				clr_character_flag = battle_dragon
				clr_character_flag = skip_battle_dragon
				character_event = { id = dragon.35 }
			}
		}	
	}
}
#Inform battle against dragon won
character_event = {
	id = dragon.28
	desc = "EVTDESCdragon.28"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes
	
	show_from_from = yes
	
	option = {
		name = "EVTOPTAdragon.28"	
		FROM = { 
			FROM = { 
				tooltip = { death = yes }
				hidden_tooltip = { character_event = { id = dragon.2999 } }
			} 
		}
		if = {
			limit = { NOT = { trait = dragon_rider } }
			add_trait = dragon_slayer
			if = {
				limit = { 
					has_nickname = no 
					NOT = { trait = dragon }
					NOT = { trait = dragon_rider }
				}
				give_nickname = nick_the_dragonslayer
			}
			prestige = 300
		}	
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_SLAYED_WILD_DRAGON
				portrait = [FromFrom.GetID]
			}
		}
	}
}
character_event = { #set dragon scope
	id = dragon.2999
	
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		any_playable_ruler = {
			limit = { 
				ai = no
				NOT = { character = FROM }
			}
			character_event = { id = dragon.29 }
		}	
		death = {
			death_reason = death_duel
			killer = FROM
		}
	}

	option = {
		name = OK
	}
}	
#World dragon slain wild notfication
character_event = {
	id = dragon.29
	desc = "EVTDESCdragon.29"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes
	show_from_from = yes
	
	option = {
		name = "EVTOPTAdragon.29"
		FROM = {
			tooltip = { }
		}
		chronicle = {
			entry = CHRONICLE_SLAYED_WILD_DRAGON_FROM
			portrait = [FromFrom.GetID]
		}
	}
}
#battle against dragon lost (wild)
character_event = {
	id = dragon.30
	desc = "EVTDESCdragon.30"
	picture = "GFX_targaryen_balerion"
	
	is_triggered_only = yes
	
	show_from_from = yes

	option = {
		name = "EVTOPTAdragon.30"	
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_LOST_TO_WILD_DRAGON
				portrait = [FromFrom.GetID]
			}
		}
		if = {
			limit = {
				has_character_flag = tame_dragon
				any_friend = { character = FROMFROM }
			}
			clr_character_flag = tame_dragon
			FROM = {
				FROM = {
					tooltip = { remove_friend = ROOT }
					hidden_tooltip = { character_event = { id = dragon.1599 } }
				}
			}
		}
		if = {
			limit = {
				in_command = yes
			}
			morale = -0.5
		}	
		prestige = -100
		random_friend = {
			limit = {
				ROOT = { trait = dragon_rider }
				trait = dragon
				is_alive = yes
				NOT = { character = FROMFROM }
			}
			random_list = {
				30 = {
				}
				50 = {
					if = {
						limit = { trait = wounded_dragon }
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
					if = {
						limit = { 
							NOT = { trait = wounded_dragon }
							NOT = { trait = maimed_dragon }
						}
						hidden_tooltip = { character_event = { id = dragon.91 } }
						add_trait = wounded_dragon
					}
				}
				20 = {
					death = {
						death_reason = death_duel
						killer = FROMFROM
					}
				}					
			}
		}
		random_list = {
			25 = {
				hidden_tooltip = { add_trait = fed_to_dragon }
				red_god_resurrect_effect = yes #check for rhllor resurrection
				death = {
					death_reason = death_duel
					killer = FROMFROM
				}
			}
			25 = {
				add_trait = depressed
				hidden_tooltip = {
					character_event ={
						id = 38288 #Notify
					}
				}
			}
			30 = {
				add_trait = wounded
				hidden_tooltip = {
					character_event ={
						id = 38280 #Notify
					}
				}
			}
			20 = {
				add_trait = maimed
				hidden_tooltip = {
					character_event ={
						id = 38281 #Notify
					}
				}
			}
		}		
	}	
}
###Field of Fire###
character_event = {
	id = dragon.31
	desc = "EVTDESCdragon.31"
	title = "EVTNAMEdragon.31"
	
	picture = "GFX_dracarys"

	is_triggered_only = yes
	
	immediate = { #Determine Dragon Strength
		set_variable = { which = "dragon_strength" value = 0 }
		random_friend = {
			limit = {
				trait = dragon
				is_alive = yes
			}
			if = {
				limit = { martial = 10	}
				ROOT = { change_variable = { which = "dragon_strength" value = 11 } }
			}
			if = {
				limit = { martial = 20	}
				ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
			}
			if = {
				limit = { martial = 30	}
				ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
			}
			if = {
				limit = { martial = 40	}
				ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
			}
			if = {
				limit = { martial = 50	}
				ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
			}
			if = {
				limit = { martial = 60	}
				ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
			}
			if = {
				limit = { martial = 70	}
				ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
			}
			if = {
				limit = { martial = 80	}
				ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
			}
			if = {
				limit = { martial = 90	}
				ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
			}
			if = {
				limit = { martial = 100	}
				ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
			}
		}
	}

	option = {
		name = "BURN_THEM_ALL"
		ai_chance = {
			factor = 75

			modifier = { 
				factor = 4
				trait = ruthless
			}
			modifier = { 
				factor = 3
				trait = wroth
			}
			modifier = { 
				factor = 3
				trait = cruel
			}
			modifier = { 
				factor = 3
				trait = ambitious
			}
			modifier = { 
				factor = 3
				trait = lunatic
			}
			# modifier = { #AI never use a young dragon in battle CHECKED IN DECISION
				# factor = 0
				# ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 20 } } }
			# }
			modifier = { 
				factor = 0.66
				ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 40 } } }
			}
			modifier = { 
				factor = 1.33
				ROOT = { check_variable = { which = "dragon_strength" value = 80 } } 
			}
			modifier = { 
				factor = 1.5
				ROOT = { check_variable = { which = "dragon_strength" value = 100 } } 
			}
		}
		set_character_flag = dragon_intel_fof 
		if = {
			limit = { religion = nath_pagan }
			piety = -30
			custom_tooltip = { text = nath_pagan_ahimsa_tooltip }
		}
		random_friend = { 
			limit = { 
				trait = dragon
				is_alive = yes
			}
			prestige = 50
			if = {
				limit = { ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 20 } } } }
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 5
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 10
						hidden_tooltip = { character_event = { id = dragon.91 } }
						add_trait = wounded_dragon
					}
				}
			}	
			if = {
				limit = { 
					ROOT = { 
						check_variable = { which = "dragon_strength" value = 20 }
						NOT = { check_variable = { which = "dragon_strength" value = 40 } } 
					} 
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 4
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 8
						add_trait = wounded_dragon
						hidden_tooltip = { character_event = { id = dragon.91 } }
					}
				}
			}
			if = {
				limit = { 
					ROOT = { 
						check_variable = { which = "dragon_strength" value = 40 }
						NOT = { check_variable = { which = "dragon_strength" value = 60 } } 
					} 
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 3
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 6
						add_trait = wounded_dragon
						hidden_tooltip = { character_event = { id = dragon.91 } }
					}
				}
			}
			if = {
				limit = { 
					ROOT = { 
						check_variable = { which = "dragon_strength" value = 60 }
						NOT = { check_variable = { which = "dragon_strength" value = 80 } } 
					} 
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 2
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 4
						add_trait = wounded_dragon
						hidden_tooltip = { character_event = { id = dragon.91 } }
					}
				}
			}
			if = {
				limit = { 
					ROOT = { 
						check_variable = { which = "dragon_strength" value = 80 }
					} 
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 1
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 2
						add_trait = wounded_dragon
						hidden_tooltip = { character_event = { id = dragon.91 } }
					}
				}
			}
		}
		#hidden_tooltip = {
			# location = {
				# any_province_character = {
					# limit = {
						# at_location = ROOT
						# prisoner = no
						# in_command = yes
						# OR = {
							# war_with = ROOT
							# any_liege = { war_with = ROOT }
							# ROOT = { any_liege = { war_with = PREVPREV } }
							# any_liege = { ROOT = { any_liege = { war_with = PREVPREV } } }
						# }
					# }	
					# if = {
						# limit = { ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 10 } } } }
						# troops = -0.05
						# morale = -0.45
					# }
					# if = {
						# limit = { 
							# ROOT = { 
								# check_variable = { which = "dragon_strength" value = 10 } 
								# NOT = { check_variable = { which = "dragon_strength" value = 20 } } 
							# }
						# }
						# troops = -0.05
						# morale = -0.5
					# }
					# if = {
						# limit = { 
							# ROOT = { 
								# check_variable = { which = "dragon_strength" value = 20 } 
								# NOT = { check_variable = { which = "dragon_strength" value = 30 } } 
							# }
						# }
						# troops = -0.1
						# morale = -0.55
					# }
					# if = {
						# limit = { 
							# ROOT = { 
								# check_variable = { which = "dragon_strength" value = 30 } 
								# NOT = { check_variable = { which = "dragon_strength" value = 40 } } 
							# }
						# }
						# troops = -0.1
						# morale = -0.6
					# }
					# if = {
						# limit = { 
							# ROOT = { 
								# check_variable = { which = "dragon_strength" value = 40 } 
								# NOT = { check_variable = { which = "dragon_strength" value = 50 } } 
							# }
						# }
						# troops = -0.15
						# morale = -0.65
					# }
					# if = {
						# limit = { 
							# ROOT = { 
								# check_variable = { which = "dragon_strength" value = 50 } 
								# NOT = { check_variable = { which = "dragon_strength" value = 60 } } 
							# }
						# }
						# troops = -0.15
						# morale = -0.7
					# }
					# if = {
						# limit = { 
							# ROOT = { 
								# check_variable = { which = "dragon_strength" value = 60 } 
								# NOT = { check_variable = { which = "dragon_strength" value = 70 } } 
							# }
						# }
						# troops = -0.2
						# morale = -0.75
					# }
					# if = {
						# limit = { 
							# ROOT = { 
								# check_variable = { which = "dragon_strength" value = 70 } 
								# NOT = { check_variable = { which = "dragon_strength" value = 80 } } 
							# }
						# }
						# troops = -0.2
						# morale = -0.8
					# }
					# if = {
						# limit = { 
							# ROOT = { 
								# check_variable = { which = "dragon_strength" value = 80 } 
								# NOT = { check_variable = { which = "dragon_strength" value = 90 } } 
							# }
						# }
						# troops = -0.25
						# morale = -0.85
					# }
					# if = {
						# limit = { 
							# ROOT = { 
								# check_variable = { which = "dragon_strength" value = 90 } 
								# NOT = { check_variable = { which = "dragon_strength" value = 100 } } 
							# }
						# }
						# troops = -0.25
						# morale = -0.9
					# }
					# if = {
						# limit = { ROOT = { check_variable = { which = "dragon_strength" value = 100 } } }
						# troops = -0.3
						# morale = -0.95
					# }	
					# set_character_flag = dragon_fof_event
					# hidden_tooltip = { character_event = { id = dragon.32 } }
				# }
			# }
			if = {
				limit = { 
					is_ruler = yes
					war = yes
					OR = {
						is_primary_war_attacker = yes
						is_primary_war_defender = yes
						independent = yes
					}
				}
				any_current_enemy = {
					limit = { 
						at_location = ROOT
						in_command = yes
						prisoner = no
						NOT = { trait = dragon_rider }
					}
					if = {
						limit = { ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 10 } } } }
						troops = -0.025
						morale = -0.15
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 10 } 
								NOT = { check_variable = { which = "dragon_strength" value = 20 } } 
							}
						}
						troops = -0.025
						morale = -0.2
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 20 } 
								NOT = { check_variable = { which = "dragon_strength" value = 30 } } 
							}
						}
						troops = -0.05
						morale = -0.25
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 30 } 
								NOT = { check_variable = { which = "dragon_strength" value = 40 } } 
							}
						}
						troops = -0.05
						morale = -0.3
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 40 } 
								NOT = { check_variable = { which = "dragon_strength" value = 50 } } 
							}
						}
						troops = -0.1
						morale = -0.35
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 50 } 
								NOT = { check_variable = { which = "dragon_strength" value = 60 } } 
							}
						}
						troops = -0.1
						morale = -0.4
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 60 } 
								NOT = { check_variable = { which = "dragon_strength" value = 70 } } 
							}
						}
						troops = -0.15
						morale = -0.45
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 70 } 
								NOT = { check_variable = { which = "dragon_strength" value = 80 } } 
							}
						}
						troops = -0.15
						morale = -0.5
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 80 } 
								NOT = { check_variable = { which = "dragon_strength" value = 90 } } 
							}
						}
						troops = -0.2
						morale = -0.55
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 90 } 
								NOT = { check_variable = { which = "dragon_strength" value = 100 } } 
							}
						}
						troops = -0.2
						morale = -0.6
					}
					if = {
						limit = { ROOT = { check_variable = { which = "dragon_strength" value = 100 } } }
						troops = -0.25
						morale = -0.65
					}	
					set_character_flag = dragon_fof_event
					hidden_tooltip = { character_event = { id = dragon.32 } }
				}	
				any_current_enemy = {
					any_realm_character = {
						limit = { 
							at_location = ROOT
							in_command = yes
							prisoner = no
							NOT = { trait = dragon_rider }
							NOT = { has_character_flag = dragon_fof_event }
						}
						if = {
							limit = { ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 10 } } } }
							troops = -0.025
							morale = -0.15
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 10 } 
									NOT = { check_variable = { which = "dragon_strength" value = 20 } } 
								}
							}
							troops = -0.025
							morale = -0.2
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 20 } 
									NOT = { check_variable = { which = "dragon_strength" value = 30 } } 
								}
							}
							troops = -0.05
							morale = -0.25
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 30 } 
									NOT = { check_variable = { which = "dragon_strength" value = 40 } } 
								}
							}
							troops = -0.05
							morale = -0.3
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 40 } 
									NOT = { check_variable = { which = "dragon_strength" value = 50 } } 
								}
							}
							troops = -0.1
							morale = -0.35
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 50 } 
									NOT = { check_variable = { which = "dragon_strength" value = 60 } } 
								}
							}
							troops = -0.1
							morale = -0.4
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 60 } 
									NOT = { check_variable = { which = "dragon_strength" value = 70 } } 
								}
							}
							troops = -0.15
							morale = -0.45
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 70 } 
									NOT = { check_variable = { which = "dragon_strength" value = 80 } } 
								}
							}
							troops = -0.15
							morale = -0.5
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 80 } 
									NOT = { check_variable = { which = "dragon_strength" value = 90 } } 
								}
							}
							troops = -0.2
							morale = -0.55
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 90 } 
									NOT = { check_variable = { which = "dragon_strength" value = 100 } } 
								}
							}
							troops = -0.2
							morale = -0.6
						}
						if = {
							limit = { ROOT = { check_variable = { which = "dragon_strength" value = 100 } } }
							troops = -0.25
							morale = -0.65
						}	
						set_character_flag = dragon_fof_event
						hidden_tooltip = { character_event = { id = dragon.32 } }					
					}			
				}
			}	
			any_liege = {
				limit = {
					NOT = { character = ROOT }
					war = yes
					OR = {
						is_primary_war_attacker = yes
						is_primary_war_defender = yes
						independent = yes
					}
				}
				any_current_enemy = {
					limit = { 
						at_location = ROOT
						in_command = yes
						prisoner = no
						NOT = { trait = dragon_rider }
						NOT = { has_character_flag = dragon_fof_event }
					}
					if = {
						limit = { ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 10 } } } }
						troops = -0.025
						morale = -0.15
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 10 } 
								NOT = { check_variable = { which = "dragon_strength" value = 20 } } 
							}
						}
						troops = -0.025
						morale = -0.2
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 20 } 
								NOT = { check_variable = { which = "dragon_strength" value = 30 } } 
							}
						}
						troops = -0.05
						morale = -0.25
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 30 } 
								NOT = { check_variable = { which = "dragon_strength" value = 40 } } 
							}
						}
						troops = -0.05
						morale = -0.3
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 40 } 
								NOT = { check_variable = { which = "dragon_strength" value = 50 } } 
							}
						}
						troops = -0.1
						morale = -0.35
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 50 } 
								NOT = { check_variable = { which = "dragon_strength" value = 60 } } 
							}
						}
						troops = -0.1
						morale = -0.4
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 60 } 
								NOT = { check_variable = { which = "dragon_strength" value = 70 } } 
							}
						}
						troops = -0.15
						morale = -0.45
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 70 } 
								NOT = { check_variable = { which = "dragon_strength" value = 80 } } 
							}
						}
						troops = -0.15
						morale = -0.5
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 80 } 
								NOT = { check_variable = { which = "dragon_strength" value = 90 } } 
							}
						}
						troops = -0.2
						morale = -0.55
					}
					if = {
						limit = { 
							ROOT = { 
								check_variable = { which = "dragon_strength" value = 90 } 
								NOT = { check_variable = { which = "dragon_strength" value = 100 } } 
							}
						}
						troops = -0.2
						morale = -0.6
					}
					if = {
						limit = { ROOT = { check_variable = { which = "dragon_strength" value = 100 } } }
						troops = -0.25
						morale = -0.65
					}	
					set_character_flag = dragon_fof_event
					hidden_tooltip = { character_event = { id = dragon.32 } }
				}	
				any_current_enemy = {
					any_realm_character = {
						limit = { 
							at_location = ROOT
							in_command = yes
							prisoner = no
							NOT = { trait = dragon_rider }
							NOT = { has_character_flag = dragon_fof_event }
						}
						if = {
							limit = { ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 10 } } } }
							troops = -0.025
							morale = -0.15
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 10 } 
									NOT = { check_variable = { which = "dragon_strength" value = 20 } } 
								}
							}
							troops = -0.025
							morale = -0.2
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 20 } 
									NOT = { check_variable = { which = "dragon_strength" value = 30 } } 
								}
							}
							troops = -0.05
							morale = -0.25
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 30 } 
									NOT = { check_variable = { which = "dragon_strength" value = 40 } } 
								}
							}
							troops = -0.05
							morale = -0.3
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 40 } 
									NOT = { check_variable = { which = "dragon_strength" value = 50 } } 
								}
							}
							troops = -0.1
							morale = -0.35
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 50 } 
									NOT = { check_variable = { which = "dragon_strength" value = 60 } } 
								}
							}
							troops = -0.1
							morale = -0.4
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 60 } 
									NOT = { check_variable = { which = "dragon_strength" value = 70 } } 
								}
							}
							troops = -0.15
							morale = -0.45
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 70 } 
									NOT = { check_variable = { which = "dragon_strength" value = 80 } } 
								}
							}
							troops = -0.15
							morale = -0.5
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 80 } 
									NOT = { check_variable = { which = "dragon_strength" value = 90 } } 
								}
							}
							troops = -0.2
							morale = -0.55
						}
						if = {
							limit = { 
								ROOT = { 
									check_variable = { which = "dragon_strength" value = 90 } 
									NOT = { check_variable = { which = "dragon_strength" value = 100 } } 
								}
							}
							troops = -0.2
							morale = -0.6
						}
						if = {
							limit = { ROOT = { check_variable = { which = "dragon_strength" value = 100 } } }
							troops = -0.25
							morale = -0.65
						}	
						set_character_flag = dragon_fof_event
						hidden_tooltip = { character_event = { id = dragon.32 } }				
					}			
				}
			}
			# any_independent_ruler = {
				# limit = {
					# mercenary = yes
					# at_location = ROOT
					# in_command = yes
					# prisoner = no
					# NOT = { trait = dragon_rider }
					# NOT = { has_character_flag = dragon_fof_event }
				# }
				# if = {
					# limit = { ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 10 } } } }
					# troops = -0.05
					# morale = -0.45
				# }
				# if = {
					# limit = { 
						# ROOT = { 
							# check_variable = { which = "dragon_strength" value = 10 } 
							# NOT = { check_variable = { which = "dragon_strength" value = 20 } } 
						# }
					# }
					# troops = -0.05
					# morale = -0.5
				# }
				# if = {
					# limit = { 
						# ROOT = { 
							# check_variable = { which = "dragon_strength" value = 20 } 
							# NOT = { check_variable = { which = "dragon_strength" value = 30 } } 
						# }
					# }
					# troops = -0.1
					# morale = -0.55
				# }
				# if = {
					# limit = { 
						# ROOT = { 
							# check_variable = { which = "dragon_strength" value = 30 } 
							# NOT = { check_variable = { which = "dragon_strength" value = 40 } } 
						# }
					# }
					# troops = -0.1
					# morale = -0.6
				# }
				# if = {
					# limit = { 
						# ROOT = { 
							# check_variable = { which = "dragon_strength" value = 40 } 
							# NOT = { check_variable = { which = "dragon_strength" value = 50 } } 
						# }
					# }
					# troops = -0.15
					# morale = -0.65
				# }
				# if = {
					# limit = { 
						# ROOT = { 
							# check_variable = { which = "dragon_strength" value = 50 } 
							# NOT = { check_variable = { which = "dragon_strength" value = 60 } } 
						# }
					# }
					# troops = -0.15
					# morale = -0.7
				# }
				# if = {
					# limit = { 
						# ROOT = { 
							# check_variable = { which = "dragon_strength" value = 60 } 
							# NOT = { check_variable = { which = "dragon_strength" value = 70 } } 
						# }
					# }
					# troops = -0.2
					# morale = -0.75
				# }
				# if = {
					# limit = { 
						# ROOT = { 
							# check_variable = { which = "dragon_strength" value = 70 } 
							# NOT = { check_variable = { which = "dragon_strength" value = 80 } } 
						# }
					# }
					# troops = -0.2
					# morale = -0.8
				# }
				# if = {
					# limit = { 
						# ROOT = { 
							# check_variable = { which = "dragon_strength" value = 80 } 
							# NOT = { check_variable = { which = "dragon_strength" value = 90 } } 
						# }
					# }
					# troops = -0.25
					# morale = -0.85
				# }
				# if = {
					# limit = { 
						# ROOT = { 
							# check_variable = { which = "dragon_strength" value = 90 } 
							# NOT = { check_variable = { which = "dragon_strength" value = 100 } } 
						# }
					# }
					# troops = -0.25
					# morale = -0.9
				# }
				# if = {
					# limit = { ROOT = { check_variable = { which = "dragon_strength" value = 100 } } }
					# troops = -0.3
					# morale = -0.95
				# }				
				# hidden_tooltip = { character_event = { id = dragon.32 } }
			# }
			random = {
				chance = 33
				location = { province_event = { id = dragon.25 } }
			}
		#}	
	}
	option = {
		name = "not_now_dracarys"
		ai_chance = {
			factor = 5
		}
		if = {
			limit = { ai = no }
			clr_character_flag = dragon_used_battle
		}	
	}
}
#attacked by dragon during battle
character_event = {
	id = dragon.32
	desc = "getting_burned" #fieldoffire
	title = "EVTNAMEdragon.31"
	
	picture = "GFX_fieldoffire"

	is_triggered_only = yes
	min_age = 14
	capable_only = yes
	prisoner = no

	trigger = {
		NOT = { trait = dragon_rider }
		FROM = {
			NOT = { character = ROOT }
			trait = dragon_rider
		}
	}
	
	#run
	option = {
		name = "your_host_just_got_burned_by_dragons"
		prestige = -30
		ai_chance = {
			factor = 25
			modifier = {
				factor = 4
				in_command = no
			}
			modifier = {
				factor = 2
				trait = craven 
			}
			modifier = {
				factor = 1.5
				is_weak_trigger = yes 
			}	
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 martial = 40 } }
			}
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 martial = 60 } }
			}
			modifier = {
				factor = 2
				FROM = { any_friend = { trait = dragon age = 2 martial = 80 } }
			}
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 martial = 100 } }
			}
		}
		clr_character_flag = dragon_fof_event	
		set_character_flag = ran_from_dragon			
	}
	#stand
	option = {
		name = "stand_and_fight"
		ai_chance = {
			factor = 1
			modifier = {
				factor = 2
				trait = trained_warrior 
			}
			modifier = {
				factor = 4
				trait = skilled_warrior 
			}
			modifier = {
				factor = 8
				trait = master_warrior 
			}
			modifier = {
				factor = 5
				trait = dragon_slayer 
			}
			modifier = {
				factor = 2
				trait = proud 
			}
			modifier = {
				factor = 3
				trait = brave 
			}
			modifier = {
				factor = 3
				trait = lunatic 
			}
			modifier = {
				factor = 3
				trait = wroth 
			}
			modifier = {
				factor = 2
				NOT = { trait = craven }
			}	
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 trait = wounded_dragon } }
			}
			modifier = {
				factor = 2
				FROM = { any_friend = { trait = dragon age = 2 trait = maimed_dragon } }
			}	
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 trait = sickly } }
			}				
		}
		clr_character_flag = dragon_fof_event	
		set_character_flag = battle_dragon
		FROM = {
			random_friend = {
				limit = {
					trait = dragon
					age = 2
				}
				character_event = { id = dragon.2799 tooltip = TOOLTIPdragon.2799 }
			}
		}				
	}
}
#Meeting a dragonrider in battle
character_event = { 
	id = dragon.33
	border = "GFX_event_normal_frame_war"
	desc = "getting_burned" #fieldoffire
	title = "EVTNAMEdragon.31"
	picture = "GFX_fieldoffire"

	is_triggered_only = yes
	
	trigger = {
		in_battle = yes
		NOT = { has_character_flag = battle_dragon }
		OR = {
			NOT = { has_character_flag = ran_from_dragon }
			had_character_flag = { flag = ran_from_dragon days = 90 } 
		}
	}
	
	#run
	option = {
		name = "your_host_just_got_burned_by_dragons"
		prestige = -30
		ai_chance = {
			factor = 25
			modifier = {
				factor = 2
				trait = craven 
			}
			modifier = {
				factor = 1.5
				is_weak_trigger = yes 
			}	
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 martial = 40 } }
			}
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 martial = 60 } }
			}
			modifier = {
				factor = 2
				FROM = { any_friend = { trait = dragon age = 2 martial = 80 } }
			}
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 martial = 100 } }
			}
		}
		set_character_flag = ran_from_dragon			
	}
	#stand
	option = {
		name = "stand_and_fight"
		ai_chance = {
			factor = 1
			modifier = {
				factor = 2
				trait = trained_warrior 
			}
			modifier = {
				factor = 4
				trait = skilled_warrior 
			}
			modifier = {
				factor = 8
				trait = master_warrior 
			}
			modifier = {
				factor = 5
				trait = dragon_slayer 
			}
			modifier = {
				factor = 2
				trait = proud 
			}
			modifier = {
				factor = 3
				trait = brave 
			}
			modifier = {
				factor = 3
				trait = lunatic 
			}
			modifier = {
				factor = 3
				trait = wroth 
			}
			modifier = {
				factor = 2
				NOT = { trait = craven }
			}	
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 trait = wounded_dragon } }
			}
			modifier = {
				factor = 2
				FROM = { any_friend = { trait = dragon age = 2 trait = maimed_dragon } }
			}	
			modifier = {
				factor = 1.5
				FROM = { any_friend = { trait = dragon age = 2 trait = sickly } }
			}				
		}
		morale = 0.1	
		set_character_flag = battle_dragon
		FROM = {
			random_friend = {
				limit = {
					trait = dragon
					age = 2
				}
				character_event = { id = dragon.2799 tooltip = TOOLTIPdragon.2799 }
			}
		}		
	}	
}
#Inform I killed dragon in battle
character_event = {
	id = dragon.3410
	desc = "EVTDESCdragon.3410"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.28"
		tooltip = {
			FROM = {
				FROM = {
					death = yes
				}
			}
		}
		add_trait = dragon_slayer
		if = {
			limit = { 
				has_nickname = no 
				NOT = { trait = dragon }
				NOT = { trait = dragon_rider }
			}
			give_nickname = nick_the_dragonslayer
		}
		prestige = 300
		morale = 0.5
		hidden_tooltip = {
			FROM = { FROM = { character_event = { id = dragon.3499 } } }			
		}
		if = {
			limit = { ai = no }
			FROMFROM = {
				random_friend = {
					save_event_target_as = dragons_rider #for localisation
				}
			}
			chronicle = {
				entry = CHRONICLE_SLAYED_DRAGON_IN_BATTLE
				portrait = [FromFrom.GetID]
			}
		}
	}
}
character_event = { #set dragon scope
	id = dragon.3499
	
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		random_friend = { character_event = { id = dragon.34 } }
		any_playable_ruler = {
			limit = { 
				ai = no 
				NOT = { character = FROM }
				NOT = { is_friend = ROOT }
			}	
			character_event = { id = dragon.36 } #slain combat
		}
		death = {
			death_reason = death_battle
			killer = FROM
		}
	}

	option = {
		name = OK
	}
}	
character_event = {
	id = dragon.34
	desc = "EVTDESCdragon.34"
	picture = "GFX_valyria_dragon"
	
	show_from_from = yes
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.34"
		remove_trait = dragon_rider
		random_list = {
			35 = {
			}
			25 = {
				add_trait = depressed
				hidden_tooltip = {
					character_event ={
						id = 38288 #Notify
					}
				}
			}
			25 = {
				add_trait = wounded
				hidden_tooltip = {
					character_event ={
						id = 38280 #Notify
					}
				}
			}
			10 = {
				add_trait = maimed
				hidden_tooltip = {
					character_event ={
						id = 38281 #Notify
					}
				}
			}
			5 = {
				red_god_resurrect_effect = yes #check for rhllor resurrection
				death = {
					death_reason = death_battle
					killer = FROMFROM
				}
			}
		}
	}
}

#Inform dragon already dead
character_event = {
	id = dragon.35
	desc = "EVTDESCdragon.35"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes

	show_from_from = yes
		
	option = {
		name = "EVTOPTAdragon.35"
		prestige = 25
	}
}
#World dragon slain battle notification
character_event = {
	id = dragon.36
	desc = "EVTDESCdragon.36"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes
	
	show_from_from = yes
	
	option = {
		name = "EVTOPTAdragon.36"
		chronicle = {
			entry = CHRONICLE_SLAYED_DRAGON_IN_BATTLE_FROM
			portrait = [FromFrom.GetID]
		}
		FROM = {
			FROM = {
				tooltip = { }
			}
		}
		FROM = {
			tooltip = { }
		}	
	}	
}
#battle against dragon lost (dragon rider)
character_event = {
	id = dragon.3710
	desc = "EVTDESCdragon.3710"
	picture = "GFX_targaryen_balerion"
	
	is_triggered_only = yes
	show_from_from = yes

	option = {
		name = "EVTOPTAdragon.30"	
		hidden_tooltip = {
			FROM = {
				FROM = {
					random_friend = {
						character_event = { id = dragon.37 }
					}
				}
			}
			if = {
				limit = { ai = no }
				FROMFROM = {
					random_friend = {
						save_event_target_as = dragons_rider #for localisation
					}
				}
				chronicle = {
					entry = CHRONICLE_LOST_TO_DRAGON_IN_BATTLE
					portrait = [FromFrom.GetID]
				}
			}
		}
		if = {
			limit = {
				in_command = yes
			}
			morale = -0.5
		}	
		prestige = -25
		random_list = {
			25 = {
				set_character_flag = death
				tooltip = {
					death = {
						death_reason = death_battle
						killer = FROM
					}
				}	
			}
			25 = {
				set_character_flag = depressed
				add_trait = depressed
				hidden_tooltip = {
					character_event ={
						id = 38288 #Notify
					}
				}
			}
			30 = {
				set_character_flag = wounded
				add_trait = wounded
				hidden_tooltip = {
					character_event ={
						id = 38280 #Notify
					}
				}
			}
			20 = {
				set_character_flag = maimed
				add_trait = maimed
				hidden_tooltip = {
					character_event ={
						id = 38281 #Notify
					}
				}
			}
		}
	}	
}
#Inform Rider enemy KIA against dragon
character_event = {
	id = dragon.37
	picture = "GFX_valyria_dragon"
	
	desc = {
		text = "EVTDESCAdragon.37"
		trigger = { FROM = { NOT = { has_character_flag = death } } }
	}
	desc = {
		text = "EVTDESCBdragon.37"
		trigger = { FROM = { has_character_flag = death } }
	}
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.37"
		FROM = {
			if = {
				limit = { has_character_flag = death }
				ROOT_murder_red_god_resurrect_effect = yes #check for rhllor resurrection
				death = {
					death_reason = death_battle
					killer = ROOT
				}
			}
			if = {
				limit = { has_character_flag = depressed }
				tooltip = {
					add_trait = depressed
				}
				clr_character_flag = depressed
			}
			if = {
				limit = { has_character_flag = wounded }
				tooltip = {
					add_trait = wounded
				}
				clr_character_flag = wounded
			}
			if = {
				limit = { has_character_flag = maimed }
				tooltip = {
					add_trait = maimed
				}
				clr_character_flag = maimed
			}
		}
	}
}


# #Lord defeated by dragon
# character_event = {
	# id = 3370037
	# desc = "EVTDESC3370037"
	# picture = "GFX_valyria_dragon"
	# is_triggered_only = yes
	# hide_from = yes
	# show_from_from = yes
	# option = {
		# name = "EVTOPTA3370037"
		# FROM = {
			# FROM = {
				# hidden_tooltip = {
					# prestige = 0
				# }
			# }
		# }
	# }
# }
###Siege of fire###
character_event = {
	id = dragon.38
	desc = "siege_of_fire"
	picture = "GFX_siegeoffire"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes

	trigger = {
		trait = dragon_rider
	}
	
	immediate = { #Determine Dragon Strength
		set_variable = { which = "dragon_strength" value = 0 }
		random_friend = {
			limit = {
				trait = dragon
				is_alive = yes
			}
			if = {
				limit = { martial = 10	}
				ROOT = { change_variable = { which = "dragon_strength" value = 11 } }
			}
			if = {
				limit = { martial = 20	}
				ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
			}
			if = {
				limit = { martial = 30	}
				ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
			}
			if = {
				limit = { martial = 40	}
				ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
			}
			if = {
				limit = { martial = 50	}
				ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
			}
			if = {
				limit = { martial = 60	}
				ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
			}
			if = {
				limit = { martial = 70	}
				ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
			}
			if = {
				limit = { martial = 80	}
				ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
			}
			if = {
				limit = { martial = 90	}
				ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
			}
			if = {
				limit = { martial = 100	}
				ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
			}
		}
	}
	
	option = {
		name = "BURN_THEM_ALL"
		ai_chance = {
			factor = 75
			modifier = { #Don't burn own/liege's castle
				factor = 0
				location = {
					any_province_lord = {
						OR = {
							character = ROOT
							ROOT = { is_liege_or_above = PREV }
						}	
					}
				}
			}
			modifier = { #Reluctant to burn same realm castles, unless ruthless
				factor = 0.2
				NOT = { trait = ruthless }
				location = {
					any_province_lord = {
						same_realm = ROOT
					}
				}
			}
			modifier = { #Enemy's castle
				factor = 2
				location = {
					any_province_lord = {
						any_current_enemy = { character = ROOT }	
					}
				}
			}
			modifier = { 
				factor = 0.2 #My family is in castle
				location = {
					any_province_character = {
						is_close_relative = ROOT
						in_command = no					
						at_location = ROOT		
						NOT = { character = ROOT }	
						NOT = { educator = { character = ROOT } }
					}
				}
			}
			modifier = { 
				factor = 4
				trait = ruthless
			}
			modifier = { 
				factor = 3
				trait = wroth
			}
			modifier = { 
				factor = 3
				trait = cruel
			}
			modifier = { 
				factor = 3
				trait = ambitious
			}
			modifier = { 
				factor = 3
				trait = lunatic
			}
			# modifier = { #AI never use a young dragon in siege CHECKED IN DECISION
				# factor = 0
				# ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 20 } } }
			# }
			modifier = { 
				factor = 0.66
				ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 40 } } }
			}
			modifier = { 
				factor = 1.33
				ROOT = { check_variable = { which = "dragon_strength" value = 80 } } 
			}
			modifier = { 
				factor = 1.5
				ROOT = { check_variable = { which = "dragon_strength" value = 100 } } 
			}
		}
		trigger = {
			NOT = {
				dragon_rider = {
					OR = {
						NOT = { has_character_flag = stayed_castle_dd }
						had_character_flag = { flag = stayed_castle_dd days = 10 }
					}				
					at_location = ROOT
					any_friend = { trait = dragon age = 2 }
					in_command = no
					prisoner = no
					NOT = { trait = incapable }
					NOT = { trait = in_hiding }
					OR = {
						war_with = ROOT
						ROOT = { any_liege = { war_with = PREVPREV } }
						any_liege = { 
							OR = {
								war_with = ROOT 
								ROOT = { any_liege = { war_with = PREVPREV } }
							}	
						}
					}
					NOT = {
						OR = {
							is_liege_or_above = ROOT
							ROOT = { is_liege_or_above = PREV }
						}
					}				
				}
			}
		}
		if = {
			limit = { religion = nath_pagan }
			piety = -40
			custom_tooltip = { text = nath_pagan_ahimsa_tooltip }
		}
		set_character_flag = dragon_intel_harrenhal
		siege = {
			enemy = {
				if = {
					limit = { ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 10 } } } }
					morale = -0.2
					troops = -0.2
					hidden_tooltip = { event_target:siege_of_fire_target = { character_event = { id = dragon.32 } } }
				}
				if = {
					limit = { 
						ROOT = { 
							check_variable = { which = "dragon_strength" value = 10 } 
							NOT = { check_variable = { which = "dragon_strength" value = 20 } } 
						}
					}
					morale = -0.25
					troops = -0.25
					hidden_tooltip = { event_target:siege_of_fire_target = { character_event = { id = dragon.32 } } }
				}
				if = {
					limit = { 
						ROOT = { 
							check_variable = { which = "dragon_strength" value = 20 } 
							NOT = { check_variable = { which = "dragon_strength" value = 30 } } 
						}
					}
					morale = -0.3
					troops = -0.3
					hidden_tooltip = { event_target:siege_of_fire_target = { character_event = { id = dragon.32 } } }
				}
				if = {
					limit = { 
						ROOT = { 
							check_variable = { which = "dragon_strength" value = 30 } 
							NOT = { check_variable = { which = "dragon_strength" value = 40 } } 
						}
					}
					morale = -0.35
					troops = -0.35
					hidden_tooltip = { event_target:siege_of_fire_target = { character_event = { id = dragon.32 } } }
				}
				if = {
					limit = { 
						ROOT = { 
							check_variable = { which = "dragon_strength" value = 40 } 
							NOT = { check_variable = { which = "dragon_strength" value = 50 } } 
						}
					}
					morale = -0.4
					troops = -0.4
					hidden_tooltip = { event_target:siege_of_fire_target = { character_event = { id = dragon.32 } } }
				}
				if = {
					limit = { 
						ROOT = { 
							check_variable = { which = "dragon_strength" value = 50 } 
							NOT = { check_variable = { which = "dragon_strength" value = 60 } } 
						}
					}
					morale = -0.5
					troops = -0.5
					hidden_tooltip = { event_target:siege_of_fire_target = { character_event = { id = dragon.32 } } }
				}
				if = {
					limit = { 
						ROOT = { 
							check_variable = { which = "dragon_strength" value = 60 } 
							NOT = { check_variable = { which = "dragon_strength" value = 70 } } 
						}
					}
					morale = -0.6
					troops = -0.6
					event_target:siege_of_fire_target = {
						random_list = {
							99 = { character_event = { id = dragon.32 tooltip = TOOLTIPdragon.32B } }
							1 = { character_event = { id = dragon.40 tooltip = TOOLTIPdragon.40 } }
						}	
					}
				}
				if = {
					limit = { 
						ROOT = { 
							check_variable = { which = "dragon_strength" value = 70 } 
							NOT = { check_variable = { which = "dragon_strength" value = 80 } } 
						}
					}
					morale = -0.7
					troops = -0.7
					event_target:siege_of_fire_target = {
						random_list = {
							98 = { character_event = { id = dragon.32 tooltip = TOOLTIPdragon.32B } }
							2 = { character_event = { id = dragon.40 tooltip = TOOLTIPdragon.40 } }
						}	
					}
				}
				if = {
					limit = { 
						ROOT = { 
							check_variable = { which = "dragon_strength" value = 80 } 
							NOT = { check_variable = { which = "dragon_strength" value = 90 } } 
						}
					}
					morale = -0.8
					troops = -0.8
					event_target:siege_of_fire_target = {
						random_list = {
							95 = { character_event = { id = dragon.32 tooltip = TOOLTIPdragon.32B } }
							5 = { character_event = { id = dragon.40 tooltip = TOOLTIPdragon.40 } }
						}	
					}
				}
				if = {
					limit = { 
						ROOT = { 
							check_variable = { which = "dragon_strength" value = 90 } 
							NOT = { check_variable = { which = "dragon_strength" value = 100 } } 
						}
					}
					morale = -0.9
					troops = -0.9
					event_target:siege_of_fire_target = {
						random_list = {
							90 = { character_event = { id = dragon.32 tooltip = TOOLTIPdragon.32B } }
							10 = { character_event = { id = dragon.40 tooltip = TOOLTIPdragon.40 } }
						}	
					}
				}
				if = {
					limit = { ROOT = { check_variable = { which = "dragon_strength" value = 100 } } }
					morale = -1.0
					troops = -1.0
					event_target:siege_of_fire_target = {
						random_list = {
							80 = { character_event = { id = dragon.32 tooltip = TOOLTIPdragon.32 } }
							20 = { character_event = { id = dragon.40 tooltip = TOOLTIPdragon.40 } }
						}	
					}
				}
			}
		}
		hidden_tooltip = { event_target:siege_of_fire_target = { clear_event_target = siege_of_fire_target } }
		random_friend = { 
			limit = { 
				trait = dragon
				is_alive = yes
			}
			prestige = 50
			if = {
				limit = { ROOT = { NOT = { check_variable = { which = "dragon_strength" value = 20 } } } }
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 5
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 10
						add_trait = wounded_dragon
						hidden_tooltip = { character_event = { id = dragon.91 } }
					}
				}
			}	
			if = {
				limit = { 
					ROOT = { 
						check_variable = { which = "dragon_strength" value = 20 }
						NOT = { check_variable = { which = "dragon_strength" value = 40 } } 
					} 
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 4
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 8
						add_trait = wounded_dragon
						hidden_tooltip = { character_event = { id = dragon.91 } }
					}
				}
			}
			if = {
				limit = { 
					ROOT = { 
						check_variable = { which = "dragon_strength" value = 40 }
						NOT = { check_variable = { which = "dragon_strength" value = 60 } } 
					} 
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 3
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 6
						add_trait = wounded_dragon
						hidden_tooltip = { character_event = { id = dragon.91 } }
					}
				}
			}
			if = {
				limit = { 
					ROOT = { 
						check_variable = { which = "dragon_strength" value = 60 }
						NOT = { check_variable = { which = "dragon_strength" value = 80 } } 
					} 
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 2
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 4
						add_trait = wounded_dragon
						hidden_tooltip = { character_event = { id = dragon.91 } }
					}
				}
			}
			if = {
				limit = { 
					ROOT = { 
						check_variable = { which = "dragon_strength" value = 80 }
					} 
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } }
					random = {
						chance = 1
						hidden_tooltip = { 
							remove_trait = wounded_dragon
							character_event = { id = dragon.93 }
						}
						add_trait = maimed_dragon
					}
				}
				if = {
					limit = { NOT = { trait = maimed_dragon } NOT = { trait = wounded_dragon } }
					random = {
						chance = 2
						add_trait = wounded_dragon
						hidden_tooltip = { character_event = { id = dragon.91 } }
					}
				}
			}
		}
		location = { 
			province_event = { id = dragon.25 } 
			if = {
				limit = { 
					province_id = 107 
					has_global_flag = aegons_conquest
					ROOT = { check_variable = { which = "dragon_strength" value = 90 } }
				}
				hidden_tooltip = { remove_province_modifier = completeharren3 }
				b_kingharren1 = { add_building = ca_harrenhal_ruins }
				b_kingharren2 = { add_building = ca_harrenhal_ruins }
				b_kingharren3 = { add_building = ca_harrenhal_ruins }
			}
		}
		set_character_flag = dragon_used		
	}
	#enemy dragonrider is in castle, duel him
	option = { 
		name = "EVTOPTBdragon.38"
		trigger = {
			dragon_rider = {
				OR = {
					NOT = { has_character_flag = stayed_castle_dd }
					had_character_flag = { flag = stayed_castle_dd days = 10 }
				}
				at_location = ROOT
				any_friend = { trait = dragon age = 2 }
				in_command = no
				prisoner = no
				NOT = { trait = incapable }
				NOT = { trait = in_hiding }
				OR = {
					war_with = ROOT
					ROOT = { any_liege = { war_with = PREVPREV } }
					any_liege = { 
						OR = {
							war_with = ROOT 
							ROOT = { any_liege = { war_with = PREVPREV } }
						}	
					}
				}
				NOT = {
					OR = {
						is_liege_or_above = ROOT
						ROOT = { is_liege_or_above = PREV }
					}
				}				
			}
		}
		ai_chance = {
			factor = 75
			modifier = { 
				factor = 4
				trait = brave
			}
			modifier = { 
				factor = 0.25
				trait = craven
			}
			modifier = { 
				factor = 3
				trait = wroth
			}
			modifier = { 
				factor = 3
				trait = ambitious
			}
			modifier = { 
				factor = 3
				trait = lunatic
			}
		}	
		hidden_tooltip = { event_target:siege_of_fire_target = { clear_event_target = siege_of_fire_target clr_character_flag = siege_leader } }
		dragon_rider = {
			limit = {
				OR = {
					NOT = { has_character_flag = stayed_castle_dd }
					had_character_flag = { flag = stayed_castle_dd days = 10 }
				}
				at_location = ROOT
				any_friend = { trait = dragon age = 2 }
				in_command = no
				prisoner = no
				NOT = { trait = incapable }
				NOT = { trait = in_hiding }
				OR = {
					war_with = ROOT
					ROOT = { any_liege = { war_with = PREVPREV } }
					any_liege = { 
						OR = {
							war_with = ROOT 
							ROOT = { any_liege = { war_with = PREVPREV } }
						}	
					}
				}
				NOT = {
					OR = {
						is_liege_or_above = ROOT
						ROOT = { is_liege_or_above = PREV }
					}
				}			
			}
			character_event = { id = dragon.42 }
		}	
	}
	option = {
		name = "not_now_dracarys"
		ai_chance = {
			factor = 25
			modifier = { 
				factor = 4
				trait = honorable
			}
			modifier = { 
				factor = 3
				trait = patient
			}
			modifier = { 
				factor = 3
				trait = kind
			}
			modifier = { 
				factor = 3
				trait = content
			}
		}
		if = {
			limit = { ai = no }
			clr_character_flag = dragon_used
		}	
		hidden_tooltip = { event_target:siege_of_fire_target = { clear_event_target = siege_of_fire_target clr_character_flag = siege_leader } }
	}	
}
#Many courtiers fried
# character_event = {
	# id = dragon.39
	# desc = "EVTDESCdragon.39"
	# picture = "GFX_siegeoffire"
	# border = "GFX_event_normal_frame_war"
	
	# is_triggered_only = yes
	
	# immediate = {
		# random = {
			# chance = 25
			# set_character_flag = no_effect
		# }
		# if = {
			# limit = {
				# NOT = { has_character_flag = no_effect }
			# }
			# random = {
				# chance = 33
				# set_character_flag = wounded_dragon
			# }
		# }	
		# if = {
			# limit = {
				# NOT = { has_character_flag = no_effect }
				# NOT = { has_character_flag = wounded_dragon }
			# }
			# random = {
				# chance = 50
				# set_character_flag = maimed
			# }
		# }	
		# if = {
			# limit = {
				# NOT = { has_character_flag = no_effect }
				# NOT = { has_character_flag = wounded_dragon }
				# NOT = { has_character_flag = maimed }
			# }
			# set_character_flag = death
		# }
	# }
	
	# option = {
		# name = "EVTOPTAdragon.39"
		# if = {
			# limit = {
				# has_character_flag = wounded_dragon 
			# }
			# add_trait = wounded_dragon
			# clr_character_flag = wounded_dragon 
		# }
		# if = {
			# limit = {
				# has_character_flag = maimed
			# }
			# add_trait = maimed_dragon
			# clr_character_flag = maimed
		# }			
		# if = {
			# limit = {
				# has_character_flag = death
			# }
			# clr_character_flag = death
			# if = {
				# limit = {
					# OR = {
						# demesne_size = 1
						# in_command = yes
						# liege = { 
							# dynasty = ROOT
							# is_close_relative = ROOT		
						# }
					# }
				# }
				# hidden_tooltip = { FROM = { character_event = { id = dragon.37 } } }
			# }
			# death = {
				# death_reason = death_battle
				# killer = FROM
			# }
			# recalc_succession = yes
		# }	
	# }
# }
#Castle decimated
character_event = {
	id = dragon.40
	desc = "EVTDESCdragon.40"
	picture = "GFX_siegeoffire"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = { ai = no }
			FROM = {
				random_friend = {
					limit = { trait = dragon }
					save_event_target_as = riders_dragon #for localisation
				}
			}
			chronicle = {
				entry = CHRONICLE_SIEGE_OF_FIRE_VICTIM
				portrait = [From.GetID]
				picture = GFX_siegeoffire
			}
		}
		hidden_tooltip = {
			if = {
				limit = { 
					NOT = { trait = in_hiding } 
					at_location = FROM
					# OR = {
						# in_command = no
						# has_character_flag = siege_leader
					# }
				}
				set_character_flag = death
				mother = {
					if = {
						limit = { NOT = { is_close_relative = FROM } }
						opinion = {
							modifier = opinion_burned_closed_relative
							who = FROM
							years = 25
						}
					}	
				}
				father = {
					if = {
						limit = { NOT = { is_close_relative = FROM } }
						opinion = {
							modifier = opinion_burned_closed_relative
							who = FROM
							years = 25
						}
					}	
				}
				any_child = {
					limit = {
						NOT = { is_close_relative = FROM }
						NOT = {
							has_opinion_modifier = {
								who = FROM
								modifier = opinion_burned_closed_relative
							}						
						}
					}
					opinion = {
						modifier = opinion_burned_closed_relative
						who = FROM
						years = 25
					}
				}
				any_sibling = {
					limit = {
						NOT = { is_close_relative = FROM }
						NOT = {
							has_opinion_modifier = {
								who = FROM
								modifier = opinion_burned_closed_relative
							}						
						}
					}
					opinion = {
						modifier = opinion_burned_closed_relative
						who = FROM
						years = 25
					}
				}
				spouse = {
					if = {
						limit = {
							NOT = {
								has_opinion_modifier = {
									who = FROM
									modifier = opinion_burned_closed_relative
								}						
							}
						}
						opinion = {
							modifier = opinion_burned_closed_relative
							who = FROM
							years = 25
						}				
					}
				}
				any_dynasty_member = {
					limit = {
						is_close_relative = ROOT
						NOT = { is_close_relative = FROM }
						NOT = {
							has_opinion_modifier = {
								who = FROM
								modifier = opinion_burned_closed_relative
							}						
						}
					}
					opinion = {
						modifier = opinion_burned_closed_relative
						who = FROM
						years = 25
					}				
				}
			}	
		}
	}
	
	option = {
		name = "EVTOPTAdragon.40"
		hidden_tooltip = {
			FROM = { 
				if = {
					limit = { ai = no }
					character_event = { id = dragon.41 } 
				}	
			}
			location = {
				owner = {
					any_courtier = {
						limit = {
							NOT = { character = ROOT }
							NOT = { character = FROM }
							NOT = { in_command = yes }
							at_location = FROM
							NOT = { trait = in_hiding }
							NOT = { educator = { character = FROM } }
						}
						character_event = { id = dragon.4010 }
					}
				}
			}	
			recalc_succession = yes
		}
		tooltip = {
			if = {
				limit = { 
					NOT = { trait = in_hiding } 
					at_location = FROM
					# OR = {
						# in_command = no
						# has_character_flag = siege_leader
					# }
				}
				death = {
					death_reason = death_battle
					killer = FROM
				}
				FROM = { 
					random_friend = {
						limit = { trait = dragon age = 2 }
						tooltip = { }
					}
				}
			}	
		}
		hidden_tooltip = {
			if = {
				limit = { has_character_flag = death }
				FROM_murder_red_god_resurrect_effect = yes #check for rhllor resurrection
				death = {
					death_reason = death_battle
					killer = FROM
				}
			}
		}	
	}
}
#Inform i was fried in castle
character_event = {
	id = dragon.4010
	desc = "EVTDESCdragon.4010"
	picture = "GFX_siegeoffire"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_SIEGE_OF_FIRE_VICTIM_COURTIER
				portrait = [FromFrom.GetID]
				picture = GFX_siegeoffire
			}
		}
		hidden_tooltip = {
			mother = {
				if = {
					limit = { NOT = { is_close_relative = FROMFROM } }
					opinion = {
						modifier = opinion_burned_closed_relative
						who = FROMFROM
						years = 25
					}
				}
			}
			father = {
				if = {
					limit = { NOT = { is_close_relative = FROMFROM } }
					opinion = {
						modifier = opinion_burned_closed_relative
						who = FROMFROM
						years = 25
					}
				}
			}
			any_child = {
				limit = {
					NOT = { is_close_relative = FROMFROM }
					NOT = {
						has_opinion_modifier = {
							who = FROMFROM
							modifier = opinion_burned_closed_relative
						}						
					}
				}
				opinion = {
					modifier = opinion_burned_closed_relative
					who = FROMFROM
					years = 25
				}
			}
			any_sibling = {
				limit = {
					NOT = { is_close_relative = FROMFROM }
					NOT = {
						has_opinion_modifier = {
							who = FROMFROM
							modifier = opinion_burned_closed_relative
						}						
					}
				}
				opinion = {
					modifier = opinion_burned_closed_relative
					who = FROMFROM
					years = 25
				}
			}
			spouse = {
				if = {
					limit = {
						NOT = { is_close_relative = FROMFROM }
						NOT = {
							has_opinion_modifier = {
								who = FROMFROM
								modifier = opinion_burned_closed_relative
							}						
						}
					}
					opinion = {
						modifier = opinion_burned_closed_relative
						who = FROMFROM
						years = 25
					}				
				}
			}
			any_dynasty_member = {
				limit = {
					is_close_relative = ROOT
					NOT = { is_close_relative = FROMFROM }
					NOT = {
						has_opinion_modifier = {
							who = FROMFROM
							modifier = opinion_burned_closed_relative
						}						
					}
				}
				opinion = {
					modifier = opinion_burned_closed_relative
					who = FROMFROM
					years = 25
				}				
			}
		}
	}
	
	option = {
		name = "EVTOPTAdragon.40"
		red_god_resurrect_effect = yes #check for rhllor resurrection
		death = {
			death_reason = death_battle
			killer = FROMFROM
		}
		FROM = { 
			FROM = { 
				random_friend = {
					limit = { trait = dragon age = 2 }
					tooltip = { }
				}
			}
		}	
	}
}
#Inform castle decimated
character_event = {
	id = dragon.41
	desc = "EVTDESCdragon.41"
	picture = "GFX_siegeoffire"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.41"
		random_friend = {
			limit = { trait = dragon }
			save_event_target_as = riders_dragon #for localisation
		}
		chronicle = {
			entry = CHRONICLE_SIEGE_OF_FIRE
			portrait = [From.GetID]
			picture = GFX_siegeoffire
		}
	}
}
#Siege of fire dragon duel
character_event = {
	id = dragon.42
	desc = "EVTDESCdragon.42"
	picture = "GFX_fallofharrenhal"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	#stand
	option = {
		name = "EVTOPTAdragon.42"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 2
				OR = {
					trait = brave
					trait = wroth
					trait = lunatic
				}
			}			
		}	
		set_global_flag = dragonduel1
		set_character_flag = dragonduel	
		set_character_flag = dragonduel_siege	
		set_character_flag = dragonduel_team_leader_a
		clr_character_flag = dragonduel_team_leader_b	
		FROM = {	
			hidden_tooltip = {
				clr_character_flag = dragonduel_team_leader_a
				set_character_flag = dragonduel_team_leader_b
				set_variable = { which = "dragon_strength" value = 0 }
				if = {
					limit = {
						any_friend = { trait = dragon martial = 10 }			
					}
					change_variable = { which = "dragon_strength" value = 11 }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 20 }			
					}
					change_variable = { which = "dragon_strength" value = 10 }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 30 }			
					}
					change_variable = { which = "dragon_strength" value = 10 }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 40 }			
					}
					change_variable = { which = "dragon_strength" value = 10 }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 50 }			
					}
					change_variable = { which = "dragon_strength" value = 10 }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 60 }			
					}
					change_variable = { which = "dragon_strength" value = 10 }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 70 }			
					}
					change_variable = { which = "dragon_strength" value = 10 }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 80 }			
					}
					change_variable = { which = "dragon_strength" value = 10 }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 90 }			
					}
					change_variable = { which = "dragon_strength" value = 10 }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 100 }			
					}
					change_variable = { which = "dragon_strength" value = 10 }
				}
				# Skill-at-Arms Effects
				if = {
					limit = { trait = poor_warrior }
					change_variable = { which = "dragon_strength" value = 1 }
				}
				if = {
					limit = { trait = trained_warrior }
					change_variable = { which = "dragon_strength" value = 2 }
				}
				if = {
					limit = { trait = skilled_warrior }
					change_variable = { which = "dragon_strength" value = 4 }
				}
				if = {
					limit = { trait = master_warrior }
					change_variable = { which = "dragon_strength" value = 8 }
				}
				
				# Personality Effects
				if = {
					limit = { trait = brave }
					change_variable = { which = "dragon_strength" value = 3 }
				}
				if = {
					limit = { trait = wroth }
					change_variable = { which = "dragon_strength" value = 2 }
				}
				if = {
					limit = { trait = craven }
					change_variable = { which = "dragon_strength" value = -3 }
				}
				# Physical Strength Effects
				if = {
					limit = { trait = strong }
					change_variable = { which = "dragon_strength" value = 3 }
				}
				if = {
					limit = { trait = weak }
					change_variable = { which = "dragon_strength" value = -3 }
				}		
				# Cunning/Intelligence Effects
				if = {
					limit = { trait = genius }
					change_variable = { which = "dragon_strength" value = 6 }
				}
				if = {
					limit = { trait = quick }
					change_variable = { which = "dragon_strength" value = 3 }
				}
				if = {
					limit = { trait = imbecile }
					change_variable = { which = "dragon_strength" value = -3 }
				}
				if = {
					limit = { trait = slow }
					change_variable = { which = "dragon_strength" value = -3 }
				}
				# Wound Effects
				if = {
					limit = { trait = wounded }
					change_variable = { which = "dragon_strength" value = -3 }
				}
				if = {
					limit = { trait = maimed }
					change_variable = { which = "dragon_strength" value = -6 }
				}
				# Health Effects
				if = {
					limit = { is_ill = yes }
					change_variable = { which = "dragon_strength" value = -3 }
				}
			}	
			set_character_flag = dragonduel		
			tooltip = { }	
			hidden_tooltip = { 
				character_event = { id = dragon.44 days = 1 }  #say hello to my dragon	
				opinion = { who = ROOT modifier = opinion_dragon_duel }
				reverse_opinion = { who = ROOT modifier = opinion_dragon_duel }
			} 
			random_friend = {
				limit = {
					trait = dragon
					is_alive = yes
					age = 2
				}	
				custom_tooltip = { text = TOOLTIPdragon.43ENEMY }
			}
			top_liege = {
				any_realm_character = {
					limit = {
						trait = dragon_rider
						at_location = ROOT
						in_command = yes
						NOT = { character = PREVPREV }
						OR = {
							war_with = ROOT
							ROOT = { any_liege = { war_with = PREVPREV } }
							any_liege = { 
								OR = {
									war_with = ROOT 
									ROOT = { any_liege = { war_with = PREVPREV } }
								}	
							}
						}
						NOT = {
							OR = {
								is_liege_or_above = ROOT
								ROOT = { is_liege_or_above = PREV }
							}
						}
					}
					set_character_flag = dragonduel		
					tooltip = { }	
					hidden_tooltip = { 
						character_event = { id = dragon.44 }  #say hello to my dragon	
						opinion = { who = ROOT modifier = opinion_dragon_duel }
						reverse_opinion = { who = ROOT modifier = opinion_dragon_duel }
					} 			
					random_friend = {
						limit = {
							trait = dragon
							is_alive = yes
							age = 2
						}	
						custom_tooltip = { text = TOOLTIPdragon.43ENEMY }
					}
				}
			}
		}	
		top_liege = {
			any_realm_character = { #allies
				limit = {
					trait = dragon_rider
					at_location = ROOT
					NOT = { character = ROOT }
					NOT = { trait = in_hiding }
					NOT = {
						OR = {
							war_with = ROOT
							ROOT = { any_liege = { war_with = PREVPREV } }
							any_liege = { 
								OR = {
									war_with = ROOT 
									ROOT = { any_liege = { war_with = PREVPREV } }
								}	
							}
						}
					}	
				}
				set_character_flag = dragonduel	
				set_character_flag = dragonduel_siege	
				tooltip = { }	
				hidden_tooltip = { character_event = { id = dragon.4498 } }			
				random_friend = {
					limit = {
						trait = dragon
						is_alive = yes
						age = 2
					}	
					custom_tooltip = { text = TOOLTIPdragon.43ALLY }
				}	
			}
		}	
		hidden_tooltip = { #Determine dragon team strength
			set_variable = { which = "dragon_strength" value = 0 }
			if = {
				limit = {
					any_friend = { trait = dragon martial = 10 }			
				}
				change_variable = { which = "dragon_strength" value = 11 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 20 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 30 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 40 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 50 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 60 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 70 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 80 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 90 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 100 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			# Skill-at-Arms Effects
			if = {
				limit = { trait = poor_warrior }
				change_variable = { which = "dragon_strength" value = 1 }
			}
			if = {
				limit = { trait = trained_warrior }
				change_variable = { which = "dragon_strength" value = 2 }
			}
			if = {
				limit = { trait = skilled_warrior }
				change_variable = { which = "dragon_strength" value = 4 }
			}
			if = {
				limit = { trait = master_warrior }
				change_variable = { which = "dragon_strength" value = 8 }
			}
			
			# Personality Effects
			if = {
				limit = { trait = brave }
				change_variable = { which = "dragon_strength" value = 3 }
			}
			if = {
				limit = { trait = wroth }
				change_variable = { which = "dragon_strength" value = 2 }
			}
			if = {
				limit = { trait = craven }
				change_variable = { which = "dragon_strength" value = -3 }
			}
			# Physical Strength Effects
			if = {
				limit = { trait = strong }
				change_variable = { which = "dragon_strength" value = 3 }
			}
			if = {
				limit = { trait = weak }
				change_variable = { which = "dragon_strength" value = -3 }
			}		
			# Cunning/Intelligence Effects
			if = {
				limit = { trait = genius }
				change_variable = { which = "dragon_strength" value = 6 }
			}
			if = {
				limit = { trait = quick }
				change_variable = { which = "dragon_strength" value = 3 }
			}
			if = {
				limit = { trait = imbecile }
				change_variable = { which = "dragon_strength" value = -3 }
			}
			if = {
				limit = { trait = slow }
				change_variable = { which = "dragon_strength" value = -3 }
			}
			# Wound Effects
			if = {
				limit = { trait = wounded }
				change_variable = { which = "dragon_strength" value = -3 }
			}
			if = {
				limit = { trait = maimed }
				change_variable = { which = "dragon_strength" value = -6 }
			}
			# Health Effects
			if = {
				limit = { is_ill = yes }
				change_variable = { which = "dragon_strength" value = -3 }
			}
		}		
	}
	#hide in castle
	option = {
		name = "EVTOPTBdragon.42"
		ai_chance = {
			factor = 1
			modifier = {
				factor = 2
				trait = craven
			}		
		}
		prestige = -20
		set_character_flag = stayed_castle_dd
		FROM = { clr_character_flag = dragon_used character_event = { id = dragon.56 } }
	}
}
###Dragon Duels###
#Dragon vs Dragon Clash
character_event = { 
	id = dragon.43
	border = "GFX_event_normal_frame_war"
	desc = "EVTDESCdragon.43" 
	title = "EVTNAMEdragon.43"
	picture = "GFX_fieldoffire"
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_global_flag = dragonduel1 }
		trait = dragon_rider
		in_command = yes		
		#fixes crash
		NOT = { at_sea = yes }
		NOT = { has_character_flag = battle_dragon }
		OR = {
			NOT = { has_character_flag = dragonduel }
			had_character_flag = { flag = dragonduel days = 15 }
		}
		dragon_rider = {
			at_location = ROOT
			in_command = yes
			OR = {
				NOT = { has_character_flag = dragonduel }
				had_character_flag = { flag = dragonduel days = 7 }
			}
			OR = {
				war_with = ROOT
				ROOT = { any_liege = { war_with = PREVPREV } }
				any_liege = { 
					OR = {
						war_with = ROOT 
						ROOT = { any_liege = { war_with = PREVPREV } }
					}	
				}
			}
			NOT = {
				OR = {
					is_liege_or_above = ROOT
					ROOT = { is_liege_or_above = PREV }
				}
			}			
		}	
	}
	
	immediate = {
		set_global_flag = dragonduel1
		set_character_flag = dragonduel	
		set_character_flag = dragonduel_team_leader_a
		clr_character_flag = dragonduel_team_leader_b
		hidden_tooltip = { #Determine dragon team strength
			set_variable = { which = "dragon_strength" value = 0 }
			if = {
				limit = {
					any_friend = { trait = dragon martial = 10 }			
				}
				change_variable = { which = "dragon_strength" value = 11 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 20 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 30 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 40 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 50 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 60 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 70 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 80 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 90 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 100 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			# Skill-at-Arms Effects
			if = {
				limit = { trait = poor_warrior }
				change_variable = { which = "dragon_strength" value = 1 }
			}
			if = {
				limit = { trait = trained_warrior }
				change_variable = { which = "dragon_strength" value = 2 }
			}
			if = {
				limit = { trait = skilled_warrior }
				change_variable = { which = "dragon_strength" value = 4 }
			}
			if = {
				limit = { trait = master_warrior }
				change_variable = { which = "dragon_strength" value = 8 }
			}
			
			# Personality Effects
			if = {
				limit = { trait = brave }
				change_variable = { which = "dragon_strength" value = 3 }
			}
			if = {
				limit = { trait = wroth }
				change_variable = { which = "dragon_strength" value = 2 }
			}
			if = {
				limit = { trait = craven }
				change_variable = { which = "dragon_strength" value = -3 }
			}
			# Physical Strength Effects
			if = {
				limit = { trait = strong }
				change_variable = { which = "dragon_strength" value = 3 }
			}
			if = {
				limit = { trait = weak }
				change_variable = { which = "dragon_strength" value = -3 }
			}		
			# Cunning/Intelligence Effects
			if = {
				limit = { trait = genius }
				change_variable = { which = "dragon_strength" value = 6 }
			}
			if = {
				limit = { trait = quick }
				change_variable = { which = "dragon_strength" value = 3 }
			}
			if = {
				limit = { trait = imbecile }
				change_variable = { which = "dragon_strength" value = -3 }
			}
			if = {
				limit = { trait = slow }
				change_variable = { which = "dragon_strength" value = -3 }
			}
			# Wound Effects
			if = {
				limit = { trait = wounded }
				change_variable = { which = "dragon_strength" value = -3 }
			}
			if = {
				limit = { trait = maimed }
				change_variable = { which = "dragon_strength" value = -6 }
			}
			# Health Effects
			if = {
				limit = { is_ill = yes }
				change_variable = { which = "dragon_strength" value = -3 }
			}
		}
		dragon_rider = { #Choose enemy team leader
			limit = {
				at_location = ROOT
				in_command = yes
				OR = {
					NOT = { has_character_flag = dragonduel }
					had_character_flag = { flag = dragonduel days = 7 }
				}
				OR = {
					war_with = ROOT
					ROOT = { any_liege = { war_with = PREVPREV } }
					any_liege = { 
						OR = {
							war_with = ROOT 
							ROOT = { any_liege = { war_with = PREVPREV } }
						}	
					}
				}
				NOT = {
					OR = {
						is_liege_or_above = ROOT
						ROOT = { is_liege_or_above = PREV }
					}
				}
			}	
			clr_character_flag = dragonduel_team_leader_a
			set_character_flag = dragonduel_team_leader_b
			set_variable = { which = "dragon_strength" value = 0 }
			if = {
				limit = {
					any_friend = { trait = dragon martial = 10 }			
				}
				change_variable = { which = "dragon_strength" value = 11 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 20 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 30 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 40 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 50 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 60 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 70 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 80 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 90 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 100 }			
				}
				change_variable = { which = "dragon_strength" value = 10 }
			}
			# Skill-at-Arms Effects
			if = {
				limit = { trait = poor_warrior }
				change_variable = { which = "dragon_strength" value = 1 }
			}
			if = {
				limit = { trait = trained_warrior }
				change_variable = { which = "dragon_strength" value = 2 }
			}
			if = {
				limit = { trait = skilled_warrior }
				change_variable = { which = "dragon_strength" value = 4 }
			}
			if = {
				limit = { trait = master_warrior }
				change_variable = { which = "dragon_strength" value = 8 }
			}
			
			# Personality Effects
			if = {
				limit = { trait = brave }
				change_variable = { which = "dragon_strength" value = 3 }
			}
			if = {
				limit = { trait = wroth }
				change_variable = { which = "dragon_strength" value = 2 }
			}
			if = {
				limit = { trait = craven }
				change_variable = { which = "dragon_strength" value = -3 }
			}
			# Physical Strength Effects
			if = {
				limit = { trait = strong }
				change_variable = { which = "dragon_strength" value = 3 }
			}
			if = {
				limit = { trait = weak }
				change_variable = { which = "dragon_strength" value = -3 }
			}		
			# Cunning/Intelligence Effects
			if = {
				limit = { trait = genius }
				change_variable = { which = "dragon_strength" value = 6 }
			}
			if = {
				limit = { trait = quick }
				change_variable = { which = "dragon_strength" value = 3 }
			}
			if = {
				limit = { trait = imbecile }
				change_variable = { which = "dragon_strength" value = -3 }
			}
			if = {
				limit = { trait = slow }
				change_variable = { which = "dragon_strength" value = -3 }
			}
			# Wound Effects
			if = {
				limit = { trait = wounded }
				change_variable = { which = "dragon_strength" value = -3 }
			}
			if = {
				limit = { trait = maimed }
				change_variable = { which = "dragon_strength" value = -6 }
			}
			# Health Effects
			if = {
				limit = { is_ill = yes }
				change_variable = { which = "dragon_strength" value = -3 }
			}
		}
	}

	option = {
		name = "EVTOPTAdragon.43"
		dragon_rider = { #enemies
			limit = {
				in_command = yes
				at_location = ROOT
				has_character_flag = dragonduel_team_leader_b
				OR = {
					NOT = { has_character_flag = dragonduel }
					had_character_flag = { flag = dragonduel days = 7 }
				}
				OR = {
					war_with = ROOT
					ROOT = { any_liege = { war_with = PREVPREV } }
					any_liege = { 
						OR = {
							war_with = ROOT 
							ROOT = { any_liege = { war_with = PREVPREV } }
						}	
					}
				}
				NOT = {
					OR = {
						is_liege_or_above = ROOT
						ROOT = { is_liege_or_above = PREV }
					}
				}
			}
			set_character_flag = dragonduel		
			tooltip = { }	
			hidden_tooltip = { 
				character_event = { id = dragon.44 }  #say hello to my dragon	
				opinion = { who = ROOT modifier = opinion_dragon_duel }
				reverse_opinion = { who = ROOT modifier = opinion_dragon_duel }
			} 			
			random_friend = {
				limit = {
					trait = dragon
					is_alive = yes
					age = 2
				}	
				custom_tooltip = { text = TOOLTIPdragon.43ENEMY }
			}
			top_liege = {
				any_realm_character = {
					limit = {
						trait = dragon_rider
						in_command = yes
						at_location = ROOT
						NOT = { character = PREVPREV }
						OR = {
							NOT = { has_character_flag = dragonduel }
							had_character_flag = { flag = dragonduel days = 7 }
						}
						OR = {
							war_with = ROOT
							ROOT = { any_liege = { war_with = PREVPREV } }
							any_liege = { 
								OR = {
									war_with = ROOT 
									ROOT = { any_liege = { war_with = PREVPREV } }
								}	
							}
						}
						NOT = {
							OR = {
								is_liege_or_above = ROOT
								ROOT = { is_liege_or_above = PREV }
							}
						}
					}
					set_character_flag = dragonduel		
					tooltip = { }	
					hidden_tooltip = { 
						character_event = { id = dragon.44 }  #say hello to my dragon	
						opinion = { who = ROOT modifier = opinion_dragon_duel }
						reverse_opinion = { who = ROOT modifier = opinion_dragon_duel }
					} 			
					random_friend = {
						limit = {
							trait = dragon
							is_alive = yes
							age = 2
						}	
						custom_tooltip = { text = TOOLTIPdragon.43ENEMY }
					}
				}
			}	
		}
		top_liege = {
			any_realm_character = { #allies
				limit = {
					trait = dragon_rider
					in_command = yes
					at_location = ROOT
					OR = {
						NOT = { has_character_flag = dragonduel }
						had_character_flag = { flag = dragonduel days = 7 }
					}
					NOT = { character = ROOT }
					NOT = {
						OR = {
							war_with = ROOT
							ROOT = { any_liege = { war_with = PREVPREV } }
							any_liege = { 
								OR = {
									war_with = ROOT 
									ROOT = { any_liege = { war_with = PREVPREV } }
								}	
							}
						}
					}	
				}
				set_character_flag = dragonduel				
				tooltip = { }	
				hidden_tooltip = { character_event = { id = dragon.4498 } }			
				random_friend = {
					limit = {
						trait = dragon
						is_alive = yes
						age = 2
					}	
					custom_tooltip = { text = TOOLTIPdragon.43ALLY }
				}	
			}
		}		
	}
	#no target
	# option = {
		# name = "EVTOPTBdragon.43"			
		# ai_chance = {
			# factor = 1
			# modifier = {
				# factor = 2
				# trait = craven
			# }
			# modifier = {
				# factor = 2
				# NOT = { trait = poor_warrior_dragon }
				# NOT = { trait = trained_warrior_dragon } 
				# NOT = { trait = skilled_warrior_dragon } 
				# NOT = { trait = master_warrior_dragon }
			# }		 
		# }
		# clr_global_flag = dragonduel1
		# clr_character_flag = dragonduel_team_leader_a
		# hidden_tooltip = { set_variable = { which = "dragon_strength" value = 0 } }
		# dragon_rider = {
			# limit = {
				# has_character_flag = dragonduel_team_leader_b
			# }
			# clr_character_flag = dragonduel_team_leader_b
			# hidden_tooltip = { set_variable = { which = "dragon_strength" value = 0 } }
		# }
	# }
}
# Scope to Allied dragon rider
character_event = { 
	id = dragon.4498
	border = "GFX_event_normal_frame_war"
	desc = "EVTDESCdragon.4498" 
	title = "EVTNAMEdragon.43"
	picture = "GFX_fieldoffire"
	
	is_triggered_only = yes
	
	immediate = {
		hidden_tooltip = { #Determine dragon team strength
			if = {
				limit = {
					any_friend = { trait = dragon martial = 10 }			
				}
				FROM = { change_variable = { which = "dragon_strength" value = 11 } }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 20 }			
				}
				FROM = { change_variable = { which = "dragon_strength" value = 11 } }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 30 }			
				}
				FROM = { change_variable = { which = "dragon_strength" value = 11 } }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 40 }			
				}
				FROM = { change_variable = { which = "dragon_strength" value = 11 } }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 50 }			
				}
				FROM = { change_variable = { which = "dragon_strength" value = 11 } }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 60 }			
				}
				FROM = { change_variable = { which = "dragon_strength" value = 11 } }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 70 }			
				}
				FROM = { change_variable = { which = "dragon_strength" value = 11 } }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 80 }			
				}
				FROM = { change_variable = { which = "dragon_strength" value = 11 } }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 90 }			
				}
				FROM = { change_variable = { which = "dragon_strength" value = 11 } }
			}
			if = {
				limit = {
					any_friend = { trait = dragon martial = 100 }			
				}
				FROM = { change_variable = { which = "dragon_strength" value = 11 } }
			}
			# Skill-at-Arms Effects
			if = {
				limit = { trait = poor_warrior }
				FROM = { change_variable = { which = "dragon_strength" value = 1 } }
			}
			if = {
				limit = { trait = trained_warrior }
				FROM = { change_variable = { which = "dragon_strength" value = 2 } }
			}
			if = {
				limit = { trait = skilled_warrior }
				FROM = { change_variable = { which = "dragon_strength" value = 4 } }
			}
			if = {
				limit = { trait = master_warrior }
				FROM = { change_variable = { which = "dragon_strength" value = 8 } }
			}
			
			# Personality Effects
			if = {
				limit = { trait = brave }
				FROM = { change_variable = { which = "dragon_strength" value = 3 } }
			}
			if = {
				limit = { trait = wroth }
				FROM = { change_variable = { which = "dragon_strength" value = 2 } }
			}
			if = {
				limit = { trait = craven }
				FROM = { change_variable = { which = "dragon_strength" value = -3 } }
			}
			# Physical Strength Effects
			if = {
				limit = { trait = strong }
				FROM = { change_variable = { which = "dragon_strength" value = 3 } }
			}
			if = {
				limit = { trait = weak }
				FROM = { change_variable = { which = "dragon_strength" value = -3 } }
			}		
			# Cunning/Intelligence Effects
			if = {
				limit = { trait = genius }
				FROM = { change_variable = { which = "dragon_strength" value = 6 } }
			}
			if = {
				limit = { trait = quick }
				FROM = { change_variable = { which = "dragon_strength" value = 3 } }
			}
			if = {
				limit = { trait = imbecile }
				FROM = { change_variable = { which = "dragon_strength" value = -3 } }
			}
			if = {
				limit = { trait = slow }
				FROM = { change_variable = { which = "dragon_strength" value = -3 } }
			}
			# Wound Effects
			if = {
				limit = { trait = wounded }
				FROM = { change_variable = { which = "dragon_strength" value = -3 } }
			}
			if = {
				limit = { trait = maimed }
				FROM = { change_variable = { which = "dragon_strength" value = -6 } }
			}
			# Health Effects
			if = {
				limit = { is_ill = yes }
				FROM = { change_variable = { which = "dragon_strength" value = -3 } }
			}
		}	
	}
	
	option = {
		name = EVTOPTAdragon.4498
		dragon_rider = { #enemies
			limit = {
				OR = {
					has_character_flag = dragonduel_siege	
					in_command = yes
				}	
				at_location = ROOT
				OR = {
					war_with = ROOT
					ROOT = { any_liege = { war_with = PREVPREV } }
					any_liege = { 
						OR = {
							war_with = ROOT 
							ROOT = { any_liege = { war_with = PREVPREV } }
						}	
					}
				}
				NOT = {
					OR = {
						is_liege_or_above = ROOT
						ROOT = { is_liege_or_above = PREV }
					}
				}
			}
			top_liege = {
				any_realm_character = {
					limit = {
						trait = dragon_rider
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						at_location = ROOT
						OR = {
							war_with = ROOT
							ROOT = { any_liege = { war_with = PREVPREV } }
							any_liege = { 
								OR = {
									war_with = ROOT 
									ROOT = { any_liege = { war_with = PREVPREV } }
								}	
							}
						}
						NOT = {
							OR = {
								is_liege_or_above = ROOT
								ROOT = { is_liege_or_above = PREV }
							}
						}
					}
					tooltip = { }	
					hidden_tooltip = {
						opinion = { who = ROOT modifier = opinion_dragon_duel }
						reverse_opinion = { who = ROOT modifier = opinion_dragon_duel }	
					}	
					random_friend = {
						limit = {
							trait = dragon
							is_alive = yes
							age = 2
						}	
						custom_tooltip = { text = TOOLTIPdragon.43ENEMY }
					}
				}
			}	
		}
		if = {
			limit = { ai = no }
			top_liege = {
				any_realm_character = { #allies
					limit = {
						trait = dragon_rider
						in_command = yes
						at_location = ROOT
						NOT = { character = ROOT }
						NOT = {
							OR = {
								war_with = ROOT
								ROOT = { any_liege = { war_with = PREVPREV } }
								any_liege = { 
									OR = {
										war_with = ROOT 
										ROOT = { any_liege = { war_with = PREVPREV } }
									}	
								}
							}
						}	
					}
					tooltip = { }			
					random_friend = {
						limit = {
							trait = dragon
							is_alive = yes
							age = 2
						}	
						custom_tooltip = { text = TOOLTIPdragon.43ALLY }
					}	
				}
			}
		}	
	}	
}	
# Dragon vs Dragon Step 2 
character_event = { 
	id = dragon.44
	border = "GFX_event_normal_frame_war"
	desc = "EVTDESCdragon.44" 
	title = "EVTNAMEdragon.43"
	picture = "GFX_fieldoffire"

	is_triggered_only = yes
	
	trigger = {
		has_character_flag = dragonduel
	}

	#stand
	option = {
		name = "EVTOPTAdragon.44"
		if = {
			limit = { ai = no }
			dragon_rider = { #enemies
				limit = {
					OR = {
						in_command = yes
						has_character_flag = dragonduel_siege
					}	
					at_location = ROOT
					OR = {
						war_with = ROOT
						ROOT = { any_liege = { war_with = PREVPREV } }
						any_liege = { 
							OR = {
								war_with = ROOT 
								ROOT = { any_liege = { war_with = PREVPREV } }
							}	
						}
					}
					NOT = {
						OR = {
							is_liege_or_above = ROOT
							ROOT = { is_liege_or_above = PREV }
						}
					}
				}
				top_liege = {
					any_realm_character = {
						limit = {
							trait = dragon_rider
							OR = {
								in_command = yes
								has_character_flag = dragonduel_siege
							}	
							at_location = ROOT
							OR = {
								war_with = ROOT
								ROOT = { any_liege = { war_with = PREVPREV } }
								any_liege = { 
									OR = {
										war_with = ROOT 
										ROOT = { any_liege = { war_with = PREVPREV } }
									}	
								}
							}
							NOT = {
								OR = {
									is_liege_or_above = ROOT
									ROOT = { is_liege_or_above = PREV }
								}
							}
						}
						tooltip = { }			
						random_friend = {
							limit = {
								trait = dragon
								is_alive = yes
								age = 2
							}	
							custom_tooltip = { text = TOOLTIPdragon.43ENEMY }
						}
					}
				}	
			}
		}
		if = {
			limit = {
				OR = {
					ai = no
					has_character_flag = dragonduel_team_leader_b
				}
			}
			top_liege = {
				any_realm_character = { #allies
					limit = {
						trait = dragon_rider
						in_command = yes
						at_location = ROOT
						NOT = { character = ROOT }
						NOT = {
							OR = {
								war_with = ROOT
								ROOT = { any_liege = { war_with = PREVPREV } }
								any_liege = { 
									OR = {
										war_with = ROOT 
										ROOT = { any_liege = { war_with = PREVPREV } }
									}	
								}
							}
						}	
					}	
					tooltip = { }			
					random_friend = {
						limit = {
							trait = dragon
							is_alive = yes
							age = 2
						}	
						custom_tooltip = { text = TOOLTIPdragon.43ALLY }
					}	
					if = {
						limit = { ROOT = { has_character_flag = dragonduel_team_leader_b } }
						hidden_tooltip = { #Determine dragon team strength
							if = {
								limit = {
									any_friend = { trait = dragon martial = 10 }			
								}
								ROOT = { change_variable = { which = "dragon_strength" value = 11 } }
							}
							if = {
								limit = {
									any_friend = { trait = dragon martial = 20 }			
								}
								ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
							}
							if = {
								limit = {
									any_friend = { trait = dragon martial = 30 }			
								}
								ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
							}
							if = {
								limit = {
									any_friend = { trait = dragon martial = 40 }			
								}
								ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
							}
							if = {
								limit = {
									any_friend = { trait = dragon martial = 50 }			
								}
								ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
							}
							if = {
								limit = {
									any_friend = { trait = dragon martial = 60 }			
								}
								ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
							}
							if = {
								limit = {
									any_friend = { trait = dragon martial = 70 }			
								}
								ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
							}
							if = {
								limit = {
									any_friend = { trait = dragon martial = 80 }			
								}
								ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
							}
							if = {
								limit = {
									any_friend = { trait = dragon martial = 90 }			
								}
								ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
							}
							if = {
								limit = {
									any_friend = { trait = dragon martial = 100 }			
								}
								ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
							}
							# Skill-at-Arms Effects
							if = {
								limit = { trait = poor_warrior }
								ROOT = { change_variable = { which = "dragon_strength" value = 1 } }
							}
							if = {
								limit = { trait = trained_warrior }
								ROOT = { change_variable = { which = "dragon_strength" value = 2 } }
							}
							if = {
								limit = { trait = skilled_warrior }
								ROOT = { change_variable = { which = "dragon_strength" value = 4 } }
							}
							if = {
								limit = { trait = master_warrior }
								ROOT = { change_variable = { which = "dragon_strength" value = 8 } }
							}					
							# Personality Effects
							if = {
								limit = { trait = brave }
								ROOT = { change_variable = { which = "dragon_strength" value = 3 } }
							}
							if = {
								limit = { trait = wroth }
								ROOT = { change_variable = { which = "dragon_strength" value = 2 } }
							}
							if = {
								limit = { trait = craven }
								ROOT = { change_variable = { which = "dragon_strength" value = -3 } }
							}
							# Physical Strength Effects
							if = {
								limit = { trait = strong }
								ROOT = { change_variable = { which = "dragon_strength" value = 3 } }
							}
							if = {
								limit = { trait = weak }
								ROOT = { change_variable = { which = "dragon_strength" value = -3 } }
							}		
							# Cunning/Intelligence Effects
							if = {
								limit = { trait = genius }
								ROOT = { change_variable = { which = "dragon_strength" value = 6 } }
							}
							if = {
								limit = { trait = quick }
								ROOT = { change_variable = { which = "dragon_strength" value = 3 } }
							}
							if = {
								limit = { trait = imbecile }
								ROOT = { change_variable = { which = "dragon_strength" value = -3 } }
							}
							if = {
								limit = { trait = slow }
								ROOT = { change_variable = { which = "dragon_strength" value = -3 } }
							}
							# Wound Effects
							if = {
								limit = { trait = wounded }
								ROOT = { change_variable = { which = "dragon_strength" value = -3 } }
							}
							if = {
								limit = { trait = maimed }
								ROOT = { change_variable = { which = "dragon_strength" value = -6 } }
							}
							# Health Effects
							if = {
								limit = { is_ill = yes }
								ROOT = { change_variable = { which = "dragon_strength" value = -3 } }
							}
						}
					}	
				}
			}	
		}	
		# ai_chance = {
			# factor = 2
			# modifier = {
				# factor = 2
				# OR = {
					# trait = brave
					# trait = wroth
					# trait = lunatic
				# }
			# }
			# modifier = {
				# factor = 2
				# trait = poor_warrior_dragon
			# }
			# modifier = {
				# factor = 3
				# trait = trained_warrior_dragon
			# }
			# modifier = {
				# factor = 4
				# trait = skilled_warrior_dragon
			# }
			# modifier = {
				# factor = 5
				# trait = master_warrior_dragon
			# }
			# modifier = {
				# factor = 2
				# FROM = {
					# NOT = { trait = poor_warrior_dragon }
					# NOT = { trait = trained_warrior_dragon } 
					# NOT = { trait = skilled_warrior_dragon } 
					# NOT = { trait = master_warrior_dragon }
				# }
			# }
				
		# }
		#any_playable_ruler  = {
		#	limit = { 
		#		ai = no
		#	}	
		#	character_event = { id = 3370110 }
		#}
		if = {
			limit = { has_character_flag = dragonduel_team_leader_b } #Team leader initiates first round
			hidden_tooltip = { c_the_citadel = { holder_scope = { character_event = { id = dragon.4597 days = 1 } } } }
		}	
	}
	# #run
	# option = {
		# name = "EVTOPTBdragon.44"
		# trigger = {
			# NOT = {
				# siege = {
					# is_attacker = no
				# }
			# }
		# }
		# ai_chance = {
			# factor = 1
			# modifier = {
				# factor = 2
				# trait = craven
			# }
			# modifier = {
				# factor = 2
				# NOT = { trait = poor_warrior_dragon }
				# NOT = { trait = trained_warrior_dragon } 
				# NOT = { trait = skilled_warrior_dragon } 
				# NOT = { trait = master_warrior_dragon }
			# }
			 
		# }
		# random_list = {
			# #escaped
			# 50 = {
				# prestige = -50
				# FROM = { set_character_flag = dragon_duel_resolved character_event = { id = dragon.53 } }
				# set_character_flag = dragon_duel_resolved
				# character_event = { id = dragon.57 }
				# #clean relations
				# hidden_tooltip = {
					# FROM = { remove_opinion = { who = ROOT modifier = rel_dragon} }
					# remove_opinion = { who = FROM modifier = rel_dragon}
				# }
			# }
			# #dontescape
			# 50 = {
				# #any_playable_ruler  = {
				# #	limit = { 
				# #		ai = no
				# #	}
				# #	character_event = { id = 3370110 }
				# #}
				# set_character_flag = tried_escape_dd
				# FROM = { set_character_flag = dragon_duel_resolved character_event = { id = dragon.54 } }
				# set_character_flag = dragon_duel_resolved
				# character_event = { id = dragon.55 }
				# hidden_tooltip = { c_the_citadel = { holder_scope = { character_event = { id = dragon.45 days = 1} } } }
				# prestige = 50
			# }
		# }
		
	# }
	# #hide in castle
	# option = {
	# name = "EVTOPTCdragon.44"
		# trigger = {
			# siege = {
				# is_attacker = no
			# }
		# }
		# ai_chance = {
			# factor = 2
			# modifier = {
				# factor = 2
				# trait = craven
			# }
			# modifier = {
				# factor = 2
				# NOT = { trait = poor_warrior_dragon }
				# NOT = { trait = trained_warrior_dragon } 
				# NOT = { trait = skilled_warrior_dragon } 
				# NOT = { trait = master_warrior_dragon }
			# }
			
		# }
		# prestige = -20
		# FROM = { set_character_flag = dragon_duel_resolved character_event = { id = dragon.56 } }
	# }	
}
# ROUND START
# scope to team leaders from previous round
character_event = {
	id = dragon.4595
	is_triggered_only = yes
	hide_window = yes
		
	immediate = {
		set_character_flag = dragon.4595
		set_variable = { which = "dragon_strength" value = 0 }
		if = {
			limit = {
				any_friend = { trait = dragon martial = 10 }			
			}
			change_variable = { which = "dragon_strength" value = 11 }
		}
		if = {
			limit = {
				any_friend = { trait = dragon martial = 20 }			
			}
			change_variable = { which = "dragon_strength" value = 10 }
		}
		if = {
			limit = {
				any_friend = { trait = dragon martial = 30 }			
			}
			change_variable = { which = "dragon_strength" value = 10 }
		}
		if = {
			limit = {
				any_friend = { trait = dragon martial = 40 }			
			}
			change_variable = { which = "dragon_strength" value = 10 }
		}
		if = {
			limit = {
				any_friend = { trait = dragon martial = 50 }			
			}
			change_variable = { which = "dragon_strength" value = 10 }
		}
		if = {
			limit = {
				any_friend = { trait = dragon martial = 60 }			
			}
			change_variable = { which = "dragon_strength" value = 10 }
		}
		if = {
			limit = {
				any_friend = { trait = dragon martial = 70 }			
			}
			change_variable = { which = "dragon_strength" value = 10 }
		}
		if = {
			limit = {
				any_friend = { trait = dragon martial = 80 }			
			}
			change_variable = { which = "dragon_strength" value = 10 }
		}
		if = {
			limit = {
				any_friend = { trait = dragon martial = 90 }			
			}
			change_variable = { which = "dragon_strength" value = 10 }
		}
		if = {
			limit = {
				any_friend = { trait = dragon martial = 100 }			
			}
			change_variable = { which = "dragon_strength" value = 10 }
		}
		# Skill-at-Arms Effects
		if = {
			limit = { trait = poor_warrior }
			change_variable = { which = "dragon_strength" value = 1 }
		}
		if = {
			limit = { trait = trained_warrior }
			change_variable = { which = "dragon_strength" value = 2 }
		}
		if = {
			limit = { trait = skilled_warrior }
			change_variable = { which = "dragon_strength" value = 4 }
		}
		if = {
			limit = { trait = master_warrior }
			change_variable = { which = "dragon_strength" value = 8 }
		}
		
		# Personality Effects
		if = {
			limit = { trait = brave }
			change_variable = { which = "dragon_strength" value = 3 }
		}
		if = {
			limit = { trait = wroth }
			change_variable = { which = "dragon_strength" value = 2 }
		}
		if = {
			limit = { trait = craven }
			change_variable = { which = "dragon_strength" value = -3 }
		}
		# Physical Strength Effects
		if = {
			limit = { trait = strong }
			change_variable = { which = "dragon_strength" value = 3 }
		}
		if = {
			limit = { trait = weak }
			change_variable = { which = "dragon_strength" value = -3 }
		}		
		# Cunning/Intelligence Effects
		if = {
			limit = { trait = genius }
			change_variable = { which = "dragon_strength" value = 6 }
		}
		if = {
			limit = { trait = quick }
			change_variable = { which = "dragon_strength" value = 3 }
		}
		if = {
			limit = { trait = imbecile }
			change_variable = { which = "dragon_strength" value = -3 }
		}
		if = {
			limit = { trait = slow }
			change_variable = { which = "dragon_strength" value = -3 }
		}
		# Wound Effects
		if = {
			limit = { trait = wounded }
			change_variable = { which = "dragon_strength" value = -3 }
		}
		if = {
			limit = { trait = maimed }
			change_variable = { which = "dragon_strength" value = -6 }
		}
		# Health Effects
		if = {
			limit = { is_ill = yes }
			change_variable = { which = "dragon_strength" value = -3 }
		}
		top_liege = {
			any_realm_character = { #allies
				limit = {
					trait = dragon_rider
					OR = {
						has_character_flag = dragonduel_siege	
						in_command = yes
					}
					NOT = { character = ROOT }
					at_location = ROOT
					NOT = {
						OR = {
							war_with = ROOT
							ROOT = { any_liege = { war_with = PREVPREV } }
							any_liege = { 
								OR = {
									war_with = ROOT 
									ROOT = { any_liege = { war_with = PREVPREV } }
								}	
							}
						}
					}	
				}	
				if = {
					limit = {
						any_friend = { trait = dragon martial = 10 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 11 } }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 20 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 30 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 40 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 50 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 60 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 70 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 80 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 90 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 100 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
				}
				# Skill-at-Arms Effects
				if = {
					limit = { trait = poor_warrior }
					ROOT = { change_variable = { which = "dragon_strength" value = 1 } }
				}
				if = {
					limit = { trait = trained_warrior }
					ROOT = { change_variable = { which = "dragon_strength" value = 2 } }
				}
				if = {
					limit = { trait = skilled_warrior }
					ROOT = { change_variable = { which = "dragon_strength" value = 4 } }
				}
				if = {
					limit = { trait = master_warrior }
					ROOT = { change_variable = { which = "dragon_strength" value = 8 } }
				}					
				# Personality Effects
				if = {
					limit = { trait = brave }
					ROOT = { change_variable = { which = "dragon_strength" value = 3 } }
				}
				if = {
					limit = { trait = wroth }
					ROOT = { change_variable = { which = "dragon_strength" value = 2 } }
				}
				if = {
					limit = { trait = craven }
					ROOT = { change_variable = { which = "dragon_strength" value = -3 } }
				}
				# Physical Strength Effects
				if = {
					limit = { trait = strong }
					ROOT = { change_variable = { which = "dragon_strength" value = 3 } }
				}
				if = {
					limit = { trait = weak }
					ROOT = { change_variable = { which = "dragon_strength" value = -3 } }
				}		
				# Cunning/Intelligence Effects
				if = {
					limit = { trait = genius }
					ROOT = { change_variable = { which = "dragon_strength" value = 6 } }
				}
				if = {
					limit = { trait = quick }
					ROOT = { change_variable = { which = "dragon_strength" value = 3 } }
				}
				if = {
					limit = { trait = imbecile }
					ROOT = { change_variable = { which = "dragon_strength" value = -3 } }
				}
				if = {
					limit = { trait = slow }
					ROOT = { change_variable = { which = "dragon_strength" value = -3 } }
				}
				# Wound Effects
				if = {
					limit = { trait = wounded }
					ROOT = { change_variable = { which = "dragon_strength" value = -3 } }
				}
				if = {
					limit = { trait = maimed }
					ROOT = { change_variable = { which = "dragon_strength" value = -6 } }
				}
				# Health Effects
				if = {
					limit = { is_ill = yes }
					ROOT = { change_variable = { which = "dragon_strength" value = -3 } }
				}
			}
		}	
		dragon_rider = { #scope to enemy team leader
			limit = {
				at_location = ROOT
				has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel }
				OR = {
					has_character_flag = dragonduel_team_leader_a 
					has_character_flag = dragonduel_team_leader_b
				}
			}	
			ROOT = { set_character_flag = enemy_dragon_found }
			character_event = { id = dragon.4594 }
		}
		if = { #If no enemy dragon riders left the duel is won
			limit = { NOT = { has_character_flag = enemy_dragon_found } }
			character_event = { id = dragon.48 days = 2 }
		}
		clr_character_flag = enemy_dragon_found
	}
	
	option = {
		name = OK
	}
}	
character_event = {
	id = dragon.4594
	
	is_triggered_only = yes
	hide_window = yes
	
	trigger = { trait = dragon_rider }
		
	immediate = {
		set_variable = { which = "dragon_strength" value = 0 }
		if = {
			limit = {
				any_friend = { trait = dragon martial = 10 }			
			}
			change_variable = { which = "dragon_strength" value = 11 }
		}
		if = {
			limit = {
				any_friend = { trait = dragon martial = 20 }			
			}
			change_variable = { which = "dragon_strength" value = 10 }
		}
		if = {
			limit = {
				any_friend = { trait = dragon martial = 30 }			
			}
			change_variable = { which = "dragon_strength" value = 10 }
		}
		if = {
			limit = {
				any_friend = { trait = dragon martial = 40 }			
			}
			change_variable = { which = "dragon_strength" value = 10 }
		}
		if = {
			limit = {
				any_friend = { trait = dragon martial = 50 }			
			}
			change_variable = { which = "dragon_strength" value = 10 }
		}
		if = {
			limit = {
				any_friend = { trait = dragon martial = 60 }			
			}
			change_variable = { which = "dragon_strength" value = 10 }
		}
		if = {
			limit = {
				any_friend = { trait = dragon martial = 70 }			
			}
			change_variable = { which = "dragon_strength" value = 10 }
		}
		if = {
			limit = {
				any_friend = { trait = dragon martial = 80 }			
			}
			change_variable = { which = "dragon_strength" value = 10 }
		}
		if = {
			limit = {
				any_friend = { trait = dragon martial = 90 }			
			}
			change_variable = { which = "dragon_strength" value = 10 }
		}
		if = {
			limit = {
				any_friend = { trait = dragon martial = 100 }			
			}
			change_variable = { which = "dragon_strength" value = 10 }
		}
		# Skill-at-Arms Effects
		if = {
			limit = { trait = poor_warrior }
			change_variable = { which = "dragon_strength" value = 1 }
		}
		if = {
			limit = { trait = trained_warrior }
			change_variable = { which = "dragon_strength" value = 2 }
		}
		if = {
			limit = { trait = skilled_warrior }
			change_variable = { which = "dragon_strength" value = 4 }
		}
		if = {
			limit = { trait = master_warrior }
			change_variable = { which = "dragon_strength" value = 8 }
		}
		
		# Personality Effects
		if = {
			limit = { trait = brave }
			change_variable = { which = "dragon_strength" value = 3 }
		}
		if = {
			limit = { trait = wroth }
			change_variable = { which = "dragon_strength" value = 2 }
		}
		if = {
			limit = { trait = craven }
			change_variable = { which = "dragon_strength" value = -3 }
		}
		# Physical Strength Effects
		if = {
			limit = { trait = strong }
			change_variable = { which = "dragon_strength" value = 3 }
		}
		if = {
			limit = { trait = weak }
			change_variable = { which = "dragon_strength" value = -3 }
		}		
		# Cunning/Intelligence Effects
		if = {
			limit = { trait = genius }
			change_variable = { which = "dragon_strength" value = 6 }
		}
		if = {
			limit = { trait = quick }
			change_variable = { which = "dragon_strength" value = 3 }
		}
		if = {
			limit = { trait = imbecile }
			change_variable = { which = "dragon_strength" value = -3 }
		}
		if = {
			limit = { trait = slow }
			change_variable = { which = "dragon_strength" value = -3 }
		}
		# Wound Effects
		if = {
			limit = { trait = wounded }
			change_variable = { which = "dragon_strength" value = -3 }
		}
		if = {
			limit = { trait = maimed }
			change_variable = { which = "dragon_strength" value = -6 }
		}
		# Health Effects
		if = {
			limit = { is_ill = yes }
			change_variable = { which = "dragon_strength" value = -3 }
		}
		top_liege = {
			any_realm_character = { #allies
				limit = {
					trait = dragon_rider
					OR = {
						has_character_flag = dragonduel_siege	
						in_command = yes
					}
					NOT = { character = ROOT }
					at_location = ROOT
					NOT = {
						OR = {
							war_with = ROOT
							ROOT = { any_liege = { war_with = PREVPREV } }
							any_liege = { 
								OR = {
									war_with = ROOT 
									ROOT = { any_liege = { war_with = PREVPREV } }
								}	
							}
						}
					}	
				}	
				if = {
					limit = {
						any_friend = { trait = dragon martial = 10 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 11 } }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 20 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 30 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 40 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 50 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 60 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 70 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 80 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 90 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
				}
				if = {
					limit = {
						any_friend = { trait = dragon martial = 100 }			
					}
					ROOT = { change_variable = { which = "dragon_strength" value = 10 } }
				}
				# Skill-at-Arms Effects
				if = {
					limit = { trait = poor_warrior }
					ROOT = { change_variable = { which = "dragon_strength" value = 1 } }
				}
				if = {
					limit = { trait = trained_warrior }
					ROOT = { change_variable = { which = "dragon_strength" value = 2 } }
				}
				if = {
					limit = { trait = skilled_warrior }
					ROOT = { change_variable = { which = "dragon_strength" value = 4 } }
				}
				if = {
					limit = { trait = master_warrior }
					ROOT = { change_variable = { which = "dragon_strength" value = 8 } }
				}					
				# Personality Effects
				if = {
					limit = { trait = brave }
					ROOT = { change_variable = { which = "dragon_strength" value = 3 } }
				}
				if = {
					limit = { trait = wroth }
					ROOT = { change_variable = { which = "dragon_strength" value = 2 } }
				}
				if = {
					limit = { trait = craven }
					ROOT = { change_variable = { which = "dragon_strength" value = -3 } }
				}
				# Physical Strength Effects
				if = {
					limit = { trait = strong }
					ROOT = { change_variable = { which = "dragon_strength" value = 3 } }
				}
				if = {
					limit = { trait = weak }
					ROOT = { change_variable = { which = "dragon_strength" value = -3 } }
				}		
				# Cunning/Intelligence Effects
				if = {
					limit = { trait = genius }
					ROOT = { change_variable = { which = "dragon_strength" value = 6 } }
				}
				if = {
					limit = { trait = quick }
					ROOT = { change_variable = { which = "dragon_strength" value = 3 } }
				}
				if = {
					limit = { trait = imbecile }
					ROOT = { change_variable = { which = "dragon_strength" value = -3 } }
				}
				if = {
					limit = { trait = slow }
					ROOT = { change_variable = { which = "dragon_strength" value = -3 } }
				}
				# Wound Effects
				if = {
					limit = { trait = wounded }
					ROOT = { change_variable = { which = "dragon_strength" value = -3 } }
				}
				if = {
					limit = { trait = maimed }
					ROOT = { change_variable = { which = "dragon_strength" value = -6 } }
				}
				# Health Effects
				if = {
					limit = { is_ill = yes }
					ROOT = { change_variable = { which = "dragon_strength" value = -3 } }
				}
			}
		}	
		c_the_citadel = { holder_scope = { character_event = { id = dragon.4597 days = 1 } } }
	}
	
	option = {
		name = OK
	}
}
# This event starts a new round of combat after resolving the previous one
character_event = {
	id = dragon.4597
	is_triggered_only = yes
	hide_window = yes
	
	# Nobody but the actual referee should ever get this
	trigger = { has_landed_title = c_the_citadel }
	
	immediate = {
		FROM = { FROM = { character_event = { id = dragon.4598 } } }	
		clr_global_flag = dragonduel1
	}
	
	option = {
		name = OK
	}
}
# MAIN LOOP
character_event = { #Team A leader
	id = dragon.4598
	desc = "EVTDESCdragon.4598"
	picture = "GFX_fieldoffire"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	hide_from = yes
	show_from_from = yes
	
	trigger = { 
		trait = dragon_rider 
		
		#Double check the combatants are valid
		NOT = { character = FROMFROM }
		NAND = {
			is_ruler = yes
			OR = {
				is_liege_or_above = FROMFROM
				is_vassal_or_below = FROMFROM
			}
		}	
		NAND = {
			is_ruler = no
			liege = {
				OR = {
					is_liege_or_above = FROMFROM
					is_vassal_or_below = FROMFROM
				}
			}	
		}
	}
	
	immediate = {
		# Set a target lock with the other duelist so that they can eventually be found via a search
		FROM = {
			FROM = {
				opinion = { who = ROOT modifier = opinion_duel_target }
				reverse_opinion = { who = ROOT modifier = opinion_duel_target }
			}
		}
	}
	
	option = {
		name = "EVTOPTAdragon.4598"
		if = { #Display participating riders if human
			limit = { ai = no }
			dragon_rider = { #enemies
				limit = {
					at_location = ROOT
					OR = {
						has_character_flag = dragonduel_siege	
						in_command = yes
					}
					has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel }
				}		
				top_liege = {
					any_realm_character = {
						limit = {
							trait = dragon_rider
							at_location = ROOT
							OR = {
								has_character_flag = dragonduel_siege	
								in_command = yes
							}
							has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel }
						}
						tooltip = { }			
						random_friend = {
							limit = {
								trait = dragon
								is_alive = yes
								age = 2
							}	
							custom_tooltip = { text = TOOLTIPdragon.43ENEMY }
						}
					}
				}	
			}
			top_liege = {			
				any_realm_character = { #allies
					limit = {
						trait = dragon_rider
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						NOT = { character = ROOT }
						at_location = ROOT
						NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }	
					}	
					tooltip = { }			
					random_friend = {
						limit = {
							trait = dragon
							is_alive = yes
							age = 2
						}	
						custom_tooltip = { text = TOOLTIPdragon.43ALLY }
					}	
				}
			}	
		}
		hidden_tooltip = { FROM = { FROM = { character_event = { id = dragon.4599 } } } }
	}
}
character_event = { #Team B leader
	id = dragon.4599
	desc = "EVTDESCdragon.4598"
	picture = "GFX_fieldoffire"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	trigger = { trait = dragon_rider }
	
	option = {
		name = "EVTOPTAdragon.4598"
		if = { #Display participating riders if human
			limit = { ai = no }
			dragon_rider = { #enemies
				limit = {
					at_location = ROOT
					OR = {
						has_character_flag = dragonduel_siege	
						in_command = yes
					}
					has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel }
				}		
				top_liege = {
					any_realm_character = {
						limit = {
							trait = dragon_rider
							at_location = ROOT
							OR = {
								has_character_flag = dragonduel_siege	
								in_command = yes
							}
							has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel }
						}
						tooltip = { }			
						random_friend = {
							limit = {
								trait = dragon
								is_alive = yes
								age = 2
							}	
							custom_tooltip = { text = TOOLTIPdragon.43ENEMY }
						}
					}
				}	
			}
			top_liege = {			
				any_realm_character = { #allies
					limit = {
						trait = dragon_rider
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						NOT = { character = ROOT }
						at_location = ROOT
						NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }	
					}	
					tooltip = { }			
					random_friend = {
						limit = {
							trait = dragon
							is_alive = yes
							age = 2
						}	
						custom_tooltip = { text = TOOLTIPdragon.43ALLY }
					}	
				}
			}	
		}
		hidden_tooltip = { c_the_citadel = { holder_scope = { character_event = { id = dragon.45 days = 1 } } } }
	}
}
# RESOLVE ROUND - WINNER
# Determine who "won" the round by weighting stats
character_event = {
	id = dragon.45
	is_triggered_only = yes
	desc = "EVTDESCdragon.45"
	
	# Nobody but the actual referee should ever get this
	trigger = { has_landed_title = c_the_citadel }
	
	# FROM/Team B wins
	option = {
		name = "FROM wins"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 1.5
				FROM = { check_variable = { which = "dragon_strength" value = 10 } }
			}	
			modifier = {
				factor = 1.4
				FROM = { check_variable = { which = "dragon_strength" value = 20 } }
			}	
			modifier = {
				factor = 1.3
				FROM = { check_variable = { which = "dragon_strength" value = 30 } }
			}	
			modifier = {
				factor = 1.3
				FROM = { check_variable = { which = "dragon_strength" value = 40 } }
			}	
			modifier = {
				factor = 1.25
				FROM = { check_variable = { which = "dragon_strength" value = 50 } }
			}	
			modifier = {
				factor = 1.25
				FROM = { check_variable = { which = "dragon_strength" value = 60 } }
			}	
			modifier = {
				factor = 1.25
				FROM = { check_variable = { which = "dragon_strength" value = 70 } }
			}	
			modifier = {
				factor = 1.25
				FROM = { check_variable = { which = "dragon_strength" value = 80 } }
			}	
			modifier = {
				factor = 1.25
				FROM = { check_variable = { which = "dragon_strength" value = 90 } }
			}	
			modifier = {
				factor = 1.25
				FROM = { check_variable = { which = "dragon_strength" value = 100 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 110 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 120 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 130 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 140 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 150 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 160 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 170 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 180 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 190 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 200 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 210 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 220 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 230 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 240 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 250 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 260 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 270 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 280 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 290 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 300 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 310 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 320 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 330 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 340 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 350 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 360 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 370 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 380 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 390 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 400 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 410 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 420 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 430 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 440 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 450 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 460 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 470 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 480 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 490 } }
			}	
			modifier = {
				factor = 1.15
				FROM = { check_variable = { which = "dragon_strength" value = 500 } }
			}					
		}
		FROM = { FROM = { character_event = { id = dragon.4699 } } }
	}
	#lost
	# FROMFROM /Team A wins
	option = {
		name = "FROMFROM wins"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 1.5
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 10 } } }
			}	
			modifier = {
				factor = 1.4
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 20 } } }
			}	
			modifier = {
				factor = 1.3
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 30 } } }
			}	
			modifier = {
				factor = 1.3
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 40 } } }
			}	
			modifier = {
				factor = 1.25
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 50 } } }
			}	
			modifier = {
				factor = 1.25
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 60 } } }
			}	
			modifier = {
				factor = 1.25
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 70 } } }
			}	
			modifier = {
				factor = 1.25
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 80 } } }
			}	
			modifier = {
				factor = 1.25
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 90 } } }
			}	
			modifier = {
				factor = 1.25
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 100 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 110 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 120 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 130 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 140 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 150 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 160 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 170 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 180 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 190 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 200 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 210 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 220 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 230 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 240 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 250 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 260 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 270 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 280 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 290 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 300 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 310 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 320 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 330 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 340 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 350 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 360 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 370 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 380 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 390 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 400 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 410 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 420 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 430 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 440 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 450 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 460 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 470 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 480 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 490 } } }
			}	
			modifier = {
				factor = 1.15
				FROM = { FROM = { check_variable = { which = "dragon_strength" value = 500 } } }
			}				
		}
		FROM = { character_event = { id = dragon.4699 } } 
	}
	# option = {
		# name = "Invalid Duel"
		# trigger = {
			# NOT = {
				# FROM = { trait = dragon}
				# FROM = { FROM = { trait = dragon} }
			# }
		# }
		# ai_chance = {
			# factor = 0.1
		# }
		# if = {
			# limit = {
				# NOT = { FROM = { trait = dragon} }
			# }
			# FROM = { FROM = { character_event = { id = dragon.59 } }}
		# }
		# if = {
			# limit = {
				# NOT = { FROM = { FROM = { trait = dragon} } }
			# }
			 # FROM = { character_event = { id = dragon.59 } }
		# }
		# #cleanup
		# FROM = { clr_character_flag = tried_escape_dd FROM = { clr_character_flag = tried_escape_dd}}
	# }
}
# Winning team attacks!
character_event = {
	id = dragon.4698
	desc = "EVTDESCdragon.4698"
	picture = "GFX_fieldoffire"
	border = "GFX_event_normal_frame_war"
		
	is_triggered_only = yes
	
	immediate = {
		remove_opinion = { who = FROM modifier = opinion_duel_target }
		reverse_remove_opinion = { who = FROM modifier = opinion_duel_target }
	}
	
	option = {
		name = "EVTOPTAdragon.4698"
		hidden_tooltip = { # Determine attack outcome
			random_list = {
				75 = { #death
					modifier = {
						factor = 0.66
						event_target:dragon_duel_round_winner = {
							event_target:dragon_duel_round_loser = {
								attribute_diff = {
									character = PREV
									attribute = martial
									value = 20
								}
							}
						}	
					}
					modifier = {
						factor = 0.66
						event_target:dragon_duel_round_winner = {
							event_target:dragon_duel_round_loser = {
								attribute_diff = {
									character = PREV
									attribute = martial
									value = 40
								}
							}
						}	
					}
					modifier = {
						factor = 0.66
						event_target:dragon_duel_round_winner = {
							event_target:dragon_duel_round_loser = {
								attribute_diff = {
									character = PREV
									attribute = martial
									value = 60
								}
							}
						}	
					}
					modifier = {
						factor = 0.66
						event_target:dragon_duel_round_winner = {
							event_target:dragon_duel_round_loser = {
								attribute_diff = {
									character = PREV
									attribute = martial
									value = 80
								}
							}
						}	
					}
					modifier = {
						factor = 1.5
						event_target:dragon_duel_round_loser = {
							event_target:dragon_duel_round_winner = {
								attribute_diff = {
									character = PREV
									attribute = martial
									value = 20
								}
							}
						}	
					}
					modifier = {
						factor = 1.5
						event_target:dragon_duel_round_loser = {
							event_target:dragon_duel_round_winner = {
								attribute_diff = {
									character = PREV
									attribute = martial
									value = 40
								}
							}
						}	
					}
					modifier = {
						factor = 1.5
						event_target:dragon_duel_round_loser = {
							event_target:dragon_duel_round_winner = {
								attribute_diff = {
									character = PREV
									attribute = martial
									value = 60
								}
							}
						}	
					}
					modifier = {
						factor = 1.5
						event_target:dragon_duel_round_loser = {
							event_target:dragon_duel_round_winner = {
								attribute_diff = {
									character = PREV
									attribute = martial
									value = 80
								}
							}
						}	
					}
					event_target:dragon_duel_round_loser = { character_event = { id = dragon.47 } }
				}
				100 = { #wound
					event_target:dragon_duel_round_loser = { character_event = { id = dragon.4794 } }
				}
			}		
		}
				
		hidden_tooltip = {
			top_liege = {
				any_realm_character = { #inform allies
					limit = {
						ai = no
						trait = dragon_rider
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						NOT = { character = ROOT }
						at_location = ROOT
						NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }	
					}
					character_event = { id = dragon.4697 }		
				}
			}	
		}
	}
}
character_event = {
	id = dragon.4697
	desc = "EVTDESCdragon.4697"
	picture = "GFX_fieldoffire"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	show_from_from = yes
	
	option = {
		name = "EVTOPTAdragon.4698"
	}
}
# Losing team is attacked!
character_event = {
	id = dragon.4699
	desc = "EVTDESCdragon.4699"
	picture = "GFX_fieldoffire"
	border = "GFX_event_normal_frame_war"	
	
	is_triggered_only = yes
	hide_from = yes
	
	immediate = {
		hidden_tooltip = {
			#select random dragon to lose
			top_liege = { 
				random_realm_character = {
					limit = {
						trait = dragon_rider
						OR = {
							character = ROOT
							AND = {
								OR = {
									has_character_flag = dragonduel_siege	
									in_command = yes
								}
								at_location = ROOT
								NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }
							}
						}	
					}
					random_friend = {
						limit = {
							trait = dragon
							age = 2
							is_alive = yes
						}
						save_event_target_as = dragon_duel_round_loser
						ROOT = { set_character_flag = losing_dragon_found }
					}					
				}
			}
			if = {
				limit = { NOT = { has_character_flag = losing_dragon_found } }
				random_friend = {
					limit = {
						trait = dragon
						age = 2
						is_alive = yes
					}
					save_event_target_as = dragon_duel_round_loser
					ROOT = { set_character_flag = losing_dragon_found }
				}
			}
			clr_character_flag = losing_dragon_found
			dragon_rider = { #select random dragon to win
				limit = { has_opinion_modifier = { who = ROOT modifier = opinion_duel_target } }
				top_liege = { 
					random_realm_character = {
						limit = {
							trait = dragon_rider
							OR = {
								has_character_flag = dragonduel_siege	
								in_command = yes
							}
							at_location = ROOT
							NOT = { has_opinion_modifier = { who = PREVPREV modifier = opinion_dragon_duel } }	
						}
						random_friend = {
							limit = {
								trait = dragon
								age = 2
								is_alive = yes
							}
							save_event_target_as = dragon_duel_round_winner
							ROOT = { set_character_flag = winning_dragon_found }
						}					
					}
				}
				if = {
					limit = { NOT = { ROOT = { has_character_flag = winning_dragon_found } } }
					random_friend = {
						limit = {
							trait = dragon
							age = 2
							is_alive = yes
						}
						save_event_target_as = dragon_duel_round_winner
						ROOT = { set_character_flag = winning_dragon_found }
					}
				}
			}
			clr_character_flag = winning_dragon_found
		}
	}
	
	option = {
		name = "EVTOPTAdragon.4699"	
		dragon_rider = {
			limit = { has_opinion_modifier = { who = ROOT modifier = opinion_duel_target } }
			character_event = { id = dragon.4698 tooltip = "EVTTOOLTIPdragon.4698" }
		}
		hidden_tooltip = {
			top_liege = {
				any_realm_character = { #inform allies
					limit = {
						ai = no
						trait = dragon_rider
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						NOT = { character = ROOT }
						at_location = ROOT
						NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }	
					}
					character_event = { id = dragon.4696 }		
				}
			}	
		}
	}
}
character_event = {
	id = dragon.4696
	desc = "EVTDESCdragon.4699"
	picture = "GFX_fieldoffire"
	border = "GFX_event_normal_frame_war"	
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.4699"
		dragon_rider = {
			limit = { has_opinion_modifier = { who = FROM modifier = opinion_duel_target } }
			tooltip = { character_event = { id = dragon.4698 tooltip = "EVTTOOLTIPdragon.4698" } }
		}
	}
}
### DRAGON DEATH OUTCOMES
character_event = { #scope to dead dragon
	id = dragon.47

	is_triggered_only = yes
	hide_window = yes
	
	trigger = {
		any_friend = { 
			OR = {
				has_character_flag = dragonduel_siege	
				in_command = yes
			} 
		}
	}

	immediate = {
		set_character_flag = dragon.47	
		event_target:dragon_duel_round_winner = { character_event = { id = dragon.4790 } }
		clear_event_target = dragon_duel_round_loser
	}
	
	option = {
		name = OK
	}
}
character_event = { #scope to killer dragon
	id = dragon.4790

	is_triggered_only = yes
	hide_window = yes

	immediate = {
		set_character_flag = dragon.4790
		clear_event_target = dragon_duel_round_winner
		hidden_tooltip = {
			any_playable_ruler = { #Inform world
				limit = {
					ai = no
					NOT = { is_friend = FROM }
					NOT = { has_character_flag = dragonduel }
					NOT = { has_character_flag = no_dragon_duel_information }
				}
				character_event = { id = dragon.5801 }
			}
		}
		random_friend = {
			top_liege = {
				any_realm_character = { #inform other participants
					limit = {
						trait = dragon_rider
						ai = no
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						has_character_flag = dragonduel
						at_location = PREVPREV
						NOT = { character = PREVPREV }
						NOT = { has_opinion_modifier = { who = PREVPREV modifier = opinion_dragon_duel } }	
					}
					character_event = { id = dragon.4793 }
				}	
			}	
			character_event = { id = dragon.4792 }			
		}
		FROM = {
			random_friend = {		
				top_liege = {
					any_realm_character = { #inform other participants
						limit = {
							trait = dragon_rider
							ai = no
							OR = {
								has_character_flag = dragonduel_siege	
								in_command = yes
							}
							has_character_flag = dragonduel
							at_location = PREVPREV
							NOT = { character = PREVPREV }
							NOT = { has_opinion_modifier = { who = PREVPREV modifier = opinion_dragon_duel } }	
						}
						character_event = { id = dragon.4793 }
					}	
				}
				character_event = { id = dragon.4791 }			
			}
			death = {
				death_reason = death_duel
				killer = ROOT
			}
		}	
	}
	
	option = {
		name = OK
	}
}
character_event = { #My dragon was killed
	id = dragon.4791
	desc = "EVTDESCddragon.4791"
	picture = "GFX_fieldoffire"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	immediate = {
		set_character_flag = dragon.4791
		clr_character_flag = dragonduel	
		clr_character_flag = dragonduel_siege	
		dragon_rider = {
			limit = { at_location = ROOT has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }
			remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
			reverse_remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
			top_liege = {
				any_realm_character = {
					limit = { trait = dragon_rider }
					remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
					reverse_remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
				}
			}	
		}
		#If team leader pick a new team leader
		if = {
			limit = { 
				OR = {
					has_character_flag = dragonduel_team_leader_a 
					has_character_flag = dragonduel_team_leader_b
				}	
			} 
			top_liege = {
				random_realm_character = {
					limit = {
						trait = dragon_rider
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						NOT = { character = ROOT }
						at_location = ROOT
						NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }	
					}
					if = {
						limit = { ROOT = { has_character_flag = dragonduel_team_leader_a } }
						set_character_flag = dragonduel_team_leader_a
					}
					if = {
						limit = { ROOT = { has_character_flag = dragonduel_team_leader_b } }
						set_character_flag = dragonduel_team_leader_b
					}	
				}
			}
		}
		clr_character_flag = dragonduel_team_leader_a 
		clr_character_flag = dragonduel_team_leader_b
	}

	option = {
		name = "EVTOPTAdragon.4791"
		remove_trait = dragon_rider
		if = {
			limit = { ai = no }
			FROM = { random_friend = { save_event_target_as = dragons_rider_duel } }
			chronicle = {
				entry = CHRONICLE_LOST_DRAGON_DUEL_DIED
				portrait = [From.GetID]
				picture = GFX_fieldoffire
			}
		}
		FROM = {
			FROM = {
				tooltip = {
					death = {
						death_reason = death_duel
						killer = FROM
					}
				}	
			}
		}
		random_list = {
			20 = {
				
			}
			23 = {
				if = {
					limit = { trait = wounded }			
					hidden_tooltip = { remove_trait = wounded }
					add_trait = maimed
				}
				if = {
					limit = { 
						NOT = { trait = wounded } 
						NOT = { trait = maimed }
					}
					add_trait = wounded
				}
			}
			23 = {
				add_trait = crippled
			}
			34 = {
				FROM = {
					random_friend = {
						ROOT = {
							red_god_resurrect_effect = yes #check for rhllor resurrection
							death = {
								death_reason = death_duel
								killer = PREV
							}
						}
					}
				}
			}
		}		
		random = {
			chance = 50 
			set_character_flag = captured_in_battle
			if = {
				limit = {
					FROM = { any_friend = { is_ruler = yes } }
					is_alive = yes
				}
				FROM = { 
					random_friend = {
						ROOT = { imprison = PREV }
					}	
				}
			}
			if = {
				limit = {
					FROM = { any_friend = { is_ruler = no } }
					is_alive = yes
				}
				FROM = { 
					random_friend = {
						liege = {
							ROOT = { imprison = PREV }
							hidden_tooltip = { character_event = { id = dragon.5800 days = 2 } }
						}	
					}	
				}
			}
		}	
	}
}
character_event = { #I killed an enemy dragon
	id = dragon.4792
	desc = "EVTDESCddragon.4792"
	picture = "GFX_fieldoffire"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	show_from_from = yes
	
	option = {
		name = "EVTOPTAdragon.4792"
		set_character_flag = dragon.4792
		if = {
			limit = { ai = no }
			FROMFROM = { random_friend = { save_event_target_as = dragons_rider_duel } }
			chronicle = {
				entry = CHRONICLE_WON_DRAGON_DUEL_DIED
				portrait = [FromFrom.GetID]
				picture = GFX_fieldoffire
			}
		}
		FROMFROM = {
			tooltip = {
				death = {
					death_reason = death_duel
					killer = FROM
				}
			}
		}		
		if = {
			limit = { FROMFROM = { NOT = { martial = 20 } } }
			ROOT = { prestige = 20 }
			FROM = { prestige = 20 }
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 15
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = {
				FROMFROM = {
					martial = 20
					NOT = { martial = 40 } 
				}	
			}
			ROOT = { prestige = 40 }
			FROM = { prestige = 40 }
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 20
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = {
				FROMFROM = {
					martial = 40
					NOT = { martial = 60 } 
				}	
			}
			ROOT = { prestige = 70 }
			FROM = { prestige = 70 }
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 30
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = {
				FROMFROM = {
					martial = 60
					NOT = { martial = 80 }
				}	
			}
			ROOT = { prestige = 100 }
			FROM = { prestige = 100 }
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 40
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = {
				FROMFROM = {
					martial = 80
					NOT = { martial = 100 } 
				}	
			}
			ROOT = { prestige = 150 }
			FROM = { prestige = 150 }
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 50
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = { FROMFROM = { martial = 100 } }
			ROOT = { prestige = 200 }
			FROM = { prestige = 200 }
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 65
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}	
		random_list = {
			89 = {
				
			}
			10 = {
				if = {
					limit = { trait = wounded }			
					hidden_tooltip = { remove_trait = wounded }
					add_trait = maimed
				}
				if = {
					limit = { 
						NOT = { trait = wounded } 
						NOT = { trait = maimed }
					}
					add_trait = wounded
				}
			}
			1 = {
				add_trait = crippled
			}
		}
		hidden_tooltip = { #Scope back to team leader
			if = { 
				limit = {
					OR = {
						has_character_flag = dragonduel_team_leader_a 
						has_character_flag = dragonduel_team_leader_b
					}	
				}
				character_event = { id = dragon.4595 days = 1 }
			}
			top_liege = {
				random_realm_character = {
					limit = {
						trait = dragon_rider
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						NOT = { character = ROOT }
						at_location = ROOT	
						OR = {
							has_character_flag = dragonduel_team_leader_a 
							has_character_flag = dragonduel_team_leader_b
						}
						NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }							
					}
					character_event = { id = dragon.4595 days = 1 }
				}
			}
		}
	}
}	
character_event = { #Inform other riders of killed dragon
	id = dragon.4793
	desc = "EVTDESCddragon.4793"
	picture = "GFX_fieldoffire"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	show_from_from = yes
	
	option = {
		name = "EVTOPTAdragon.4792"
		FROM = { 
			tooltip = { } 
			random_friend = { tooltip = { } }
		}
		FROMFROM = {
			tooltip = { 
				death = {
					death_reason = death_duel
					killer = FROM
				}
			}
			random_friend = { tooltip = { } }
		}
	}
}	
#Inform liege Dragon rider captured
character_event = {
	id = dragon.5800
	desc = "EVTDESCdragon.5800"
	picture = "GFX_dracarys"
	
	is_triggered_only = yes	
	
	option = {
		name = OK
		FROM = { 
			imprison = ROOT
			tooltip = { } 
		}
		FROMFROM = {
			tooltip = { }
			random_friend = { tooltip = { } }
		}
	}
}
#Inform world of dragon death in duel
character_event = {
	id = dragon.5801
	desc = "EVTDESCdragon.5801"
	picture = "GFX_dracarys"
	
	is_triggered_only = yes	
	
	show_from_from = yes
	
	immediate = {
		FROM = { random_friend = { save_event_target_as = dragons_rider_FROM } }
		FROMFROM = { random_friend = { save_event_target_as = dragons_rider_FROMFROM } }
	}
	
	option = {
		name = "EVTOPTAdragon.5801"
		if = {
			limit = { 
				OR = {
					FROM = {
						any_friend = {
							OR = {
								liege = { character = ROOT }
								is_close_relative = ROOT
							}
						}
					}
					FROMFROM = {
						any_friend = {
							OR = {
								liege = { character = ROOT }
								is_close_relative = ROOT
							}
						}
					}
				}
			}			
			chronicle = {
				entry = CHRONICLE_DRAGON_DUEL
				portrait = [FromFrom.GetID]
			}
		}
		FROM = { #killer
			tooltip = { } 
			random_friend = { tooltip = { } }
		}
		FROMFROM = { #dead
			tooltip = { }
			random_friend = { tooltip = { } }
		}
	}
	
	option = {
		name = "EVTOPTBdragon.5801" #do not inform me of this
		set_character_flag = no_dragon_duel_information
	}
}	
### DRAGON WOUNDING OUTCOMES
character_event = { #scope to wounded dragon
	id = dragon.4794

	is_triggered_only = yes
	hide_window = yes
	
	trigger = {
		any_friend = {
			OR = {
				has_character_flag = dragonduel_siege	
				in_command = yes
			}
		}
	}

	immediate = {
		set_character_flag = dragon.4794	
		event_target:dragon_duel_round_winner = { character_event = { id = dragon.4795 } }
		clear_event_target = dragon_duel_round_loser
	}
	
	option = {
		name = OK
	}
}
character_event = { #scope to killer dragon
	id = dragon.4795

	is_triggered_only = yes
	hide_window = yes

	immediate = {
		set_character_flag = dragon.4795	
		clear_event_target = dragon_duel_round_winner
		random_friend = {
			character_event = { id = dragon.4797 }
			top_liege = {
				any_realm_character = { #inform other participants
					limit = {
						trait = dragon_rider
						ai = no
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						has_character_flag = dragonduel
						at_location = PREVPREV
						NOT = { character = PREVPREV }
						NOT = { has_opinion_modifier = { who = PREVPREV modifier = opinion_dragon_duel } }	
					}
					character_event = { id = dragon.4798 }
				}	
			}		
		}
		FROM = {
			random_friend = {
				top_liege = {
					any_realm_character = { #inform other participants
						limit = {
							trait = dragon_rider
							ai = no
							OR = {
								has_character_flag = dragonduel_siege	
								in_command = yes
							}
							has_character_flag = dragonduel
							at_location = PREVPREV
							NOT = { character = PREVPREV }
							NOT = { has_opinion_modifier = { who = PREVPREV modifier = opinion_dragon_duel } }	
						}
						character_event = { id = dragon.4798 }
					}	
				}
				character_event = { id = dragon.4796 }			
			}
		}
	}
	
	option = {
		name = OK
	}
}
character_event = { #My dragon was wounded
	id = dragon.4796
	desc = "EVTDESCddragon.4796"
	picture = "GFX_fieldoffire"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.4796"
		set_character_flag = dragon.4796
		FROM = {
			FROM = {
				if = {
					limit = { trait = wounded_dragon }
					hidden_tooltip = { remove_trait = wounded_dragon }
					add_trait = maimed_dragon
				}
				if = {
					limit = { 
						NOT = { trait = wounded_dragon }
						NOT = { trait = maimed_dragon }
					}
					add_trait = wounded_dragon
				}
			}
		}
		random_list = {
			66 = {
				
			}
			33 = {
				if = {
					limit = { trait = wounded }			
					hidden_tooltip = { remove_trait = wounded }
					add_trait = maimed
				}
				if = {
					limit = { 
						NOT = { trait = wounded } 
						NOT = { trait = maimed }
					}
					add_trait = wounded
				}
			}
		}		
	}
}
character_event = { #I wounded an enemy dragon
	id = dragon.4797
	desc = "EVTDESCddragon.4797"
	picture = "GFX_fieldoffire"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	show_from_from = yes
	
	option = {
		name = "EVTOPTAdragon.4797"
		set_character_flag = dragon.4797
		random_list = {
			95 = {
				
			}
			5 = {
				if = {
					limit = { trait = wounded }			
					hidden_tooltip = { remove_trait = wounded }
					add_trait = maimed
				}
				if = {
					limit = { 
						NOT = { trait = wounded } 
						NOT = { trait = maimed }
					}
					add_trait = wounded
				}
			}
		}
		if = {
			limit = { FROMFROM = { NOT = { martial = 20 } } }
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 15
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = {
				FROMFROM = {
					martial = 20
					NOT = { martial = 40 } 
				}	
			}
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 20
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = {
				FROMFROM = {
					martial = 40
					NOT = { martial = 60 } 
				}	
			}
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 30
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = {
				FROMFROM = {
					martial = 60
					NOT = { martial = 80 }
				}	
			}
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 40
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = {
				FROMFROM = {
					martial = 80
					NOT = { martial = 100 } 
				}	
			}
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 50
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		if = {
			limit = { FROMFROM = { martial = 100 } }
			FROM = {
				if = {
					limit = {
						NOT = { trait = maimed_dragon }
					}
					random = {
						chance = 65
						if = {
							limit = { trait = wounded_dragon }
							hidden_tooltip = { 
								remove_trait = wounded_dragon
								character_event = { id = dragon.93 }
							}
							add_trait = maimed_dragon
						}
						if = {
							limit = { 
								NOT = { trait = wounded_dragon }
								NOT = { trait = maimed_dragon }
							}
							add_trait = wounded_dragon
							hidden_tooltip = { character_event = { id = dragon.91 } }
						}
					}
				}	
			}
		}
		hidden_tooltip = { #Scope back to team leader
			if = { 
				limit = {
					OR = {
						has_character_flag = dragonduel_team_leader_a 
						has_character_flag = dragonduel_team_leader_b
					}	
				}
				character_event = { id = dragon.4595 }
				break = yes
			}		
			top_liege = {
				random_realm_character = {
					limit = {
						trait = dragon_rider
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						at_location = ROOT	
						OR = {
							has_character_flag = dragonduel_team_leader_a 
							has_character_flag = dragonduel_team_leader_b
						}	
						NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }	
					}
					character_event = { id = dragon.4595 }
				}
			}
		}
	}
}	
character_event = { #Inform other riders of wounded dragon
	id = dragon.4798
	desc = "EVTDESCddragon.4798"
	picture = "GFX_fieldoffire"
	border = "GFX_event_normal_frame_war"
	
	is_triggered_only = yes
	
	show_from_from = yes
	
	option = {
		name = "EVTOPTAdragon.4798"
		FROM = { 
			tooltip = { } 
			random_friend = { tooltip = { } }
		}
		FROMFROM = {
			tooltip = { }
			random_friend = { tooltip = { } }
		}
	}
}	
#WE WON THE DUEL
character_event = {
	id = dragon.48
	desc = "EVTDESCdragon.48"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes	
	show_from_from = yes
	
	immediate = {	
		hidden_tooltip = {
			top_liege = {
				any_realm_character = { #inform allies
					limit = {
						trait = dragon_rider
						OR = {
							has_character_flag = dragonduel_siege	
							in_command = yes
						}
						NOT = { character = ROOT }
						at_location = ROOT
						NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }	
					}
					character_event = { id = dragon.4890 }		
				}
			}	
		}
		clr_character_flag = dragonduel	
		clr_character_flag = dragonduel_siege	
		set_character_flag = dragon.48
		dragon_rider = {
			limit = { at_location = ROOT has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }
			remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
			reverse_remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
			top_liege = {
				any_realm_character = {
					limit = { trait = dragon_rider }
					remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
					reverse_remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
				}
			}	
		}
		clr_character_flag = dragonduel_team_leader_a 
		clr_character_flag = dragonduel_team_leader_b		
	}
	
	option = {
		name = "EVTOPTAdragon.48"			
	}
}
character_event = {
	id = dragon.4890
	desc = "EVTDESCdragon.48"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes	
	
	immediate = {	
		clr_character_flag = dragonduel	
		clr_character_flag = dragonduel_siege	
		dragon_rider = {
			limit = { at_location = ROOT has_opinion_modifier = { who = ROOT modifier = opinion_dragon_duel } }
			remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
			reverse_remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
			top_liege = {
				any_realm_character = {
					limit = { trait = dragon_rider }
					remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
					reverse_remove_opinion = { who = ROOT modifier = opinion_dragon_duel }
				}
			}	
		}
		clr_character_flag = dragonduel_team_leader_a 
		clr_character_flag = dragonduel_team_leader_b
	}
	
	option = {
		name = "EVTOPTAdragon.48"			
	}
}

# #Inform opponent escaped
# character_event = {
	# id = dragon.53
	# desc = "EVTDESCdragon.53"
	# picture = "GFX_valyria_dragon"
	
	# is_triggered_only = yes	
	
	# trigger = { has_character_flag = dragon_duel_resolved }
	
	# immediate = {	
		# clr_character_flag = dragon_duel_resolved
	# }
	
	# option = {
		# name = "EVTOPTAdragon.53"  
	# }
# }
# #Inform opponent not escaped
# character_event = {
	# id = dragon.54
	# desc = "EVTDESCdragon.54"
	# picture = "GFX_valyria_dragon"
	
	# is_triggered_only = yes	
	
	# trigger = { has_character_flag = dragon_duel_resolved }
	
	# immediate = {	
		# clr_character_flag = dragon_duel_resolved
	# }

	# option = {
		# name = "EVTOPTAdragon.54"  		
	# }
# }
# #Inform you didnt escape
# character_event = {
	# id = dragon.55
	# desc = "EVTDESCdragon.55"
	# picture = "GFX_valyria_dragon"
	
	# is_triggered_only = yes	
	
	# trigger = { has_character_flag = dragon_duel_resolved }
	
	# immediate = {	
		# clr_character_flag = dragon_duel_resolved
	# }

	# option = {
		# name = "EVTOPTAdragon.55"  	
	# }
# }
#Inform opponent stays in castle
character_event = {
	id = dragon.56
	desc = "EVTDESCdragon.56"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes	
	
	trigger = { has_character_flag = dragon_duel_resolved }
	
	immediate = {	
		clr_character_flag = dragon_duel_resolved
	}

	option = {
		name = "EVTOPTAdragon.56"  
		
	}
}
# #Inform you escaped
# character_event = {
	# id = dragon.57
	# desc = "EVTDESCdragon.57"
	# picture = "GFX_valyria_dragon"
	
	# is_triggered_only = yes	
	
	# trigger = { has_character_flag = dragon_duel_resolved }
	
	# immediate = {	
		# clr_character_flag = dragon_duel_resolved
	# }

	# option = {
		# name = "EVTOPTAdragon.57"  	
	# }
# }
# #Inform dragon vs dragon opponent gone
# character_event = {
	# id = dragon.59
	# desc = "EVTDESCdragon.59"
	# picture = "GFX_valyria_dragon"
	
	# is_triggered_only = yes	
	
	# trigger = {
		# trait = dragon		
	# }
	
	# option = {
		# name = "EVTOPTAdragon.59"  
		# if = {
			# limit = { 
				# NOT = { trait = poor_warrior_dragon }
				# NOT = { trait = trained_warrior_dragon } 
				# NOT = { trait = skilled_warrior_dragon } 
				# NOT = { trait = master_warrior_dragon } 
			# }
			# add_trait = poor_warrior_dragon
		# }
	# }
# }
###INTEL###
#dragon pit intel
character_event = {
	id = dragon.60
	desc = "dragon_intel_dragonpit_desc"
	min_age = 12
	picture = "GFX_valyria_dragon" 
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		trait = dragon_egg
		NOT = { has_character_flag = dragon_intel_dragonpit	}
		NOT = { trait = dragon_rider }
		location = {
			county = {
				title = c_kings_landing
			}
		}
		b_red_keep = { has_building = ca_dragon_pit }
	}
	mean_time_to_happen = {
		days = 1		
	}
	
	option = {
		name = "dragon_intel_dragonpit_opt"
		ai_chance = {
			factor = 100
		}
		
		set_character_flag = dragon_intel_dragonpit	
		prestige = 25
	}		
}
#dragonstone intel
character_event = {
	id = dragon.61
	desc = "dragon_intel_dragonstone_desc"
	min_age = 12
	picture = "GFX_valyria_dragon" 
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		trait = dragon_egg
		NOT = { trait = dragon_rider }
		NOT = { has_character_flag = dragon_intel_dragonstone }
		location = {
			county = {
				title = c_dragonstone
			}
		}

	}
	mean_time_to_happen = {
		days = 1	
	}
	
	option = {
		name = "dragon_intel_dragonstone_opt"
		ai_chance = {
			factor = 100
		}	
		set_character_flag = dragon_intel_dragonstone
		prestige = 25
	}		
}
#citadel intel
character_event = {
	id = dragon.62
	desc = "dragon_intel_citadel_desc"
	picture = GFX_evt_library
	min_age = 12

	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		trait = dragon_egg
		NOT = { has_character_flag = dragon_intel_citadel }
		NOT = { trait = dragon_rider }
		location = {
			county = {
				title = c_oldtown
			}
		}
	}
	
	mean_time_to_happen = {
		days = 1	
	}
	
	option = {
		name = "dragon_intel_citadel_opt"
		ai_chance = {
			factor = 100
		}
	
		set_character_flag = dragon_intel_citadel
		prestige = 25
	}		
}
#fof intel
character_event = {
	id = dragon.63
	desc = "dragon_intel_fof_desc"
	picture = "GFX_fieldoffire"
	min_age = 12
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		trait = dragon_egg
		NOT = { has_character_flag = dragon_intel_fof }
		NOT = { has_global_flag = pre_conquest_scenario }
		NOT = { trait = dragon_rider }
		location = {
			county = {
				title = c_bramsfort
			}
		}
	}
	
	mean_time_to_happen = {
		days = 1	
	}
	
	option = {
		name = "dragon_intel_fof_opt"
		ai_chance = {
			factor = 100
		}	
		set_character_flag = dragon_intel_fof
		prestige = 25
	}		
}
#harrenhal intel
character_event = {
	id = dragon.64
	desc = "dragon_intel_harrenhal_desc"
	picture = "GFX_fallofharrenhal"
	min_age = 12
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		trait = dragon_egg
		NOT = { has_character_flag = dragon_intel_harrenhal }
		NOT = { trait = dragon_rider }
		location = {
			county = {
				title = c_harrenhal
			}		
		}
		b_kingharren1 = { has_building = ca_harrenhal_ruins }
	}
	mean_time_to_happen = {
		days = 1		
	}
	
	option = {
		name = "dragon_intel_harrenhal_opt"
		ai_chance = {
			factor = 100
		}	
		set_character_flag = dragon_intel_harrenhal
		prestige = 25
	}		
}
#summerhall intel
character_event = {
	id = dragon.65
	desc = "dragon_intel_summerhall_desc"
	picture = "GFX_fire_obsessed"
	min_age = 12
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		trait = dragon_egg
		NOT = { has_character_flag = dragon_intel_summerhall }
		has_global_flag = summerhall_established
		NOT = { trait = dragon_rider }
		location = {
			county = {
				title = c_summerhall
			}
		}
	}
	mean_time_to_happen = {
		days = 1
		
	}
	
	option = {
		name = "dragon_intel_summerhall_opt"
		ai_chance = {
			factor = 100
		}
		
		set_character_flag = dragon_intel_summerhall
		prestige = 25
	}		
}
#dragon eggs intel
character_event = {
	id = dragon.66
	desc = "dragon_intel_eggs_desc"
	picture = "GFX_targaryen_eggs"
	
	min_age = 6
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		trait = dragon_egg
		NOT = { has_character_flag = dragon_intel_eggs }
		NOT = { trait = dragon_rider }
	}
	
	mean_time_to_happen = {
		years = 8
		modifier = {
			factor = 0.75
			liege = { is_close_relative = ROOT trait = dragon_rider }
		}	
		modifier = {
			factor = 0.75
			liege = { dynasty = ROOT trait = dragon_rider }
		}	
		modifier = {
			factor = 0.5
			OR = {
				capital_holding = { has_building = ca_dragon_pit }
				family_palace = { has_building = fp_dragon_pit }
				AND = {
					is_ruler = no
					liege = { 
						OR = {
							capital_holding = { has_building = ca_dragon_pit }
							family_palace = { has_building = fp_dragon_pit }
						}
					}
				}
			} 
		}		
	}
	
	option = {
		name = "dragon_intel_eggs_opt"	
		set_character_flag = dragon_intel_eggs
		prestige = 10
	}		
}
#smoking sea intel
character_event = {
	id = dragon.6501
	desc = "dragon_intel_smoking_sea_desc"
	picture = "GFX_valyria_dragon"
	min_age = 12
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		trait = dragon_egg
		NOT = { has_character_flag = dragon_intel_smoking_sea }
		NOT = { trait = dragon_rider }
		location = {
			province_id = 1010
		}
	}
	
	mean_time_to_happen = {
		days = 7	
	}
	
	option = {
		name = "dragon_intel_smoking_sea_opt"	
		set_character_flag = dragon_intel_smoking_sea
		prestige = 10
	}		
}
#Old Ghis intel
character_event = {
	id = dragon.6502
	desc = "dragon_intel_old_ghis_desc"
	picture = "GFX_fieldoffire"
	min_age = 12
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		trait = dragon_egg
		NOT = { has_character_flag = dragon_intel_old_ghis }
		NOT = { trait = dragon_rider }
		location = {
			province_id = 619
		}
	}
	
	mean_time_to_happen = {
		days = 1		
	}
	
	option = {
		name = "dragon_intel_old_ghis_opt"
		set_character_flag = dragon_intel_old_ghis
		prestige = 10
	}		
}
#Volantis intel
character_event = {
	id = dragon.6503
	desc = "dragon_intel_volantis_desc"
	picture = GFX_evt_feast
	min_age = 12
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		trait = dragon_egg
		NOT = { has_character_flag = dragon_intel_volantis }
		NOT = { trait = dragon_rider }
		location = {
			province_id = 419
		}
	}
	
	mean_time_to_happen = {
		days = 1		
	}
	
	option = {
		name = "dragon_intel_volantis_opt"
		set_character_flag = dragon_intel_volantis
		prestige = 10
	}		
}
#Asshai intel
character_event = {
	id = dragon.6504
	desc = "dragon_intel_asshai_desc"
	picture = GFX_valyria_dragon
	min_age = 12
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		trait = dragon_egg
		NOT = { has_character_flag = dragon_intel_asshai }
		NOT = { trait = dragon_rider }
		location = {
			province_id = 795
		}
	}
	
	mean_time_to_happen = {
		days = 1		
	}
	
	option = {
		name = "dragon_intel_asshai_opt"
		set_character_flag = dragon_intel_asshai
		prestige = 10
	}		
}
#Dynamic intel
character_event = {
	id = dragon.6505
	desc = "dragon_intel_dynamic_desc"
	picture = "GFX_fieldoffire"
	min_age = 12
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		trait = dragon_egg
		NOT = { has_character_flag = dragon_intel_dynamic }
		NOT = { trait = dragon_rider }
		location = {
			has_province_flag = dragon_intel
		}
	}
	
	mean_time_to_happen = {
		days = 1		
	}
	
	option = {
		name = "dragon_intel_dynamic_opt"
		set_character_flag = dragon_intel_dynamic
		prestige = 10
	}		
}
#Rebirth intel
character_event = {
	id = dragon.6506
	desc = "dragon_intel_rebirth_desc"
	picture = GFX_valyria_dragon
	min_age = 12
	
	prisoner = no
	#only_playable = yes
	capable_only = yes
	
	trigger = {
		trait = dragon_egg
		NOT = { has_character_flag = dragon_intel_rebirth }
		NOT = { trait = dragon_rider }
		location = {
			has_province_flag = dragon_intel_rebirth
		}
	}
	
	mean_time_to_happen = {
		days = 1		
	}
	
	option = {
		name = "dragon_intel_rebirth_opt"
		set_character_flag = dragon_intel_rebirth
		prestige = 10
	}		
}
###Dragon Conquest CB###
#Dragon Conquest Surrender Demand
character_event = {
	id = dragon.67
	desc = "EVTDESCdragon.67"
	picture = "GFX_targaryen_balerion"
	#hide_from = yes
	is_triggered_only = yes
		
	immediate = {
		if = {
			limit = {
				tier = EMPEROR
				is_feudal = yes
				has_nickname = no
				age = 16
				is_female = no
				NOT = {
					any_playable_ruler = { has_nickname = the_king_who_knelt }
				}
			}
			random = {
				chance = 50
				set_character_flag = the_king_who_knelt
			}
		}
	}
	
	option = {
		name = "EVTOPTCdragon.67" #War invalid
		trigger = { 
			NOT = { war_with = FROM }
		}
		clr_character_flag = considering_surrender
		clr_character_flag = the_king_who_knelt
	}	
	
	option = {
		name = "EVTOPTAdragon.67" #Surrender
		trigger = {
			war_with = FROM
		}
		ai_chance = {
			factor = 20
			
			#Motives for surrender
			modifier = { 
				factor = 0				
				NOT = { relative_power = { who = FROM power = 0.5 } } #Powerful enemy
				FROM = { any_friend = { trait = dragon martial = 60 } } #Powerful dragon
				AND = { #Desirable liege
					NOT = { trait = proud }
					opinion = { who = FROM value = 25 }
					religion_group = FROM
					OR = {
						culture_group = FROM
						FROM = { culture = high_valyrian }
					}
				}
			}
			
			#Reason's to never surrender
			modifier = { 
				factor = 0
				OR = {
					government = alliance_government #Alliance
					has_landed_title = k_dorne #Dornish attrition/Braavosi resistance
					has_landed_title = e_dorne
					culture = braavosi
					NOT = { is_within_diplo_range = FROM } #far away
					capital_scope = { FROM = { capital_scope = { distance = { where = PREVPREV value = 1150 } } } }
					AND = { #I have my own powerful dragon
						trait = dragon_rider
						any_friend = { trait = dragon martial = 60 NOT = { trait = maimed } }
					}
					relative_power = { who = FROM power = 4 } #I am powerful
					AND = { #Ambitious/proud king
						higher_tier_than = DUKE
						has_regent = no
						trait = proud
						trait = ambitious
					}
					AND = { #Religious zeal
						trait = zealous
						NOT = { religion = FROM }
					}
				}	
			}
			modifier = { #Aegon's first conquest
				factor = 0
				has_global_flag = aegons_conquest
				NOT = { culture_group = free_cities }
				FROM = { NOT = { check_variable = { which = "kingdoms_conquered" value = 1 } } }
			}
			
			modifier = {
				factor = 1.5
				has_regent = yes
			}
			modifier = {
				factor = 2
				trait = content
			}
			modifier = {
				factor = 2
				trait = craven
			}
			modifier = {
				factor = 2
				trait = humble
			}
			modifier = {
				factor = 1.5
				trait = diligent
			}
			modifier = {
				factor = 1.5
				trait = patient
			}
			modifier = {
				factor = 1.5
				tier = COUNT
			}
			modifier = {
				factor = 1.5
				NOT = { relative_power = { who = FROM power = 0.8 } }	
			}
			modifier = {
				factor = 2
				NOT = { relative_power = { who = FROM power = 0.5 } }		
			}
			modifier = {
				factor = 2
				NOT = { relative_power = { who = FROM power = 0.25 } }		
			}
			modifier = {
				factor = 2
				NOT = { relative_power = { who = FROM power = 0.1 } }		
			}
			
			modifier = {
				factor = 1.5
				FROM = { check_variable = { which = "kingdoms_conquered" value = 1 } }
			}
			modifier = {
				factor = 1.5
				FROM = { check_variable = { which = "kingdoms_conquered" value = 2 } }
			}
			modifier = {
				factor = 1.5
				FROM = { check_variable = { which = "kingdoms_conquered" value = 3 } }
			}
			modifier = {
				factor = 1.5
				FROM = { check_variable = { which = "kingdoms_conquered" value = 4 } }
			}
			
			##Take into account dragon size
			modifier = {
				factor = 2
				FROM = {				
					any_friend = {
						trait = dragon
						martial = 80
					}	
				}	
			}
		}
		clr_character_flag = considering_surrender
		any_war = {
			if = {
				limit = {
					using_cb = dragon_conquest
					defender = { character = ROOT }
					attacker = { character = FROM }
				}	
				thirdparty_title_scope = { set_title_flag = war_title }
				end_war = invalid
			}	
		}
		if = {
			limit = {
				higher_tier_than = DUKE
			}
			prestige = -150
		}	
		if = {
			limit = {
				tier = DUKE
			}
			prestige = -75
		}
		if = {
			limit = {
				tier = COUNT
			}
			prestige = -40
		}
		if = {
			limit = { has_character_flag = the_king_who_knelt }
			give_nickname = the_king_who_knelt
			clr_character_flag = the_king_who_knelt
		}
		any_realm_lord = {
			if = {
				limit = {
					liege = { character = ROOT }
					OR = {
						trait = proud
						trait = wroth
						trait = brave
					}
				}
				opinion = {
					who = ROOT
					modifier = opinion_surrendered
					years = 10
				}
			}	
			if = {
				limit = { ai = no }
				hidden_tooltip = { character_event = { id = dragon.682 } }
			}	
		}
		tooltip = { #Effects are applied in attacker's event
			if = {
				limit = { is_nomadic = yes } #nomads pay tribute
				custom_tooltip = {
					text = "REMOVE_PREVIOUS_SUZERAIN"
				}
				FROM = { make_tributary = { who = ROOT percentage = 0.4 } }
				any_vassal = { #lose any non-nomad vassals
					limit = {
						is_nomadic = no
						NOT = { tier = BARON }
						lower_tier_than = FROM
					}
					set_defacto_liege = FROM
				}
			}
			if = {
				limit = { is_nomadic = no }
				if = {
					limit = { FROM = { tier = EMPEROR } }		 
					if = {
						limit = { tier = EMPEROR }
						any_vassal = {
							limit = { tier = KING }
							if = {
								limit = { FROM = { trait = civil_war } }
								custom_tooltip = { text = TOOLTIPdejure_kingdom_EMP_vassal }
							}
							if = {
								limit = { FROM = { NOT = { trait = civil_war } } }
								character_event = { id = maintenance.36 days = 1 tooltip = EVTTOOLTIPmaintenance.36 }
							}	
						}
						if = { 	limit = { primary_title = { title = e_north } }
								k_north = { custom_tooltip = { text = TOOLTIPdragon_conquest_surrender_EMP } }
						}
						if = { 	limit = { primary_title = { title = e_riverlands } }
								k_riverlands  = { custom_tooltip = { text = TOOLTIPdragon_conquest_surrender_EMP } }
						}
						if = { 	limit = { primary_title = { title = e_vale } }
								k_vale = { custom_tooltip = { text = TOOLTIPdragon_conquest_surrender_EMP } }
						}
						if = { 	limit = { primary_title = { title = e_westerlands } }
								k_westerlands = { custom_tooltip = { text = TOOLTIPdragon_conquest_surrender_EMP } }
						}
						if = { 	limit = { primary_title = { title = e_reach } }
								k_reach = { custom_tooltip = { text = TOOLTIPdragon_conquest_surrender_EMP } }
						}
						if = { 	limit = { primary_title = { title = e_stormlands } }
								k_stormlands = { custom_tooltip = { text = TOOLTIPdragon_conquest_surrender_EMP } }
						}
						if = { 	limit = { primary_title = { title = e_dorne } }
								k_dorne = { custom_tooltip = { text = TOOLTIPdragon_conquest_surrender_EMP } }
						}
						if = { 	limit = { primary_title = { title = e_iron_isles } }
								k_iron_isles = { custom_tooltip = { text = TOOLTIPdragon_conquest_surrender_EMP } } 
						}
					}	
				}
				if = {
					limit = { FROM = { tier = KING } }
					if = {
						limit = { higher_tier_than = DUKE }
						any_demesne_title = {
							limit = { higher_tier_than = DUKE }
							usurp_title = { target = FROM type = invasion }
						}
					}	
				}	
				if = {
					limit = { FROM = { tier = DUKE } }
					if = {
						limit = { higher_tier_than = COUNT }
						any_demesne_title = {
							limit = { higher_tier_than = COUNT }
							usurp_title = { target = FROM type = invasion }
						}
					}	
				}	
				if = {
					limit = { FROM = { tier = COUNT } }
					if = {
						limit = { higher_tier_than = BARON } 
						any_demesne_title = {
							limit = { higher_tier_than = BARON }
							usurp_title = { target = FROM type = invasion }
						}
					}	
				}
				set_defacto_liege = FROM
			}	
		}	
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_SURRENDERED_TO_DRAGON
				portrait = [From.GetID]
			}
		}
		event_target:chronicle_player = {
			if = {
				limit = {
					OR = {		
						dynasty = ROOT
						is_liege_or_above = ROOT
						is_close_relative = ROOT
					}
					NOR = {	
						character = ROOT
						character = FROM
						dynasty = FROM
						is_close_relative = FROM
					}
				}
				chronicle = {
					entry = CHRONICLE_SURRENDERED_TO_DRAGON
					portrait = [Root.GetID]
				}
			}
		}
		FROM = {
			hidden_tooltip = { letter_event = { id = dragon.68 } }
		}
	}
	
	option = {
		name = "EVTOPTBdragon.67" #Never!
		trigger = {
			war_with = FROM
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.2
				martial = 15
			}
			modifier = {
				factor = 1.2
				martial = 18
			}
			modifier = {
				factor = 1.2
				martial = 21
			}
			modifier = {
				factor = 1.2
				martial = 24
			}
			modifier = {
				factor = 2.5
				trait = ambitious
			}
			modifier = {
				factor = 2.5
				trait = brave
			}
			modifier = {
				factor = 2.5
				trait = proud
			}
			modifier = {
				factor = 2
				trait = zealous
			}
			modifier = {
				factor = 2
				trait = wroth
			}
			modifier = {
				factor = 1.5
				tier = KING
			}
			modifier = {
				factor = 2
				tier = EMPEROR
			}
			modifier = {
				factor = 2
				relative_power = { who = FROM power = 2 }
			}
			modifier = {
				factor = 3
				relative_power = { who = FROM power = 3 }	
			}
			modifier = {
				factor = 1.5
				FROM = { NOT = { check_variable = { which = "kingdoms_conquered" value = 1 } } }
			}
				
			##Take into account dragon size
			modifier = {
				factor = 2
				FROM = {
					NOT = {					
						any_friend = {
							trait = dragon
							martial = 20
						}	
					}
				}	
			}
			modifier = {
				factor = 1.5
				FROM = {
					NOT = {					
						any_friend = {
							trait = dragon
							martial = 40
						}	
					}
				}	
			}
			
			##I have my own dragon
			modifier = {
				factor = 1.5
				trait = dragon_rider
				any_friend = { trait = dragon martial = 20 NOT = { trait = maimed } }
			}
			modifier = {
				factor = 1.5
				trait = dragon_rider
				any_friend = { trait = dragon martial = 40 NOT = { trait = maimed } }
			}
		}
		clr_character_flag = the_king_who_knelt
		clr_character_flag = considering_surrender
		hidden_tooltip = { FROM = { character_event = { id = mega_wars.1 } } }
	}	
}
#Inform Surrender
letter_event = {
	id = dragon.68
	desc = "EVTDESCdragon.68"

	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_DRAGON_CONQUEST_SURRENDER
				portrait = [From.GetID]
			}
		}
		event_target:chronicle_player = {
			if = {
				limit = {
					NOT = { character = ROOT }
					OR = {		
						dynasty = ROOT
						is_liege_or_above = ROOT
						is_close_relative = ROOT
					}
				}
				chronicle = {
					entry = CHRONICLE_DRAGON_CONQUEST_SURRENDER
					portrait = [From.GetID]
				}
			}
		}
		hidden_tooltip = { 
			remove_character_modifier = dragon_conquest_no_levies 
			if = {
				limit = { 
					FROM = { 
						OR = {
							tier = EMPEROR
							tier = KING
						}
					} 
				}
				if = {
					limit = { NOT = { check_variable = { which = "kingdoms_conquered" value = 0 } } }
					set_variable = { which = "kingdoms_conquered" value = 1 }
				}
				if = {
					limit = { check_variable = { which = "kingdoms_conquered" value = 0 } } 
					change_variable = { which = "kingdoms_conquered" value = 1 }
				}
				if = {
					limit = { has_global_flag = aegons_conquest } 
					character_event = { id = aegons_landing.4 days = 2 }
					character_event = { id = aegons_landing.5 days = 2 }
					narrative_event = { id = aegons_landing.9 days = 2 }
					character_event = { id = aegons_landing.410 days = 2 }
					narrative_event = { id = aegons_landing.90 days = 2 }
				}
			}
		}
	}
		
	option = {
		name = "EVTOPTAdragon.68" 
		if = {
			limit = {
				FROM = { 
					OR = {
						tier = KING
						tier = EMPEROR
					}	
				}
			}
			prestige = 300
		}	
		if = {
			limit = {
				FROM = { tier = DUKE }
			}
			prestige = 150
		}
		if = {
			limit = {
				FROM = { tier = COUNT }
			}
			prestige = 80
		}
		if = {
			limit = { FROM = { is_nomadic = yes } } #nomads pay tribute
			FROM = {
				custom_tooltip = {
					text = "REMOVE_PREVIOUS_SUZERAIN"
					hidden_tooltip = {
						any_suzerain = {
							FROM = {
								remove_tributary = PREV
							}
						}
					}
				}
			}
			ROOT = { make_tributary = { who = FROM percentage = 0.4 } }
			FROM = { #lose any non-nomad vassals
				any_vassal = {
					limit = {
						is_nomadic = no
						NOT = { tier = BARON }
						lower_tier_than = ROOT
					}
					set_defacto_liege = ROOT
					hidden_tooltip = { character_event = { id = maintenance.25 } }#Subjugation flag maintenance
				}
			}
		}
		hidden_tooltip = {
			FROM = {
				remove_trait = rebel_leader
				if = {
					limit = { is_nomadic = no }
					if = { #end all revolts
						limit = { primary_title = { NOT = { lower_tier_than = ROOT } } }
						any_war = {
							if = { 
								limit = { 
									attacker = { 
										liege_before_war = { character = PREVPREVPREV }
										NOT = { character = ROOT }
									} 
								}
								end_war = invalid
							}
						}
					}
				}
			}	
		}
		if = {
			limit = { FROM = { is_nomadic = no } }
			if = {
				limit = { ROOT = { tier = EMPEROR } }
				if = {
					limit = { FROM = { tier = EMPEROR } }
					FROM = {
						if = {
							limit = { ROOT = { tier = EMPEROR } }
							any_vassal = {
								limit = { tier = KING }
								if = {
									limit = { ROOT = { trait = civil_war } }
									set_character_flag = neutral
									custom_tooltip = { text = TOOLTIPdejure_kingdom_EMP_vassal }
									hidden_tooltip = { character_event = { id = mega_wars.52 } }
								}
								if = {
									limit = { ROOT = { NOT = { trait = civil_war } } }
									character_event = { id = mega_wars.52 tooltip = EVTTOOLTIPmega_wars.52 }
								}	
							}
						}	
						if = { 	limit = { primary_title = { title = e_north } }
								k_north = { custom_tooltip = { text = TOOLTIPdejure_kingdom_claim_EMP_success } }
						}
						if = { 	limit = { primary_title = { title = e_riverlands } }
								k_riverlands  = { custom_tooltip = { text = TOOLTIPdejure_kingdom_claim_EMP_success } }
						}
						if = { 	limit = { primary_title = { title = e_vale } }
								k_vale = { custom_tooltip = { text = TOOLTIPdejure_kingdom_claim_EMP_success } }
						}
						if = { 	limit = { primary_title = { title = e_westerlands } }
								k_westerlands = { custom_tooltip = { text = TOOLTIPdejure_kingdom_claim_EMP_success } }
						}
						if = { 	limit = { primary_title = { title = e_reach } }
								k_reach = { custom_tooltip = { text = TOOLTIPdejure_kingdom_claim_EMP_success } }
						}
						if = { 	limit = { primary_title = { title = e_stormlands } }
								k_stormlands = { custom_tooltip = { text = TOOLTIPdejure_kingdom_claim_EMP_success } }
						}
						if = { 	limit = { primary_title = { title = e_dorne } }
								k_dorne = { custom_tooltip = { text = TOOLTIPdejure_kingdom_claim_EMP_success } }
						}
						if = { 	limit = { primary_title = { title = e_iron_isles } }
								k_iron_isles = { custom_tooltip = { text = TOOLTIPdejure_kingdom_claim_EMP_success } } 
						}
						tooltip = { set_defacto_liege = ROOT }
						hidden_tooltip = { character_event = { id = maintenance.20 } } #This event takes the defeated King's title and reorganises them
					}
				}
				if = {
					limit = { FROM = { NOT = { tier = EMPEROR } } }
					FROM = { 
						set_defacto_liege = ROOT
					}
				}	
			}
			if = {
				limit = { ROOT = { tier = KING } }
				if = {
					limit = { FROM = { higher_tier_than = DUKE } } 
					FROM = { 
						if = {
							limit = { government = alliance_government } #disband alliance
							set_character_flag = conquest
							character_event = { id = free_cities.15 tooltip = TOOLTIPfree_cities.15 } 
						}
						any_demesne_title = {
							limit = { 
								higher_tier_than = DUKE 
							}
							usurp_title = { target = ROOT type = invasion }
						}
						set_defacto_liege = ROOT
					}
				}	
				if = {
					limit = { FROM = { NOT = { higher_tier_than = DUKE } } }
					FROM = { set_defacto_liege = ROOT }
				}
			}	
			if = {
				limit = { ROOT = { tier = DUKE } }
				if = {
					limit = { FROM = { higher_tier_than = COUNT } } 
					FROM = { 
						any_demesne_title = {
							limit = { higher_tier_than = COUNT }
							usurp_title = { target = ROOT type = invasion }
						}
						set_defacto_liege = ROOT
					}
				}
				if = {
					limit = { FROM = { NOT = { higher_tier_than = COUNT } } }
					FROM = { set_defacto_liege = ROOT }
				}
			}	
			if = {
				limit = { ROOT = { tier = COUNT } }
				if = {
					limit = { FROM = { higher_tier_than = BARON } } 
					FROM = { 
						any_demesne_title = {
							limit = { higher_tier_than = BARON }
							usurp_title = { target = ROOT type = invasion }
						}
						set_defacto_liege = ROOT
					}
				}
				if = {
					limit = { FROM = { NOT = { higher_tier_than = BARON } } }
					FROM = { set_defacto_liege = ROOT }
				}
			}
			ROOT = {
				if = {
					limit = {
						check_variable = { which = "kingdoms_conquered" value = 5 }
						has_nickname = no
					}
					give_nickname = nick_the_conqueror
				}
			}
			hidden_tooltip = {
				FROM = {
					if = {
						limit = { is_liege_or_above = ROOT }
						character_event = { id = maintenance.25 } #Subjugation flag maintenance
					}	
				}
				ROOT = { 			
					character_event = { id = maintenance.24 } #Mega war flag maintenance
					character_event = { id = maintenance.21 } #Take dejure vassals (AGOT)
				} 
				FROM = { character_event = { id = diplomatic.51 days = 2 } } #destroy redundant kingdoms
				random_demesne_title = {
					limit = { has_title_flag = war_title }
					if = {
						limit = { #Lose crownlands
							title = e_iron_throne 
							FROM = { has_claim = PREV }
						} 
						holder_scope = { character_event = { id = maintenance.37 } }
					}
					clr_title_flag = war_title
				}	
			}
		}	
	}
}	
#Inform vassal of Surrender
character_event = {
	id = dragon.682
	desc = "EVTDESCdragon.682"

	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.682" 		
		FROM = { FROM = { tooltip = { } } }
	}
}
#Inform defender dies with no heir
character_event = {
	id = dragon.69
	desc = "EVTDESCdragon.69"

	is_triggered_only = yes
	
	only_rulers = yes
	
	trigger = {
		NOT = { trait = dragon_rider }
		OR = {
			is_tribal = yes
			is_feudal = yes
		}	
		any_war = {
			using_cb = dragon_conquest
			attacker = { trait = dragon_rider }
			defender = { character = ROOT }
		}	
		current_heir = {
			OR = {
				AND = {
					is_female = yes
					NOT = { 
						ROOT = { 
							primary_title = {
								OR = {
									has_law = true_cognatic_succession 
									has_law = enatic_succession
									has_law = enatic_cognatic_succession
								}	
							} 
						} 
					}
				}	
				NOT = { dynasty = ROOT }
			}
		}
	}
	
	immediate = {
		if = {
			limit = { ai = no }
			current_heir = { set_character_flag = banish_me }
		}
		if = {
			limit = { ai = yes }
			any_war = {
				if = {
					limit = {
						#using_cb = dragon_conquest
						attacker = { trait = dragon_rider }
						defender = { character = ROOT }
					}
					#end_war = success
					attacker = {
						ROOT = {
							if = {
								limit = { ai = no }
								chronicle = {
									entry = CHRONICLE_DRAGON_CONQUEST_NO_HEIR
									portrait = [Prev.GetID]
								}
							}
						}	
						event_target:chronicle_player = {
							if = {
								limit = {
									OR = {		
										dynasty = ROOT
										is_liege_or_above = ROOT
										is_close_relative = ROOT
									}
									NOR = {	
										character = ROOT
										character = PREV
										dynasty = PREV
										is_close_relative = PREV
									}
								}
								chronicle = {
									entry = CHRONICLE_DRAGON_CONQUEST_NO_HEIR
									portrait = [Prev.GetID]
								}
							}
						}
						if = {
							limit = { ROOT = { tier = EMPEROR } }
							set_character_flag = king_has_died
						}
						ROOT = {
							any_courtier = {
								limit = { dynasty = ROOT }
								set_character_flag = banish_me
							}
							if = {
								limit = {
									PREV = { has_landed_title = e_iron_throne }
								}
								any_vassal = {
									set_defacto_liege = PREVPREV
								}
								any_demesne_title = {
									limit = { 
										tier = EMPEROR 
										OR = {
											capital_scope = { region = world_westeros }
											title = e_iron_isles #These titles dont have capitals
											title = e_riverlands
										}
									}
									destroy_landed_title = ROOT
								}	
								any_demesne_title = {
									limit = { NOT = { tier = EMPEROR } }
									usurp_title = { target = PREVPREV type = invasion }
								}	
							}
							if = {
								limit = {
									NOT = { PREV = { has_landed_title = e_iron_throne } }
								}	
								any_demesne_title = {
									usurp_title = { target = PREVPREV type = invasion }
								}	
							}						
						}	
						character_event = { id = dragon.70 }
					}	
				}	
			}
		}	
	}
	
	option = {
		name = "EVTOPTAdragon.69" 
		if = {
			limit = { ai = no }
			any_war = {
				if = {
					limit = {
						#using_cb = dragon_conquest
						attacker = { trait = dragon_rider }
						defender = { has_character_flag = banish_me }
					}
					ROOT = {
						if = {
							limit = { ai = no }
							chronicle = {
								entry = CHRONICLE_DRAGON_CONQUEST_NO_HEIR
								portrait = [Prev.GetID]
							}
						}
					}	
					event_target:chronicle_player = {
						if = {
							limit = {
								OR = {		
									dynasty = ROOT
									is_liege_or_above = ROOT
									is_close_relative = ROOT
								}
								NOR = {	
									character = ROOT
									character = PREV
									dynasty = PREV
									is_close_relative = PREV
								}
							}
							chronicle = {
								entry = CHRONICLE_DRAGON_CONQUEST_NO_HEIR
								portrait = [Prev.GetID]
							}
						}
					}
					#end_war = success
					attacker = {
						if = {
							limit = { ROOT = { tier = EMPEROR } }
							set_character_flag = king_has_died
						}
						random_playable_ruler = {
							limit = {
								dynasty = ROOT
								has_character_flag = banish_me
							}
							any_courtier = {
								limit = { dynasty = ROOT }
								set_character_flag = banish_me
							}
							if = {
								limit = {
									PREV = { has_landed_title = e_iron_throne }
								}
								any_vassal = {
									set_defacto_liege = PREVPREV
								}
								any_demesne_title = {
									limit = { 
										tier = EMPEROR 
										OR = {
											capital_scope = { region = world_westeros }
											title = e_iron_isles #These titles dont have capitals
											title = e_riverlands
										}
									}
									destroy_landed_title = ROOT
								}	
								any_demesne_title = {
									limit = { NOT = { tier = EMPEROR } }
									usurp_title = { target = PREVPREV type = invasion }
								}	
							}
							if = {
								limit = {
									NOT = { PREV = { has_landed_title = e_iron_throne } }
								}	
								any_demesne_title = {
									usurp_title = { target = PREVPREV type = invasion }
								}	
							}						
						}
						
						character_event = { id = dragon.70 }
					}	
				}	
			}
		}	
	}
}	
#Inform defender dies with no heir
character_event = {
	id = dragon.70
	desc = "EVTDESCdragon.70"

	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAdragon.70" 
		any_realm_character = {
			limit = {
				dynasty = FROM
				has_character_flag = banish_me
			}
			ROOT = { reverse_banish = PREV }
			clr_character_flag = banish_me
		}
		any_independent_ruler = {
			any_realm_character = {
				limit = {
					dynasty = FROM
					has_character_flag = banish_me
				}
				ROOT = { reverse_banish = PREV }
				clr_character_flag = banish_me
			}
		}
		if = {
			limit = { ROOT = { tier = EMPEROR } }	
			if = {
				limit = { has_character_flag = king_has_died }
				hidden_tooltip = {
					ROOT = {
						if = {
							limit = { NOT = { check_variable = { which = "kingdoms_conquered" value = 0 } } }
							set_variable = { which = "kingdoms_conquered" value = 1 }
						}
						if = {
							limit = { check_variable = { which = "kingdoms_conquered" value = 0 } } 
							change_variable = { which = "kingdoms_conquered" value = 1 }
						}
						if = {
							limit = { has_global_flag = aegons_conquest } 
							character_event = { id = aegons_landing.4 days = 1 }
							character_event = { id = aegons_landing.5 days = 1 }
							narrative_event = { id = aegons_landing.6 days = 1 }
							narrative_event = { id = aegons_landing.61 days = 1 }
							narrative_event = { id = aegons_landing.9 days = 1 }
						}
					}	
				}
			}
		}
		ROOT = {
			if = {
				limit = {
					check_variable = { which = "kingdoms_conquered" value = 5 }
					NOT = { has_nickname = nick_the_conqueror }
				}
				give_nickname = nick_the_conqueror
			}
		}
		if = {
			limit = {
				has_character_flag = king_has_died
			}
			prestige = 300
			clr_character_flag = king_has_died
		}
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_DRAGON_CONQUEST_NO_HEIR_WINNER
				portrait = [From.GetID]
			}
		}	
		event_target:chronicle_player = {
			if = {
				limit = {
					NOT = { character = ROOT }
					OR = {		
						dynasty = ROOT
						is_liege_or_above = ROOT
						is_close_relative = ROOT
					}
				}
				chronicle = {
					entry = CHRONICLE_DRAGON_CONQUEST_NO_HEIR_WINNER
					portrait = [From.GetID]
				}
			}
		}		
	}
}
###Feed to Dragon on execution?###
character_event = {
	id = dragon.71
	desc = "EVTDESCdragon.71"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes	
	
	option = {
		name = "EVTOPTAdragon.71"  #Feed
		ai_chance = {
			factor = 30 #included lunatic
			modifier = {
				factor = 20
				trait = cruel
			}
			modifier = {
				factor = 5
				trait = impaler
			}
			modifier = {
				factor = 3
				trait = wroth
			}
			modifier = {
				factor = 3
				trait = arbitrary
			}
			modifier = {
				factor = 3
				trait = possessed
			}
			modifier = {
				factor = 3
				trait = paranoid
			}
			modifier = { #kind does not cancel out the crazy
				factor = 0.2
				trait = kind
			}
			modifier = {
				factor = 3
				religion = valyrian
			}
		}
		piety = -25
		if = {
			limit = { NOT = { trait = cruel } }
			random = {
				chance = 25
				add_trait = cruel
				hidden_tooltip = {
					character_event ={
						id = 38259 #Notify Cruel
					}
				}
			}
		}
		FROM = {
			add_trait = fed_to_dragon
			hidden_tooltip = {
				if = { 
					limit = { 
						father = { 
							NOT = { character = ROOT } 
							is_alive = yes 
						}  		
					}
					father = {
						character_event = { id = dragon.72 days = 1 }
					}
				}
				if = {
					limit = { 
						mother = { 
							NOT = { character = ROOT } 
							is_alive = yes 
						} 
					}
					mother = {
						character_event = { id = dragon.72 days = 1 }
					}
				}
				any_dynasty_member = {
					limit = { 
						is_close_relative = FROM  
						NOT = { any_child = { character = FROM } }
						NOT = { character = ROOT }  
					}
					character_event = { id = dragon.72 days = 1 }
				}	
				spouse = {
					if = { 
						limit = { 
							NOT = { character = ROOT } 
							is_alive = yes
							OR = {
								NOT = { dynasty = FROM }
								NOT = { is_close_relative = FROM }
							}
						}
						character_event = { id = dragon.72 days = 1 }
					}
				}
			}	
		}	
	}
	
	option = {
		name = "EVTOPTB999900081"  #mercy
		ai_chance = {
			factor = 95
			modifier = {
				factor = 0.2
				trait = cruel
			}
			modifier = {
				factor = 10
				trait = kind
			}
			modifier = {
				factor = 2
				trait = patient
			}
			modifier = {
				factor = 2
				trait = just
			}
			modifier = {
				factor = 2
				trait = trusting
			}
			modifier = {
				factor = 0.2
				religion = rhllor
			}
		}
	}
}
#Inform relative
character_event = {
	id = dragon.72
	desc = "EVTDESCdragon.72"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes	
	
	option = {
		name = "EVTOPTA999900082" 		
		FROM = { FROM = { tooltip = { } } }
	}
}
###Show me the dragons###
character_event = {
	id = dragon.73
	desc = "EVTDESCdragon.73"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes	
	
	trigger = { has_character_flag = show_me_the_dragons }
	
	option = {
		name = "EVTOPTAdragon.73" #Dragon Riders
		custom_tooltip = { text = TOOLTIPGETDRAGONRIDERS }
		any_character = {
			limit = { 
				trait = dragon
				is_alive = yes
				any_friend = {
					is_alive = yes
					trait = dragon_rider
				}
			}
			tooltip = { }
			random_friend = { character_event = { id = dragon.73 days = 1 tooltip = TOOLTIPGETNAME } }	
		}
		clr_character_flag = show_me_the_dragons
	}
	option = {
		name = "EVTOPTBdragon.73" #Untamed Dragon
		custom_tooltip = { text = TOOLTIPGETUNTAMEDDRAGONS }
		any_character = {
			limit = { 
				trait = dragon
				is_alive = yes
				any_friend = {
					is_alive = yes
					NOT = { trait = dragon_rider }
				}
			}
			tooltip = { }
			random_friend = { character_event = { id = dragon.73 days = 1 tooltip = TOOLTIPGETNAME } }
		}
		clr_character_flag = show_me_the_dragons
	}
	option = {
		name = "EVTOPTCdragon.73" #Wild Dragon
		custom_tooltip = { text = TOOLTIPGETWILDDRAGONS }
		any_character = {
			limit = {
				trait = dragon
				is_alive = yes
				NOT = { any_friend = { is_alive = yes } }
			}
			tooltip = { }
			custom_tooltip = { text = TOOLTIPGETWILDDRAGON }
		}
	}
	option = {
		name = "EVTOPTDdragon.73" #Dragon Egg
		custom_tooltip = { text = TOOLTIPGETDRAGONEGGS }
		any_character = {
			limit = { 
				trait = dragon_egg 
				is_alive = yes
			}
			tooltip = { }
			character_event = { id = dragon.73 days = 1 tooltip = TOOLTIPGETNAMEEGG }	
		}
		clr_character_flag = show_me_the_dragons		
	}
}
###AI dragon rider takes to the field###
character_event = {
	id = dragon.74
	desc = "AI_dragon.74"

	capable_only = yes
	prisoner = no
	min_age = 14
	ai = yes
	
	trigger = {
		trait = dragon_rider
		in_command = no
		any_friend = { 
			trait = dragon		
			is_alive = yes 
			NOT = { trait = maimed_dragon }
			OR = {
				martial = 20
				AND = {
					martial = 10
					ROOT = {
						OR = {
							has_job_title = job_marshal
							martial = 24
							trait = skilled_warrior
							trait = master_warrior
						}
					}
				}
			}
		}
		OR = {
			AND = {
				war = yes
				OR = {
					is_primary_war_attacker = yes
					is_primary_war_defender = yes
					independent = yes
				}
			}	
			AND = {
				is_ruler = no
				liege = { 
					war = yes 
					ai = yes
					OR = {
						is_primary_war_attacker = yes
						is_primary_war_defender = yes
						independent = yes
					}
				}
			}
		}
		
		OR = {
			is_female = no
			AND = {
				is_female = yes
				liege = { 
					OR = {
						culture = kayakayanayan
						culture = samyrianan
						culture = bayasabhadi	
						culture = sarnorian				
					}
				}
			}
			AND = {
				OR = {
					trait = wildling
					culture = moon_clansman				
				}
				liege = { culture = ROOT }
			}
			martial = 24
			trait = skilled_warrior
			trait = master_warrior
			has_job_title = job_marshal
			trait = brave
		}
		
		NOT = { trait = declared_incapable }
		NOT = { trait = in_hiding }
		NOT = { trait = wikid }
		NOT = { trait = salt_wife }
		NOT = { trait = on_reaving }
		NOT = { trait = slave }
		NOT = { trait = maester }
		NOT = { trait = archmaester }
		
		NOT = { trait = crippled }
		NOT = { trait = infirm }
		NOT = { trait = maimed }
		NOT = { trait = blinded }
		NOT = { trait = blinded_age }
		is_ill = no
			
		OR = {
			NOT = { has_character_flag = sent_back_to_field }
			had_character_flag = { flag = sent_back_to_field days = 200 }
		}	
	}
	
	option = {
		name = "ai event" 
		set_character_flag = sent_back_to_field
		if = {
			limit = {
				NOT = { has_job_title = job_marshal }
				NOT = { has_minor_title = title_commander }
			}
			give_minor_title = title_commander
		}
		cancel_job_action = yes
		if = { #If in an unknown location spawn in an existing army
			limit = {
				is_ruler = no
				liege = { NOT = { demesne_size = 1 } }
			}
			liege = {
				random_courtier = {
					limit = { in_command = yes }
					location = {
						ROOT = {
							spawn_unit = {
								province = PREV
								leader = ROOT
								scaled_by_biggest_garrison = 0.5
								troops = {
									archers = { 50 50 }
									heavy_infantry = { 160 160 }
									light_infantry = { 220 220 }	
									light_cavalry = { 40 40 }		
									knights = { 30 30 }						
								}
								match_min = 100
								match_max = 500
								attrition = 1.0
								earmark = dragon_unit
								disband_on_peace = yes
							}
							break = yes
						}
					}
				}
			}
		}	
		location = {
			ROOT = {
				spawn_unit = {
					province = PREV
					leader = ROOT
					scaled_by_biggest_garrison = 0.5
					troops = {
						archers = { 50 50 }
						heavy_infantry = { 160 160 }
						light_infantry = { 220 220 }	
						light_cavalry = { 40 40 }		
						knights = { 30 30 }						
					}
					match_min = 100
					match_max = 500
					attrition = 1.0
					earmark = dragon_unit
					disband_on_peace = yes
				}
			}	
		}
	}	
}
# #AI dragon rider goes home
# character_event = {
	# id = dragon.75
	# desc = "AI_dragon.75"

	# capable_only = yes
	# prisoner = no
	# hide_window = yes
	
	# trigger = {
		# trait = dragon_rider
		# #ai = yes
		# has_character_flag = sent_back_to_field
		# NOT = {
			# OR = {
				# AND = {
					# war = yes
					# OR = {
						# is_primary_war_attacker = yes
						# is_primary_war_defender = yes
						# independent = yes
					# }
				# }	
				# AND = {
					# is_ruler = no
					# liege = { 
						# war = yes 
						# ai = yes
						# OR = {
							# is_primary_war_attacker = yes
							# is_primary_war_defender = yes
							# independent = yes
						# }
					# }
				# }
			# }
		# }		
	# }
	
	# option = {
		# name = "ai event" 
		# clr_character_flag = sent_back_to_field
		# if = {
			# limit = { is_ruler = yes }
			# disband_event_forces = dragon_unit
		# }	
		# if = {
			# limit = { is_ruler = no }
			# liege = { disband_event_forces = dragon_unit }
		# }		
	# }	
# }
###Age of dragons begins###
narrative_event = {
	id = dragon.76
	desc = "EVTDESCdragon.76"
	title = "EVTNAMEdragon.76"
	picture = "GFX_fieldoffire"
	
	is_triggered_only = yes
	
	major = yes
	
	trigger = {
		dragon = {
			is_alive = yes
			NOT = { has_character_flag = shadow_lands_dragon }
			count = 4						
		}
	}
	
	option = {
		name = "EVTOPTAdragon.76"
		trigger = { trait = dragon_rider }
	}	
	
	option = {
		name = "EVTOPTBdragon.76"
		trigger = { NOT = { trait = dragon_rider } }
	}
}
#age of dragons ends
narrative_event = {
	id = dragon.77
	desc = "EVTDESCdragon.77"
	title = "EVTNAMEdragon.77"
	picture = "GFX_targaryen_hatching"
	
	is_triggered_only = yes
	
	major = yes
	hide_from = yes
	
	option = {
		name = "OK"
	}
}
#Random dragon appears in shadowlands
province_event = { 
	id = dragon.78
	
	hide_window = yes
	
	trigger = {
		has_global_flag = age_of_dragons
		OR = {
			province_id = 801
			province_id = 802
			province_id = 803
			province_id = 804
			province_id = 805
			province_id = 806
		}
	}	
	
	mean_time_to_happen = {
		years = 300
		modifier = {
			factor = 3
			dragon = {
				location = { province_id = ROOT }
				is_alive = yes
				NOT = { any_friend = { always = yes } }
			}
		}
	}
	
	option = {
		name = "Ok"
		create_character = {
			dynasty = culture
			age = 5
			culture = dragon
			religion = dragon_rel
		}
		new_character = {
			#dynasty = mother_bastard
			add_trait = dragon
			change_martial = 5
			set_character_flag = shadow_lands_dragon
			random = {
				chance = 5
				add_trait = fair
			}
			random = {
				chance = 5
				if = {
					limit = { NOT = { trait = fair } }
					add_trait = ugly
				}	
			}
			random = {
				chance = 5
				add_trait = strong
			}
			random_list = {
				1 = { add_trait = dragon_1 }
				1 = { add_trait = dragon_2 }
				1 = { add_trait = dragon_3 }
				1 = { add_trait = dragon_4 }
				1 = { add_trait = dragon_5 }
				1 = { add_trait = dragon_6 }
				1 = { add_trait = dragon_7 }
				1 = { add_trait = dragon_8 }
				1 = { add_trait = dragon_9 }
				1 = { add_trait = dragon_10 }
				1 = { add_trait = dragon_11 }
				1 = { add_trait = dragon_12 }
				1 = { add_trait = dragon_13 }
				1 = { add_trait = dragon_14 }
				1 = { add_trait = dragon_15 }
				1 = { add_trait = dragon_16 }
				1 = { add_trait = dragon_17 }
				1 = { add_trait = dragon_18 }
				1 = { add_trait = dragon_19 }
				1 = { add_trait = dragon_20 }
				1 = { add_trait = dragon_21 }
				1 = { add_trait = dragon_22 }
				1 = { add_trait = dragon_23 }
				1 = { add_trait = dragon_24 }
				1 = { add_trait = dragon_25 }
				1 = { add_trait = dragon_26 }
			}
			character_event = { id = dragon.1599 }
		}
		# add_province_modifier = {
			# name = dragon_lair
			# duration = 75000
		# }
	}
}
#Storming of Dragonpit during Peasant Revolt
province_event = { 
	id = dragon.79
	title = EVTNAMEdragon.79
	desc = EVTDESCdragon.79
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	trigger = {
		owner = {
			top_liege = {
				war = yes					
				any_war = {
					defender = { character = PREV }
					AND = {
						using_cb = peasant_revolt
						war_title = ROOT # The county
					}
				}
			}
		}
		dragon = {
			is_alive = yes
			location = { province_id = ROOT }
			NOT = { any_friend = { in_command = yes } }
			NOT = { martial = 60 }
		}
		any_province_lord = {
			any_demesne_title = {
				tier = BARON
				OR = {
					AND = {
						has_building = ca_dragon_pit 
						location = { province_id = ROOT }
					}	
					AND = {
						has_building = fp_dragon_pit
						ROOT = { is_capital = yes }
					}	
				}	
			}
		}
	}	
	
	mean_time_to_happen = {
		years = 20
		modifier = {
			factor = 0.15
			any_province_lord = {
				any_demesne_title = {
					tier = BARON
					OR = {
						AND = {
							has_building = ca_dragon_pit 
							location = { province_id = ROOT }
						}	
						AND = {
							has_building = fp_dragon_pit
							ROOT = { is_capital = yes }
						}	
					}	
					controller = { trait = peasant_leader }
				}
			}
		}
	}
	
	option = {
		name = EVTOPTAdragon.79
		owner = {
			if = {
				limit = { ai = no }
				chronicle = {
					entry = CHRONICLE_DRAGON_PIT_STORMING
					picture = GFX_evt_peasants
				}
			}
		}
		any_province_character = {
			limit = { 
				trait = dragon 
				is_alive = yes
				NOT = { any_friend = { in_command = yes } }			
			}
			if = {
				limit = { NOT = { martial = 60 } }
				hidden_tooltip = { character_event = { id = dragon.80 } } 
				tooltip = { death = yes }
			}
			if = {
				limit = { martial = 60 }
				random = {
					chance = 50
					hidden_tooltip = { character_event = { id = dragon.80 } } 
					tooltip = { death = yes }
				}
			}
			random_friend = {
				if = {
					limit = { ROOT = { owner = { character = PREVPREV } } }
					random = {
						chance = 33
						add_trait = depressed
						hidden_tooltip = {
							character_event ={
								id = 38288 #Notify
							}
						}
					}
				}
			}			
		}
		county = {
			any_de_jure_vassal_title = {
				controller = {
					if = {
						limit = { NOT = { has_landed_title = PREV } }
						random_friend = {
							limit = { 
								trait = dragon 
								is_alive = yes
								NOT = { any_friend = { in_command = yes } }
							}
							if = {
								limit = { NOT = { martial = 60 } }
								hidden_tooltip = { character_event = { id = dragon.80 } } 
								tooltip = { death = yes }
							}
							if = {
								limit = { martial = 60 }
								random = {
									chance = 50
									hidden_tooltip = { character_event = { id = dragon.80 } } 
									tooltip = { death = yes }
								}
							}	
						}
						any_ward = {
							random_friend = {
								limit = { 
									trait = dragon 
									is_alive = yes
									NOT = { any_friend = { in_command = yes } }
								}
								if = {
									limit = { NOT = { martial = 60 } }
									hidden_tooltip = { character_event = { id = dragon.80 } } 
									tooltip = { death = yes }
								}
								if = {
									limit = { martial = 60 }
									random = {
										chance = 50
										hidden_tooltip = { character_event = { id = dragon.80 } } 
										tooltip = { death = yes }
									}
								}	
							}
						}
					}	
				}
			}
		}
	}
}
#Dragon is killed
character_event = {
	id = dragon.80

	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		hidden_tooltip = { 
			any_friend = {
				character_event = { id = dragon.81 } 
				remove_trait = dragon_rider
			} 
		}
		death = {
			death_reason = death_rabble
		}
	}
	
	option = {
		name = "OK"
	}
}
#Inform rider Dragon is killed
character_event = {
	id = dragon.81
	title = EVTNAMEdragon.79
	desc = EVTDESCdragon.81
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { any_demesne_province = { province_id = FROMFROM } }
	}
	
	option = {
		name = EVTOPTAdragon.79
		random = {
			chance = 33
			add_trait = depressed
			hidden_tooltip = {
				character_event ={
					id = 38288 #Notify
				}
			}
		}
	}
}
#Ruler Designer dragons
character_event = { 
	id = dragon.82
	desc = "EVTDESCdragon.82"
	picture = "GFX_fieldoffire"
	
	ai = no
	only_rulers = yes
	
	trigger = {
		trait = dragon_rider
		NOT = {
			any_friend = {
				trait = dragon
				is_alive = yes
			}
		}
	}
	
	option = {
		name = EVTOPTAdragon.82 #Hatchling
		create_character = {
			dynasty = culture
			age = 2
			culture = dragon
			religion = dragon_rel
		}
		new_character = {
			#dynasty = mother_bastard
			add_friend = ROOT
			add_trait = dragon
			change_martial = 1
			random = {
				chance = 5
				add_trait = fair
			}
			random = {
				chance = 5
				if = {
					limit = { NOT = { trait = fair } }
					add_trait = ugly
				}	
			}
			random = {
				chance = 5
				add_trait = strong
			}
			random_list = {
				1 = { add_trait = dragon_1 }
				1 = { add_trait = dragon_2 }
				1 = { add_trait = dragon_3 }
				1 = { add_trait = dragon_4 }
				1 = { add_trait = dragon_5 }
				1 = { add_trait = dragon_6 }
				1 = { add_trait = dragon_7 }
				1 = { add_trait = dragon_8 }
				1 = { add_trait = dragon_9 }
				1 = { add_trait = dragon_10 }
				1 = { add_trait = dragon_11 }
				1 = { add_trait = dragon_12 }
				1 = { add_trait = dragon_13 }
				1 = { add_trait = dragon_14 }
				1 = { add_trait = dragon_15 }
				1 = { add_trait = dragon_16 }
				1 = { add_trait = dragon_17 }
				1 = { add_trait = dragon_18 }
				1 = { add_trait = dragon_19 }
				1 = { add_trait = dragon_20 }
				1 = { add_trait = dragon_21 }
				1 = { add_trait = dragon_22 }
				1 = { add_trait = dragon_23 }
				1 = { add_trait = dragon_24 }
				1 = { add_trait = dragon_25 }
				1 = { add_trait = dragon_26 }
			}
			character_event = { id = dragon.599 }
		}
	}
	
	option = {
		name = EVTOPTBdragon.82 #Young Dragon
		create_character = {
			dynasty = culture
			age = 40
			culture = dragon
			religion = dragon_rel
			attributes = {
				martial = 20
			}
		}
		new_character = {
			#dynasty = mother_bastard
			add_friend = ROOT
			add_trait = dragon
			random = {
				chance = 5
				add_trait = fair
			}
			random = {
				chance = 5
				if = {
					limit = { NOT = { trait = fair } }
					add_trait = ugly
				}	
			}
			random = {
				chance = 5
				add_trait = strong
			}
			random_list = {
				1 = { add_trait = dragon_1 }
				1 = { add_trait = dragon_2 }
				1 = { add_trait = dragon_3 }
				1 = { add_trait = dragon_4 }
				1 = { add_trait = dragon_5 }
				1 = { add_trait = dragon_6 }
				1 = { add_trait = dragon_7 }
				1 = { add_trait = dragon_8 }
				1 = { add_trait = dragon_9 }
				1 = { add_trait = dragon_10 }
				1 = { add_trait = dragon_11 }
				1 = { add_trait = dragon_12 }
				1 = { add_trait = dragon_13 }
				1 = { add_trait = dragon_14 }
				1 = { add_trait = dragon_15 }
				1 = { add_trait = dragon_16 }
				1 = { add_trait = dragon_17 }
				1 = { add_trait = dragon_18 }
				1 = { add_trait = dragon_19 }
				1 = { add_trait = dragon_20 }
				1 = { add_trait = dragon_21 }
				1 = { add_trait = dragon_22 }
				1 = { add_trait = dragon_23 }
				1 = { add_trait = dragon_24 }
				1 = { add_trait = dragon_25 }
				1 = { add_trait = dragon_26 }
			}
			character_event = { id = dragon.599 }
			character_event = { id = dragon.0 }
		}
	}
	
	option = {
		name = EVTOPTCdragon.82 #Adult Dragon
		create_character = {
			dynasty = culture
			age = 85
			culture = dragon
			religion = dragon_rel
			attributes = {
				martial = 50
			}
		}
		new_character = {
			#dynasty = mother_bastard
			add_friend = ROOT
			add_trait = dragon
			random = {
				chance = 5
				add_trait = fair
			}
			random = {
				chance = 5
				add_trait = strong
			}
			random = {
				chance = 5
				if = {
					limit = { NOT = { trait = fair } }
					add_trait = ugly
				}	
			}
			random_list = {
				1 = { add_trait = dragon_1 }
				1 = { add_trait = dragon_2 }
				1 = { add_trait = dragon_3 }
				1 = { add_trait = dragon_4 }
				1 = { add_trait = dragon_5 }
				1 = { add_trait = dragon_6 }
				1 = { add_trait = dragon_7 }
				1 = { add_trait = dragon_8 }
				1 = { add_trait = dragon_9 }
				1 = { add_trait = dragon_10 }
				1 = { add_trait = dragon_11 }
				1 = { add_trait = dragon_12 }
				1 = { add_trait = dragon_13 }
				1 = { add_trait = dragon_14 }
				1 = { add_trait = dragon_15 }
				1 = { add_trait = dragon_16 }
				1 = { add_trait = dragon_17 }
				1 = { add_trait = dragon_18 }
				1 = { add_trait = dragon_19 }
				1 = { add_trait = dragon_20 }
				1 = { add_trait = dragon_21 }
				1 = { add_trait = dragon_22 }
				1 = { add_trait = dragon_23 }
				1 = { add_trait = dragon_24 }
				1 = { add_trait = dragon_25 }
				1 = { add_trait = dragon_26 }
			}
			character_event = { id = dragon.599 }
			character_event = { id = dragon.0 }
		}
	}
	
	option = {
		name = EVTOPTDdragon.82 #Huge Dragon
		create_character = {
			dynasty = culture
			age = 160
			culture = dragon
			religion = dragon_rel
			attributes = {
				martial = 90
			}
		}
		new_character = {
			#dynasty = mother_bastard
			add_trait = dragon
			add_friend = ROOT
			random = {
				chance = 5
				add_trait = fair
			}
			random = {
				chance = 5
				if = {
					limit = { NOT = { trait = fair } }
					add_trait = ugly
				}	
			}
			add_trait = strong
			random_list = {
				1 = { add_trait = dragon_1 }
				1 = { add_trait = dragon_2 }
				1 = { add_trait = dragon_3 }
				1 = { add_trait = dragon_4 }
				1 = { add_trait = dragon_5 }
				1 = { add_trait = dragon_6 }
				1 = { add_trait = dragon_7 }
				1 = { add_trait = dragon_8 }
				1 = { add_trait = dragon_9 }
				1 = { add_trait = dragon_10 }
				1 = { add_trait = dragon_11 }
				1 = { add_trait = dragon_12 }
				1 = { add_trait = dragon_13 }
				1 = { add_trait = dragon_14 }
				1 = { add_trait = dragon_15 }
				1 = { add_trait = dragon_16 }
				1 = { add_trait = dragon_17 }
				1 = { add_trait = dragon_18 }
				1 = { add_trait = dragon_19 }
				1 = { add_trait = dragon_20 }
				1 = { add_trait = dragon_21 }
				1 = { add_trait = dragon_22 }
				1 = { add_trait = dragon_23 }
				1 = { add_trait = dragon_24 }
				1 = { add_trait = dragon_25 }
				1 = { add_trait = dragon_26 }
			}
			character_event = { id = dragon.599 }
			character_event = { id = dragon.0 }
		}
	}
}
###Random dragon flavour###
##Gluttonous events##
#Dragon is gluttonous
character_event = {
	id = dragon.83
	
	is_triggered_only = yes
	
	trigger = {
		trait = dragon
		NOT = { trait = gluttonous }
		NOT = { martial = 25 }
		NOT = { personality_traits = 2 }
	}
	
	weight_multiplier = {
		factor = 1
		modifier = {
			factor = 2
			trait = lunatic
		}
		modifier = {
			factor = 2
			trait = slothful
		}
		modifier = {
			factor = 0.2
			trait = humble
		}
	}
	
	immediate = {
		add_trait = gluttonous
		random_friend = { character_event = { id = dragon.84 } }
	}
	
	option = {
		name = "OK" 
	}
}
#Inform dragon is gluttonous
character_event = {
	id = dragon.84
	desc = "EVTDESCdragon.84"
	picture = "GFX_targaryen_balerion" 
	
	is_triggered_only = yes

	option = {
		name = EVTOPTAdragon.84 #Good
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				trait = gluttonous
			}
			modifier = {
				factor = 5
				trait = slothful
			}
		}
		FROM = { 
			add_trait = gluttonous
			change_martial = 2 
		}
	}
	
	option = {
		name = EVTOPTBdragon.84 #Beat and starve it
		ai_chance = {
			factor = 1
			modifier = {
				factor = 5
				trait = temperate
			}
			modifier = {
				factor = 5
				trait = wroth
			}
		}
		FROM = { 
			remove_trait = gluttonous
			random_list = {
				50 = {
					if = {
						limit = { 
							NOT = { trait = patient } 
							NOT = { trait = wroth } 
						}
						add_trait = wroth
					}				
				}
				50 = {
					if = {
						limit = { 
							NOT = { trait = humble } 
							NOT = { trait = proud }
						}
						add_trait = humble
					}
				}
			}
		}
	}
	
	option = {
		name = EVTOPTAdragon.84 #soothe it
		trigger = { learning = 12 }
		ai_chance = {
			factor = 2
			modifier = {
				factor = 5
				trait = patient
			}
			modifier = {
				factor = 5
				trait = diligent
			}
		}
		tooltip_info = learning
		FROM = { 
			remove_trait = gluttonous
			random_list = {
				50 = {
					if = {
						limit = { NOT = { trait = content } }
						add_trait = content
					}				
				}
				50 = {
					if = {
						limit = { 
							NOT = { trait = patient } 
							NOT = { trait = wroth }
						}
						add_trait = patient
					}
				}
			}
		}
	}
}
#Dragon is eating smallfolk's animals
character_event = {
	id = dragon.85
	
	is_triggered_only = yes
	culture = dragon
	
	trigger = {
		trait = dragon
		OR = {
			trait = gluttonous
			trait = lunatic
			trait = wroth
		}
		NOT = { has_character_modifier = locked_in_dragonpit }
	}
	
	weight_multiplier = {
		factor = 1
		modifier = {
			factor = 2
			trait = proud
		}
		modifier = {
			factor = 0.25
			trait = slothful
		}
		modifier = {
			factor = 0.05
			trait = shy
		}
	}
	
	immediate = {
		if = {
			limit = { any_friend = { is_ruler = yes } }
			random_friend = { character_event = { id = dragon.86 } }
			break = yes
		}
		location = { owner = { character_event = { id = dragon.87 } } }	
	}
	
	option = {
		name = "OK" 
	}
}
#My dragon is eating the smallfolk's livestock
character_event = {
	id = dragon.86
	desc = "EVTDESCdragon.86"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes
	
	trigger = { NOT = { FROM = { location = { has_province_modifier = peasants_upset } } } }

	option = {
		name = EVTOPTAdragon.86 #So?
		ai_chance = {
			factor = 1
			modifier = {
				factor = 4
				trait = greedy
			}
			modifier = {
				factor = 4
				trait = arbitrary
			}
			modifier = {
				factor = 4
				trait = ruthless
			}
			modifier = {
				factor = 4
				trait = cruel
			}
		}
		FROM = {
			location = {
				add_province_modifier = {
					name = peasants_upset
					duration = 365
				}
			}
		}	
	}
	
	option = {
		name = EVTOPTBdragon.86 #Recompense them
		ai_chance = {
			factor = 1
			modifier = {
				factor = 4
				trait = charitable
			}
			modifier = {
				factor = 4
				trait = just
			}
			modifier = {
				factor = 4
				trait = honorable
			}
			modifier = {
				factor = 4
				trait = kind
			}
		}
		wealth = -100
		piety = 50
	}
	
	option = {
		name = EVTOPTCdragon.86 #use diplomacy
		trigger = { diplomacy = 12 }
		ai_chance = {
			factor = 20
		}
		tooltip_info = diplomacy
		prestige = 25
	}
}

#A dragon in my province is eating the smallfolk's livestock
character_event = {
	id = dragon.87
	desc = "EVTDESCdragon.87"
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes
	
	trigger = { NOT = { FROM = { location = { has_province_modifier = peasants_upset } } } }

	option = {
		name = EVTOPTAdragon.86 #So?
		ai_chance = {
			factor = 1
			modifier = {
				factor = 4
				trait = greedy
			}
			modifier = {
				factor = 4
				trait = arbitrary
			}
			modifier = {
				factor = 4
				trait = ruthless
			}
			modifier = {
				factor = 4
				trait = cruel
			}
		}
		FROM = {
			location = {
				add_province_modifier = {
					name = peasants_upset
					duration = 365
				}
			}
		}	
	}
	
	option = {
		name = EVTOPTBdragon.86 #Recompense them
		ai_chance = {
			factor = 1
			modifier = {
				factor = 4
				trait = charitable
			}
			modifier = {
				factor = 4
				trait = just
			}
			modifier = {
				factor = 4
				trait = honorable
			}
			modifier = {
				factor = 4
				trait = kind
			}
		}
		wealth = -75
		piety = 30
	}
	
	option = {
		name = EVTOPTCdragon.86 #use diplomacy
		trigger = { diplomacy = 12 }
		ai_chance = {
			factor = 20
		}
		tooltip_info = diplomacy
		prestige = 25
	}
	
	option = {
		name = EVTOPTDdragon.87 #I shall isolate it in the dragonpit
		trigger = {
			FROM = { NOT = { any_friend = { trait = dragon_rider } } }
			OR = {
				is_adult = yes
				trait = dragon_rider
			}
			NOT = { trait = incapable }
			NOT = { trait = maimed }
			in_command = no
			OR = {
				capital_holding = { has_building = ca_dragon_pit } 
				family_palace = { has_building = fp_dragon_pit }
			}
		}
		ai_chance = {
			factor = 0.05
			modifier = {
				factor = 20
				trait = dragon_rider
			}
			modifier = {
				factor = 0
				trait = craven
			}
			modifier = {
				factor = 2
				trait = brave
			}
		}	
		set_character_flag = capture_dragon
		FROM = { character_event = { id = dragon.2799 tooltip = TOOLTIPdragon.2799 days = 1 } }
	}
}
#Inform dragon is in pit
character_event = {
	id = dragon.88
	desc = EVTDESCdragon.88
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes

	option = {
		name = EVTOPTAdragon.88
		prestige = 50
		FROM = {
			FROM = {
				add_character_modifier = {
					name = locked_in_dragonpit
					duration = -1
				}	
			}
		}
	}
}
#Inform failed to put dragon in pit
character_event = {
	id = dragon.89
	desc = EVTDESCdragon.89
	picture = "GFX_valyria_dragon"
	
	is_triggered_only = yes

	option = {
		name = EVTOPTAdragon.89
		prestige = -50
		random_list = {
			10 = {
				add_trait = maimed
				hidden_tooltip = { remove_trait = wounded }
				hidden_tooltip = {
					character_event ={
						id = 38281 #Notify
					}
				}
			}
			20 = {
				add_trait = wounded
				hidden_tooltip = {
					character_event ={
						id = 38280 #Notify
					}
				}
			}	
			70 = {
			}			
		}
	}
}

###Dragon Nicknames###
#dragon.90
character_event = {
	id = dragon.90
	desc = "Much nickname very dragon wow" 
	
	min_age = 14
	is_triggered_only = yes
	hide_window = yes
	
	trigger = {	
		trait = dragon
		has_nickname = no
		martial = 55
	}
	
	option = {
		name = OK
		if = {
			limit = {
				NOT = { dragon = { is_alive = yes has_nickname = nick_red_dread } } 
			}
			random_list = {
				50 = { }
				50 = { give_nickname = nick_red_dread }
			}
		}
		if = {
			limit = {
				NOT = { dragon = { is_alive = yes has_nickname = nick_white_dread } }
			}
			random_list = {
				50 = { }
				50 = { give_nickname = nick_white_dread }
			}
		}
		if = {
			limit = {
				NOT = { dragon = { is_alive = yes has_nickname = nick_yellow_dread } }
			}
			random_list = {
				50 = { }
				50 = { give_nickname = nick_yellow_dread }
			}
		}
		if = {
			limit = {
				NOT = { dragon = { is_alive = yes has_nickname = nick_blazing_fire } }
			}
			random_list = {
				50 = { }
				50 = { give_nickname = nick_blazing_fire }
			}
		}
		if = {
			limit = {
				NOT = { dragon = { is_alive = yes has_nickname = nick_shining_light } }
			}
			random_list = {
				50 = { }
				50 = { give_nickname = nick_shining_light }
			}
		}
		if = {
			limit = {
				NOT = { dragon = { is_alive = yes has_nickname = nick_red_fury } }
			}
			random_list = {
				50 = { }
				50 = { give_nickname = nick_red_fury }
			}
		}
		if = {
			limit = {
				NOT = { dragon = { is_alive = yes has_nickname = nick_shining_queen } }
			}
			random_list = {
				50 = { }
				50 = { give_nickname = nick_shining_queen }
			}
		}
		if = {
			limit = {
				NOT = { dragon = { is_alive = yes has_nickname = nick_destroyer } }
			}
			random_list = {
				50 = { }
				50 = { give_nickname = nick_destroyer }
			}
		}
		if = {
			limit = {
				NOT = { dragon = { is_alive = yes has_nickname = nick_black_fire } }
			}
			random_list = {
				50 = { }
				50 = { give_nickname = nick_black_fire }
			}
		}
		if = {
			limit = {
				NOT = { dragon = { is_alive = yes has_nickname = nick_red_fire } }
			}
			random_list = {
				50 = { }
				50 = { give_nickname = nick_red_fire }
			}
		}
		if = {
			limit = {
				NOT = { dragon = { is_alive = yes has_nickname = nick_white_fire } }
			}
			random_list = {
				50 = { }
				50 = { give_nickname = nick_white_fire }
			}
		}
		if = {
			limit = {
				NOT = { dragon = { is_alive = yes has_nickname = nick_yellow_fire } }
			}
			random_list = {
				50 = { }
				50 = { give_nickname = nick_yellow_fire }
			}
		}
		if = {
			limit = {
				NOT = { dragon = { is_alive = yes has_nickname = nick_snake } }
			}
			random_list = {
				50 = { }
				50 = { give_nickname = nick_snake }
			}
		}
		if = {
			limit = {
				NOT = { dragon = { is_alive = yes has_nickname = nick_blood_fire } }
			}
			random_list = {
				50 = { }
				50 = { give_nickname = nick_blood_fire }
			}
		}
		if = {
			limit = {
				NOT = { dragon = { is_alive = yes has_nickname = nick_dark_eyes } }
			}
			random_list = {
				50 = { }
				50 = { give_nickname = nick_dark_eyes }
			}
		}
		if = {
			limit = {
				NOT = { dragon = { is_alive = yes has_nickname = nick_dark_fire } }
			}
			random_list = {
				50 = { }
				50 = { give_nickname = nick_dark_fire }
			}
		}
		if = {
			limit = {
				NOT = { dragon = { is_alive = yes has_nickname = nick_shadow } }
			}
			random_list = {
				50 = { }
				50 = { give_nickname = nick_shadow }
			}
		}
	}
}
#Inform dragon wounded
character_event = {
	id = dragon.91

	is_triggered_only = yes
	hide_window = yes
	
	trigger = {	
		trait = dragon
	}
	
	immediate = {
		FROM = { character_event = { id = dragon.92 } }
	}
	
	option = {
		name = OK
	}
}	
character_event = {
	id = dragon.92
	desc = "EVTDESCdragon.92"
	picture = "GFX_targaryen_balerion" 
	
	is_triggered_only = yes

	option = {
		name = OK
		FROM = { add_trait = wounded_dragon }
	}
}
#Inform dragon maimed
character_event = {
	id = dragon.93

	is_triggered_only = yes
	hide_window = yes
	
	trigger = {	
		trait = dragon
	}
	
	immediate = {
		FROM = { character_event = { id = dragon.94 } }
	}
	
	option = {
		name = OK
	}
}	
character_event = {
	id = dragon.94
	desc = "EVTDESCdragon.94"
	picture = "GFX_targaryen_balerion" 
	
	is_triggered_only = yes

	option = {
		name = EVTOPTAdragon.94
		FROM = { add_trait = maimed_dragon }
	}
}
#Vermax Winterfell dragon egg
province_event = {
	id = dragon.95

	hide_window = yes
	
	trigger = {
		province_id = 47
		has_province_flag = vermax_dragon_egg
		owner = { 
			NOT = { culture = ruin } 		
		}
	}
	
	mean_time_to_happen = {
		years = 1000
	}
	
	immediate = { owner = { narrative_event = { id = dragon.96 } } }

	option = {
		name = OK
	}
}
narrative_event = {
	id = dragon.96
	title = "EVTTITLEdragon.96"
	desc = "EVTDESCdragon.96"
	picture = "GFX_winterfell_crypt" 

	is_triggered_only = yes
	
	trigger = {
		NOT = { trait = dragon_egg }
		age = 8
		prisoner = no
		NOT = { trait = incapable }
		location = { province_id = FROM }
	}
	
	immediate = { FROM = { clr_province_flag = vermax_dragon_egg } }
	
	option = {
		name = "EVTOPTAdragon.96" 
		ai_chance = { 
			factor = 100
		}
		add_trait = dragon_egg
		prestige = 250
		if = {
			limit = { ai = no }
			chronicle = {
				entry = CHRONICLE_VERMAX_DRAGON_EGG
				picture = GFX_winterfell_crypt
			}
		}
		hidden_tooltip = {
			dragon = {
				limit = { character = 77990014 }
				ROOT = { set_character_flag = dragon_egg_mother_@PREV }
			}	
		}
		event_target:chronicle_player = {
			if = {
				limit = {
					NOT = { character = ROOT }
					OR = {		
						dynasty = ROOT
						is_liege_or_above = ROOT
						is_close_relative = ROOT
						is_vassal_or_below = ROOT
					}
				}
				chronicle = {
					entry = CHRONICLE_VERMAX_DRAGON_EGG
					portrait = [Root.GetID]
				}
			}
		}
	}
	option = {
		name = "EVTOPTBdragon.96" #sell it
		ai_chance = { 
			factor = 1
			modifier = {
				factor = 0
				OR = {
					trait = proud
					trait = ambitious
					trait = envious
					trait = greedy
					dynasty = 496
				}
			}
			modifier = {
				factor = 100
				NOT = { wealth = 0 }
			}
			modifier = {
				factor = 2
				NOT = { wealth = -100 }
			}
		}
		wealth = 750
	}
}